---
title: Rustå­¦ä¹ 
date: 2024-02-26 16:04:09
permalink: /language/rust/3600d7/
categories:
  - è¯­è¨€
  - Rust
tags:
  - Rust
  - Rustç»éªŒ
  - ä¸å™¨
  - ä¸å™¨å°çª
---

## å‰è¨€

æœ¬æ–‡æ˜¯è®°å½•åœ¨ `Rust` å­¦ä¹ ç¬”è®°ï¼Œå­¦å®Œç»“æŸã€‚

[Rustè¯­è¨€åœ£ç»(Rust Course)](https://course.rs)

`240305` å­¦ä¹ åˆ°äº† `2.3.1` ï¼Œè„‘å­è¢«ç»•æ‡µäº†ï¼Œè¯¾åä½œä¸šæœ‰ä¸€è¯´ä¸€ä¸é”™ğŸ˜‚

<!-- more -->

<InArticleAdsense
    data-ad-client="ca-pub-1725717718088510"
    data-ad-slot="7426219401">
</InArticleAdsense>

## æµ®ç‚¹é™·é˜±

1. æµ®ç‚¹æ•°å¾€å¾€æ˜¯ä½ æƒ³è¦æ•°å­—çš„è¿‘ä¼¼è¡¨è¾¾ æµ®ç‚¹æ•°ç±»å‹æ˜¯åŸºäºäºŒè¿›åˆ¶å®ç°çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦è®¡ç®—çš„æ•°å­—å¾€å¾€æ˜¯åŸºäºåè¿›åˆ¶ï¼Œä¾‹å¦‚ 0.1 åœ¨äºŒè¿›åˆ¶ä¸Šå¹¶ä¸å­˜åœ¨ç²¾ç¡®çš„è¡¨è¾¾å½¢å¼ï¼Œä½†æ˜¯åœ¨åè¿›åˆ¶ä¸Šå°±å­˜åœ¨ã€‚è¿™ç§ä¸åŒ¹é…æ€§å¯¼è‡´ä¸€å®šçš„æ­§ä¹‰æ€§ï¼Œæ›´å¤šçš„ï¼Œè™½ç„¶æµ®ç‚¹æ•°èƒ½ä»£è¡¨çœŸå®çš„æ•°å€¼ï¼Œä½†æ˜¯ç”±äºåº•å±‚æ ¼å¼é—®é¢˜ï¼Œå®ƒå¾€å¾€å—é™äºå®šé•¿çš„æµ®ç‚¹æ•°ç²¾åº¦ï¼Œå¦‚æœä½ æƒ³è¦è¡¨è¾¾å®Œå…¨ç²¾å‡†çš„çœŸå®æ•°å­—ï¼Œåªæœ‰ä½¿ç”¨æ— é™ç²¾åº¦çš„æµ®ç‚¹æ•°æ‰è¡Œ
2. æµ®ç‚¹æ•°åœ¨æŸäº›ç‰¹æ€§ä¸Šæ˜¯åç›´è§‰çš„ ä¾‹å¦‚å¤§å®¶éƒ½ä¼šè§‰å¾—æµ®ç‚¹æ•°å¯ä»¥è¿›è¡Œæ¯”è¾ƒï¼Œå¯¹å§ï¼Ÿæ˜¯çš„ï¼Œå®ƒä»¬ç¡®å®å¯ä»¥ä½¿ç”¨ >ï¼Œ>= ç­‰è¿›è¡Œæ¯”è¾ƒï¼Œä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œè¿™ç§ç›´è§‰ä¸Šçš„æ¯”è¾ƒç‰¹æ€§åè€Œä¼šå®³äº†ä½ 

æ³¨æ„ï¼š

- é¿å…åœ¨æµ®ç‚¹æ•°ä¸Šæµ‹è¯•ç›¸ç­‰æ€§
- å½“ç»“æœåœ¨æ•°å­¦ä¸Šå¯èƒ½å­˜åœ¨æœªå®šä¹‰æ—¶ï¼Œéœ€è¦æ ¼å¤–çš„å°å¿ƒ

``` rust
fn main() {
    let abc: (f32, f32, f32) = (0.1, 0.2, 0.3);
    let xyz: (f64, f64, f64) = (0.1, 0.2, 0.3);

    println!("abc (f32)");
    println!("   0.1 + 0.2: {:x}", (abc.0 + abc.1).to_bits());
    println!("         0.3: {:x}", (abc.2).to_bits());
    println!();

    println!("xyz (f64)");
    println!("   0.1 + 0.2: {:x}", (xyz.0 + xyz.1).to_bits());
    println!("         0.3: {:x}", (xyz.2).to_bits());
    println!();

    assert!(abc.0 + abc.1 == abc.2);
    assert!(xyz.0 + xyz.1 == xyz.2);
}
```

è¾“å‡º

``` log
abc (f32)
   0.1 + 0.2: 3e99999a
         0.3: 3e99999a

xyz (f64)
   0.1 + 0.2: 3fd3333333333334
         0.3: 3fd3333333333333

thread 'main' panicked at 'assertion failed: xyz.0 + xyz.1 == xyz.2',
â¥ch2-add-floats.rs.rs:14:5
note: run with `RUST_BACKTRACE=1` environment variable to display
â¥a backtrace
```

> è¿™æ˜¯å› ä¸ºé«˜ç²¾åº¦è¿›è¡ŒåŠ å‡çš„æ—¶å€™åœ¨å°æ•°ç‚¹éå¸¸åçš„åœ°æ–¹å‘ç”Ÿäº†å¾®å°çš„å˜åŒ–ï¼Œå¯¼è‡´äº† `f64` è®¡ç®—çš„ç»“æœå’ŒåŸå§‹å£°æ˜çš„ç»“æœå‡ºç°äº†å˜åŒ–ï¼Œæ–­è¨€å¤±è´¥


## `Range` (åºåˆ—)

- å·¦é—­å³å¼€
  
  `1...5`

- å·¦é—­å³é—­

  `1...=5`

> åºåˆ—ä»…ä»…å…è®¸æ•°å­—æˆ–è€…**å­—ç¬¦ï¼ˆ`char`ï¼‰**ç±»å‹ï¼ŒåŸå› æ˜¯ä»–ä»¬å¯ä»¥è¿ç»­

## `As` ç±»å‹è½¬æ¢

`Rust` ä¸­å¯ä»¥ä½¿ç”¨ `As` æ¥å®Œæˆä¸€ä¸ªç±»å‹åˆ°å¦ä¸€ä¸ªç±»å‹çš„è½¬æ¢ï¼Œå…¶æœ€å¸¸ç”¨äºå°†åŸå§‹ç±»å‹è½¬æ¢ä¸ºå…¶ä»–åŸå§‹ç±»å‹ï¼Œä½†æ˜¯å®ƒä¹Ÿå¯ä»¥å®Œæˆè¯¸å¦‚å°†æŒ‡é’ˆè½¬æ¢ä¸ºåœ°å€ã€åœ°å€è½¬æ¢ä¸ºæŒ‡é’ˆä»¥åŠå°†æŒ‡é’ˆè½¬æ¢ä¸ºå…¶ä»–æŒ‡é’ˆç­‰åŠŸèƒ½ã€‚

## å¦‚ä½•å¼•ç”¨ç¬¬ä¸‰æ–¹åº“

[Ruståº“ä¸­å¿ƒ â€”â€” crates.io](https://crates.io/)

1. ä½¿ç”¨ `cargo`

    ``` shell
    # xxx ä¸ºåº“å
    cargo add xxx
    ```

2. æ“ä½œ `Cargo.toml`

    åœ¨ `Cargo.toml` ä¸­çš„ `[dependencies]` ä¸‹å¢åŠ åº“åå¹¶æŒ‡å®šç‰ˆæœ¬
    ``` toml
    [dependencies]
    tauri = "1.6.0"
    ```

## å­—ç¬¦ã€å¸ƒå°”ã€å•å…ƒç±»å‹

### å­—ç¬¦

`Rust` ä¸­çš„å­—ç¬¦ç±»å‹ä»£è¡¨ä¸€ä¸ª `Unicode`ï¼Œ`Unicode` å ç”¨ `4` ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åœ¨ `Rust` ä¸­å­—ç¬¦å ç”¨ `4` ä¸ªå­—èŠ‚

### å¸ƒå°”

`Rust` ä¸­å¸ƒå°”å€¼å ç”¨å†…å­˜å¤§å°ä¸º `1` ä¸ªå­—èŠ‚

### å•å…ƒç±»å‹

`Rust` ä¸­å•å…ƒç±»å‹ `()` å¯ä»¥ç”¨æ¥å ä½ï¼Œå¦‚æœä¸æ³¨å…¥å€¼çš„è¯å¹¶ä¸å æ®å­—èŠ‚ï¼Œå³ç©ºçš„å•å…ƒç±»å‹ä¸º `0` ä¸ªå­—èŠ‚

å•å…ƒç±»å‹ `()` æ˜¯ä¸€ä¸ªé›¶é•¿åº¦çš„å…ƒç»„ã€‚å®ƒæ²¡å•¥ä½œç”¨ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥è¡¨è¾¾ä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼

- å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª `()`
- é€šè¿‡ `;` ç»“å°¾çš„è¯­å¥è¿”å›ä¸€ä¸ª `()`

## è¯­å¥å’Œè¡¨è¾¾å¼

> **åªæœ‰è¡¨è¾¾å¼èƒ½è¿”å›å€¼**

### è¯­å¥å’Œè¡¨è¾¾å¼çš„åŒºåˆ«

- åˆçº§ç†è§£
  - è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·ï¼Œå¿…é¡»è¦çœ‹ç»“å°¾æ˜¯å¦æœ‰ `;`
  - æ˜¯å¦åœ¨è¿›è¡Œèµ‹å€¼(å½¢æ€ä¸Šçœ‹çœ‹å°±å¥½)ï¼Œå¦‚æœæ²¡æœ‰ `;` ä»¥ä¸Šé¢çš„ä¸€æ¡ä¸ºä¸»
  - è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰è¿”å›å€¼ä¼šéšå¼çš„è¿”å›ä¸€ä¸ªå•å…ƒç±»å‹ `()`
  - `macro` æ˜¯ä¾‹å¤–

> ä¸­çº§ç†è§£è¿˜æ²¡è¾¾åˆ°é‚£ä¸ªèƒ½è€ï¼Œç­‰åˆ°è¾¾äº†å†å†™å§

æˆ‘åœ¨[`Rust` è”ç³»å®è·µ](https://practice-zh.course.rs/basic-types/statements-expressions.html)ä¸­å‘ç°ç¬¬ä¸€é¢˜çš„ä¸¤ç§æ–¹å¼å¯ä»¥ä½¿å…¶è¿è¡Œèµ·æ¥ï¼Œä½†æ˜¯æœ‰ä¸ªç–‘æƒ‘ç‚¹æ²¡æœ‰æƒ³é€š


``` rust
// eg1
fn main() {
    let v = {
        let mut x = 1;
        x += 2
    };
 
    assert_eq!(v, ());
}

// eg2
fn main() {
    let v = {
        let mut x = 1;
        x += 2;
        x
    };

    assert_eq!(v, 3);
}

// eg3
fn main() {
    let v = {
        let mut x = 1;
        x + 2;
    };

    assert_eq!(v, 3);
}
```

- ä¸ºä»€ä¹ˆåœ¨ `eg1` ä¸­ `x += 2` è¿”å›çš„æ˜¯å•å…ƒç±»å‹ `()`ï¼Œè€Œåœ¨ `eg2` ä¸­è¿”å›çš„æ˜¯ `i32` ç±»å‹

    **æ‚Ÿäº†**ï¼Œè¿™é‡Œé¢æœ‰ä¸ªå‘ `x += 2` ç­‰ä»·äº `x = x + 2` æ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼å…¶å®æ˜¯ä¸€ä¸ªèµ‹å€¼çš„ä»£ç ï¼Œèµ‹å€¼çš„ä»£ç å¹¶ä¸æ˜¯ä¸€ä¸ªå˜é‡æ•°æ®ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯ä¸€ä¸ªå•å…ƒç±»å‹ `()`ï¼Œæ‰€ä»¥æˆ‘æ–°å¢çš„ `eg3` ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„

## å‡½æ•°

### å‡½æ•°è¦ç‚¹

- å‡½æ•°åå’Œå˜é‡åä½¿ç”¨è›‡å½¢å‘½åæ³• `(snake case)` ï¼Œä¾‹å¦‚ `fn add_two() -> {}`
- å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼Œ`Rust` ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯
- æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹

æ³¨æ„ï¼š

- `Rust` ä¸­åªå…è®¸ä»å‡½æ•°ä½“ä¸­ä½¿ç”¨ `return` è¯­å¥è¿”å›,è€Œè¿™é‡Œæ˜¯ä¸€ä¸ªä»£ç å—,åªèƒ½ä½¿ç”¨è¡¨è¾¾å¼çš„å€¼ä½œä¸ºè¿”å›ã€‚
   
   ``` rust
    let v = {
        let mut x = 1;
        return x + 2; 
    };
   ```

- æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° `!`ï¼Œå½“ç”¨ `!` ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( `diverge function` )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°

    ``` rust
    fn dead_end() -> ! {
        panic!("ä½ å·²ç»åˆ°äº†ç©·é€”æœ«è·¯ï¼Œå´©æºƒå§ï¼");
    }
    ```



### åŒ¿åå‡½æ•°

#### å¦‚ä½•ç†è§£

1. å½“åŒ¿åå‡½æ•°ä½“å†…æœ€åä¸€ä¸ªè¡¨è¾¾å¼æ²¡æœ‰åˆ†å·æ—¶,è¯¥åŒ¿åå‡½æ•°ä¼šè¿”å›è¿™ä¸ªæœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚
2. å½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼æœ‰åˆ†å·æˆ–ä¸å­˜åœ¨æ—¶,è¯¥åŒ¿åå‡½æ•°ä¼šè¿”å› `()` å•å…ƒç±»å‹ã€‚
3. å› ä¸ºæ ¹æ® `Rust` çš„è§„åˆ™,é»˜è®¤è¿”å› `()`ã€‚

## æ‰€æœ‰æƒå’Œå€Ÿç”¨

### æ‰€æœ‰æƒ

#### æ‰€æœ‰æƒåŸåˆ™

1. `Rust` ä¸­æ¯ä¸€ä¸ªå€¼éƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œè¯¥å˜é‡è¢«ç§°ä¸ºå€¼çš„æ‰€æœ‰è€…
2. **ä¸€ä¸ªå€¼åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼åªèƒ½æ‹¥æœ‰ä¸€ä¸ªæ‰€æœ‰è€…**
3. å½“æ‰€æœ‰è€…(å˜é‡)ç¦»å¼€ä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒ(`drop`)

#### æ ˆ(`Stack`)ä¸å †(`Heap`)

> æ ˆå’Œå †çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯ä¸ºç¨‹åºåœ¨è¿è¡Œæ—¶æä¾›å¯ä¾›ä½¿ç”¨çš„å†…å­˜ç©ºé—´

##### æ ˆ(`Stack`)

- æ ˆæŒ‰ç…§é¡ºåºå­˜å‚¨å€¼å¹¶ä»¥ç›¸åé¡ºåºå–å‡ºå€¼ï¼Œè¿™ä¹Ÿè¢«ç§°ä½œ**åè¿›å…ˆå‡º**ã€**å…ˆè¿›åå‡º**
- å¢åŠ æ•°æ®å«åš**è¿›æ ˆ**ï¼Œç§»å‡ºæ•°æ®åˆ™å«åš**å‡ºæ ˆ**
- æ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½**å¿…é¡»**å ç”¨å·²çŸ¥ä¸”å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´

::: note
æƒ³è±¡ä¸€ä¸‹ä¸€å ç›˜å­ï¼šå½“å¢åŠ æ›´å¤šç›˜å­æ—¶ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨ç›˜å­å †çš„é¡¶éƒ¨ï¼Œå½“éœ€è¦ç›˜å­æ—¶ï¼Œå†ä»é¡¶éƒ¨æ‹¿èµ°ã€‚ä¸èƒ½ä»ä¸­é—´ä¹Ÿä¸èƒ½ä»åº•éƒ¨å¢åŠ æˆ–æ‹¿èµ°ç›˜å­ï¼
:::

##### å †(`Heap`)

> å¯¹äºå¤§å°æœªçŸ¥æˆ–è€…å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œå°†å®ƒå­˜å‚¨åœ¨å †ä¸Š

å½“å‘å †ä¸Šæ”¾å…¥æ•°æ®æ—¶ï¼Œéœ€è¦è¯·æ±‚ä¸€å®šå¤§å°çš„å†…å­˜ç©ºé—´ã€‚æ“ä½œç³»ç»Ÿåœ¨å †çš„æŸå¤„æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥ä½ç½®åœ°å€çš„æŒ‡é’ˆ, è¯¥è¿‡ç¨‹è¢«ç§°ä¸ºåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œæœ‰æ—¶ç®€ç§°ä¸º â€œåˆ†é…â€(`allocating`)ï¼Œç„¶åè¯¥æŒ‡é’ˆä¼šè¢«æ¨å…¥æ ˆä¸­ï¼Œå› ä¸ºæŒ‡é’ˆçš„å¤§å°æ˜¯å·²çŸ¥ä¸”å›ºå®šçš„ï¼Œåœ¨åç»­ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ å°†é€šè¿‡æ ˆä¸­çš„æŒ‡é’ˆï¼Œæ¥è·å–æ•°æ®åœ¨å †ä¸Šçš„å®é™…å†…å­˜ä½ç½®ï¼Œè¿›è€Œè®¿é—®è¯¥æ•°æ®

æˆ‘ä¸ªäººçš„ç†è§£å°±æ˜¯ä¹¦ç±çš„ç›®å½•ã€Œæ ˆã€å¯¹åº”é¡µç ï¼Œç„¶åå¯»æ‰¾å…·ä½“ç« èŠ‚ã€Œå †ã€çš„è¿‡ç¨‹

##### æ€§èƒ½åŒºåˆ«

åœ¨æ ˆä¸Šåˆ†é…å†…å­˜æ¯”åœ¨å †ä¸Šåˆ†é…å†…å­˜è¦å¿«ï¼Œå› ä¸ºå…¥æ ˆæ—¶æ“ä½œç³»ç»Ÿæ— éœ€è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼ˆæˆ–æ›´æ…¢çš„ç³»ç»Ÿè°ƒç”¨ï¼‰æ¥åˆ†é…æ–°çš„ç©ºé—´ï¼Œåªéœ€è¦å°†æ–°æ•°æ®æ”¾å…¥æ ˆé¡¶å³å¯ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨å †ä¸Šåˆ†é…å†…å­˜åˆ™éœ€è¦æ›´å¤šçš„å·¥ä½œï¼Œè¿™æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿå¿…é¡»é¦–å…ˆæ‰¾åˆ°ä¸€å—è¶³å¤Ÿå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œæ¥ç€åšä¸€äº›è®°å½•ä¸ºä¸‹ä¸€æ¬¡åˆ†é…åšå‡†å¤‡ï¼Œå¦‚æœå½“å‰è¿›ç¨‹åˆ†é…çš„å†…å­˜é¡µä¸è¶³æ—¶ï¼Œè¿˜éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ¥ç”³è¯·æ›´å¤šå†…å­˜ã€‚ å› æ­¤ï¼Œå¤„ç†å™¨åœ¨æ ˆä¸Šåˆ†é…æ•°æ®ä¼šæ¯”åœ¨å †ä¸Šåˆ†é…æ•°æ®æ›´åŠ é«˜æ•ˆã€‚

##### æ‰€æœ‰æƒä¸å †æ ˆ

å½“ä»£ç è°ƒç”¨çš„æŸä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼ é€’çš„å‚æ•°ä¼šè¢«ä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œæ¯•åè¿™äº›å‚æ•°ä¼šæŒ‰ç…§**åè¿›å…ˆå‡º**çš„åŸåˆ™ä¾æ¬¡ç§»é™¤

å› ä¸ºå †ä¸Šçš„æ•°æ®ç¼ºä¹ç»„ç»‡ï¼Œå› æ­¤è·Ÿè¸ªè¿™äº›æ•°æ®ä½•æ—¶åˆ†é…å’Œé‡Šæ”¾æ˜¯éå¸¸é‡è¦çš„ï¼Œå¦åˆ™å †ä¸Šçš„æ•°æ®å°†äº§ç”Ÿå†…å­˜æ³„æ¼ â€”â€” è¿™äº›æ•°æ®å°†æ°¸è¿œæ— æ³•è¢«å›æ”¶ã€‚è¿™å°±æ˜¯ `Rust` æ‰€æœ‰æƒç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„å¼ºå¤§ä¿éšœã€‚åœ¨ `Rust` ä¸­ï¼Œæ˜ç™½å †æ ˆçš„åŸç†ï¼Œå¯¹äºæˆ‘ä»¬ç†è§£æ‰€æœ‰æƒçš„å·¥ä½œåŸç†ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©

**å½“æ‰€æœ‰æƒè½¬ç§»æ—¶ï¼Œå¯å˜æ€§ä¹Ÿå¯ä»¥éšä¹‹æ”¹å˜**ï¼Œä¹Ÿå°±æ˜¯è¯´æ–°çš„å˜é‡æ‹¥æœ‰æ‰€æœ‰æƒçš„æ—¶å€™å®ƒæ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æœè¦è¿›è¡Œæ”¹å˜éœ€è¦åŠ ä¸Š `mut` å…³é”®å­—

> æˆ‘æƒ³åˆ°ä¸€ä¸ªæƒ…å†µï¼Œå¦‚æœæŒ‰è¿™ä¸ªé€»è¾‘æ¥çœ‹çš„è¯ï¼Œé‚£ä¹ˆåœ¨å†™ `rust` ä»£ç æ—¶ä¼ é€’å‚æ•°æ—¶ï¼Œæ˜¯å¦éœ€è¦è®©å®¹é‡æ¯”è¾ƒé«˜çš„å‚æ•°æ”¾åœ¨åé¢ï¼Œä½¿å…¶åœ¨åˆ é™¤çš„æ—¶å€™æ›´æ—©çš„åˆ é™¤

::: warning
å¦‚ä½•å£°æ˜ä¸€ä¸ª `String` ç±»å‹çš„å˜é‡
``` rust
let s ="hello" // s æ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œç±»å‹æ˜¯ &str
let s = String::from("hello"); // s æ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œç±»å‹æ˜¯ String
```

> `::` æ˜¯ä¸€ç§è°ƒç”¨æ“ä½œç¬¦ï¼Œè¿™é‡Œè¡¨ç¤ºè°ƒç”¨ `String` æ¨¡å—ä¸­çš„ `from` æ–¹æ³•ï¼Œç”±äº `String` ç±»å‹å­˜å‚¨åœ¨å †ä¸Šï¼Œå› æ­¤å®ƒæ˜¯åŠ¨æ€çš„
:::

### å˜é‡ç»‘å®šèƒŒåçš„æ•°æ®äº¤äº’

> æ³¨æ„ï¼šåŸºæœ¬ç±»å‹æ˜¯å­˜å‚¨åœ¨ã€Œæ ˆã€ä¸Šçš„ï¼Œè€Œå¤æ‚ç±»å‹æ˜¯å­˜å‚¨åœ¨ã€Œå †ã€ä¸Šçš„
> åŸºæœ¬çš„æ•°æ®ç±»å‹æœ‰ï¼š
>  1. æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (`i8`, `i16`, `i32`, `i64`, `isize`)ã€ æ— ç¬¦å·æ•´æ•° (`u8`, `u16`, `u32`, `u64`, `usize`) ã€æµ®ç‚¹æ•° (`f32`, `f64`)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°
>  2. å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ `&str`
>  3. å¸ƒå°”ç±»å‹ï¼š `true` å’Œ `false`
>  4. å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª `Unicode` å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚
>  5. å•å…ƒç±»å‹: å³ `()` ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ `()`

> æ³¨æ„ï¼š
> å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ `Rust` ä¼šè‡ªåŠ¨è°ƒç”¨ `drop` æ¥æ¸…ç†å˜é‡çš„å †å†…å­˜ã€‚å¦‚æœä¸¤ä¸ªå˜é‡æŒ‡å‘åˆ°äº†åŒä¸€ä¸ªä½ç½®çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šé™·å…¥ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸º `Rust` ä¼šè°ƒç”¨ä¸¤æ¬¡ `drop`ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥ `Rust` ä¼šè‡ªåŠ¨è°ƒç”¨ `drop` çš„æ—¶å€™ä¼šå°†å˜é‡çš„æ‰€æœ‰æƒè½¬ç§»ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°ä¸¤æ¬¡ `drop` çš„é—®é¢˜ã€‚è¿™æ ·çš„æƒ…å†µå«åšï¼šäºŒæ¬¡é‡Šæ”¾ï¼ˆ`double free`ï¼‰

#### å®æˆ˜è§£è¯´

``` rust
let s1 = String::from("hello");
let s2 = s1;
println!("{}",s1);
```

ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`s1` èµ‹å€¼ç»™äº† `s2` åï¼Œ`Rust` å°±è®¤ä¸º `s1` ä¸å†æœ‰æ•ˆï¼Œå› æ­¤åœ¨ `s1` ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ `Rust` ä¸ä¼š `drop` ä»»ä½•ä¸œè¥¿ã€‚å¦‚æœè¿™æ—¶å€™è¦å¯¹ `s1` è¿›è¡Œæ“ä½œçš„æ—¶å€™å°±ä¼šæç¤º `borrow of moved value: 's1'`ï¼Œè¿™æ˜¯å› ä¸º `s1` å·²ç»ä¸å†æœ‰æ•ˆäº†ï¼Œ`Rust` ç¦æ­¢ä½¿ç”¨æ— æ•ˆçš„å¼•ç”¨ã€‚

ä½†æ˜¯ï¼Œä¸‹é¢çš„ä»£ç æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼ŒåŸå› æ˜¯ `s2` æ˜¯ `s1` çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ `s2` çš„å€¼æ˜¯ `s1` çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ `s1` ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ `Rust` ä¸ä¼š `drop` ä»»ä½•ä¸œè¥¿

æˆ‘ä¸ªäººç†è§£çš„æ˜¯åŸºç¡€ç±»å‹æ•°æ®æ˜¯å­˜å‚¨åœ¨æ ˆä¸Šçš„ï¼Œæ‰€ä»¥ `s1` åœ¨èµ‹å€¼ç»™ `s2` çš„æ—¶å€™å®é™…ä¸Šæ˜¯ä½¿ç”¨äº†ä¸€æ¬¡æ‹·è´çš„è¿‡ç¨‹ï¼Œç›´æ¥å°†æ•´ä¸ªæ•°æ®ç»™äº†ä¸€ä»½ç»™ `s2` åœ¨æ ˆä¸Šåˆ›å»ºäº†ã€‚

``` rust
let x = 5;
let y = x;

println!("x = {}, y = {}", x, y);
```

**ä»»ä½•åŸºæœ¬ç±»å‹çš„ç»„åˆå¯ä»¥ `Copy` ï¼Œä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹æ˜¯å¯ä»¥ `Copy` çš„**

å¯ä»¥ `Copy` çš„ç±»å‹:

- æ‰€æœ‰æ•´æ•°ç±»å‹
- å¸ƒå°”ç±»å‹
- æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹
- å­—ç¬¦ç±»å‹
- å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½æ˜¯ `Copy` çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ(`i32`, `i32`) æ˜¯ Copy çš„ï¼Œä½† (`i32`, `String`) å°±ä¸æ˜¯
- ä¸å¯å˜å¼•ç”¨ &Tï¼Œ**ä½†æ˜¯æ³¨æ„: å¯å˜å¼•ç”¨ `&mut T` æ˜¯ä¸å¯ä»¥ `Copy` çš„**

> æ‰€ä»¥æˆ‘ç®€å•çš„ç†è§£ä¸º å‡¡æ˜¯ä»¥ä¸Šç±»å‹è¿›è¡Œèµ‹å€¼çš„è¡Œä¸ºå¯ä»¥è®¤ä¸ºæ˜¯åœ¨è¿›è¡Œ `Copy` æ“ä½œ

### å¼•ç”¨ä¸å€Ÿç”¨


