---
title: Rustå­¦ä¹ 
date: 2024-02-26 16:04:09
permalink: /language/rust/3600d7/
categories:
  - è¯­è¨€
  - Rust
tags:
  - Rust
  - Rustç»éªŒ
  - Rustå­¦ä¹ 
  - ä¸å™¨
  - ä¸å™¨å°çª
---

## å‰è¨€

æœ¬æ–‡æ˜¯è®°å½•åœ¨ `Rust` å­¦ä¹ ç¬”è®°ï¼Œå­¦å®Œç»“æŸã€‚

[Rust è¯­è¨€åœ£ç»(Rust Course)](https://course.rs)

- `240305` å­¦ä¹ åˆ°äº† `2.3.1` ï¼Œè„‘å­è¢«ç»•æ‡µäº†ï¼Œè¯¾åä½œä¸šæœ‰ä¸€è¯´ä¸€ä¸é”™ ğŸ˜‚

- `240718` å­¦ä¹ åˆ°äº† `2.4.3` ï¼Œä¹ é¢˜åšå®Œ

<!-- more -->

<InArticleAdsense
    data-ad-client="ca-pub-1725717718088510"
    data-ad-slot="7426219401">
</InArticleAdsense>

## æµ®ç‚¹é™·é˜±

1. æµ®ç‚¹æ•°å¾€å¾€æ˜¯ä½ æƒ³è¦æ•°å­—çš„è¿‘ä¼¼è¡¨è¾¾ æµ®ç‚¹æ•°ç±»å‹æ˜¯åŸºäºäºŒè¿›åˆ¶å®ç°çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦è®¡ç®—çš„æ•°å­—å¾€å¾€æ˜¯åŸºäºåè¿›åˆ¶ï¼Œä¾‹å¦‚ 0.1 åœ¨äºŒè¿›åˆ¶ä¸Šå¹¶ä¸å­˜åœ¨ç²¾ç¡®çš„è¡¨è¾¾å½¢å¼ï¼Œä½†æ˜¯åœ¨åè¿›åˆ¶ä¸Šå°±å­˜åœ¨ã€‚è¿™ç§ä¸åŒ¹é…æ€§å¯¼è‡´ä¸€å®šçš„æ­§ä¹‰æ€§ï¼Œæ›´å¤šçš„ï¼Œè™½ç„¶æµ®ç‚¹æ•°èƒ½ä»£è¡¨çœŸå®çš„æ•°å€¼ï¼Œä½†æ˜¯ç”±äºåº•å±‚æ ¼å¼é—®é¢˜ï¼Œå®ƒå¾€å¾€å—é™äºå®šé•¿çš„æµ®ç‚¹æ•°ç²¾åº¦ï¼Œå¦‚æœä½ æƒ³è¦è¡¨è¾¾å®Œå…¨ç²¾å‡†çš„çœŸå®æ•°å­—ï¼Œåªæœ‰ä½¿ç”¨æ— é™ç²¾åº¦çš„æµ®ç‚¹æ•°æ‰è¡Œ
2. æµ®ç‚¹æ•°åœ¨æŸäº›ç‰¹æ€§ä¸Šæ˜¯åç›´è§‰çš„ ä¾‹å¦‚å¤§å®¶éƒ½ä¼šè§‰å¾—æµ®ç‚¹æ•°å¯ä»¥è¿›è¡Œæ¯”è¾ƒï¼Œå¯¹å§ï¼Ÿæ˜¯çš„ï¼Œå®ƒä»¬ç¡®å®å¯ä»¥ä½¿ç”¨ >ï¼Œ>= ç­‰è¿›è¡Œæ¯”è¾ƒï¼Œä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œè¿™ç§ç›´è§‰ä¸Šçš„æ¯”è¾ƒç‰¹æ€§åè€Œä¼šå®³äº†ä½ 

æ³¨æ„ï¼š

- é¿å…åœ¨æµ®ç‚¹æ•°ä¸Šæµ‹è¯•ç›¸ç­‰æ€§
- å½“ç»“æœåœ¨æ•°å­¦ä¸Šå¯èƒ½å­˜åœ¨æœªå®šä¹‰æ—¶ï¼Œéœ€è¦æ ¼å¤–çš„å°å¿ƒ

```rust
fn main() {
    let abc: (f32, f32, f32) = (0.1, 0.2, 0.3);
    let xyz: (f64, f64, f64) = (0.1, 0.2, 0.3);

    println!("abc (f32)");
    println!("   0.1 + 0.2: {:x}", (abc.0 + abc.1).to_bits());
    println!("         0.3: {:x}", (abc.2).to_bits());
    println!();

    println!("xyz (f64)");
    println!("   0.1 + 0.2: {:x}", (xyz.0 + xyz.1).to_bits());
    println!("         0.3: {:x}", (xyz.2).to_bits());
    println!();

    assert!(abc.0 + abc.1 == abc.2);
    assert!(xyz.0 + xyz.1 == xyz.2);
}
```

è¾“å‡º

```log
abc (f32)
   0.1 + 0.2: 3e99999a
         0.3: 3e99999a

xyz (f64)
   0.1 + 0.2: 3fd3333333333334
         0.3: 3fd3333333333333

thread 'main' panicked at 'assertion failed: xyz.0 + xyz.1 == xyz.2',
â¥ch2-add-floats.rs.rs:14:5
note: run with `RUST_BACKTRACE=1` environment variable to display
â¥a backtrace
```

> è¿™æ˜¯å› ä¸ºé«˜ç²¾åº¦è¿›è¡ŒåŠ å‡çš„æ—¶å€™åœ¨å°æ•°ç‚¹éå¸¸åçš„åœ°æ–¹å‘ç”Ÿäº†å¾®å°çš„å˜åŒ–ï¼Œå¯¼è‡´äº† `f64` è®¡ç®—çš„ç»“æœå’ŒåŸå§‹å£°æ˜çš„ç»“æœå‡ºç°äº†å˜åŒ–ï¼Œæ–­è¨€å¤±è´¥

## `Range` (åºåˆ—)

- å·¦é—­å³å¼€

  `1...5`

- å·¦é—­å³é—­

  `1...=5`

> åºåˆ—ä»…ä»…å…è®¸æ•°å­—æˆ–è€…**å­—ç¬¦ï¼ˆ`char`ï¼‰**ç±»å‹ï¼ŒåŸå› æ˜¯ä»–ä»¬å¯ä»¥è¿ç»­

## `As` ç±»å‹è½¬æ¢

`Rust` ä¸­å¯ä»¥ä½¿ç”¨ `As` æ¥å®Œæˆä¸€ä¸ªç±»å‹åˆ°å¦ä¸€ä¸ªç±»å‹çš„è½¬æ¢ï¼Œå…¶æœ€å¸¸ç”¨äºå°†åŸå§‹ç±»å‹è½¬æ¢ä¸ºå…¶ä»–åŸå§‹ç±»å‹ï¼Œä½†æ˜¯å®ƒä¹Ÿå¯ä»¥å®Œæˆè¯¸å¦‚å°†æŒ‡é’ˆè½¬æ¢ä¸ºåœ°å€ã€åœ°å€è½¬æ¢ä¸ºæŒ‡é’ˆä»¥åŠå°†æŒ‡é’ˆè½¬æ¢ä¸ºå…¶ä»–æŒ‡é’ˆç­‰åŠŸèƒ½ã€‚

## å¦‚ä½•å¼•ç”¨ç¬¬ä¸‰æ–¹åº“

[Rust åº“ä¸­å¿ƒ â€”â€” crates.io](https://crates.io/)

1. ä½¿ç”¨ `cargo`

   ```shell
   # xxx ä¸ºåº“å
   cargo add xxx
   ```

2. æ“ä½œ `Cargo.toml`

   åœ¨ `Cargo.toml` ä¸­çš„ `[dependencies]` ä¸‹å¢åŠ åº“åå¹¶æŒ‡å®šç‰ˆæœ¬

   ```toml
   [dependencies]
   tauri = "1.6.0"
   ```

## å­—ç¬¦ã€å¸ƒå°”ã€å•å…ƒç±»å‹

### å­—ç¬¦

`Rust` ä¸­çš„å­—ç¬¦ç±»å‹ä»£è¡¨ä¸€ä¸ª `Unicode`ï¼Œ`Unicode` å ç”¨ `4` ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åœ¨ `Rust` ä¸­å­—ç¬¦å ç”¨ `4` ä¸ªå­—èŠ‚

### å¸ƒå°”

`Rust` ä¸­å¸ƒå°”å€¼å ç”¨å†…å­˜å¤§å°ä¸º `1` ä¸ªå­—èŠ‚

### å•å…ƒç±»å‹

`Rust` ä¸­å•å…ƒç±»å‹ `()` å¯ä»¥ç”¨æ¥å ä½ï¼Œå¦‚æœä¸æ³¨å…¥å€¼çš„è¯å¹¶ä¸å æ®å­—èŠ‚ï¼Œå³ç©ºçš„å•å…ƒç±»å‹ä¸º `0` ä¸ªå­—èŠ‚

å•å…ƒç±»å‹ `()` æ˜¯ä¸€ä¸ªé›¶é•¿åº¦çš„å…ƒç»„ã€‚å®ƒæ²¡å•¥ä½œç”¨ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥è¡¨è¾¾ä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼

- å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª `()`
- é€šè¿‡ `;` ç»“å°¾çš„è¯­å¥è¿”å›ä¸€ä¸ª `()`

## è¯­å¥å’Œè¡¨è¾¾å¼

> **åªæœ‰è¡¨è¾¾å¼èƒ½è¿”å›å€¼**

### è¯­å¥å’Œè¡¨è¾¾å¼çš„åŒºåˆ«

- åˆçº§ç†è§£
  - è¡¨è¾¾å¼ä¸èƒ½åŒ…å«åˆ†å·ï¼Œå¿…é¡»è¦çœ‹ç»“å°¾æ˜¯å¦æœ‰ `;`
  - æ˜¯å¦åœ¨è¿›è¡Œèµ‹å€¼(å½¢æ€ä¸Šçœ‹çœ‹å°±å¥½)ï¼Œå¦‚æœæ²¡æœ‰ `;` ä»¥ä¸Šé¢çš„ä¸€æ¡ä¸ºä¸»
  - è¡¨è¾¾å¼æ€»è¦è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰è¿”å›å€¼ä¼šéšå¼çš„è¿”å›ä¸€ä¸ªå•å…ƒç±»å‹ `()`
  - `macro` æ˜¯ä¾‹å¤–

> ä¸­çº§ç†è§£è¿˜æ²¡è¾¾åˆ°é‚£ä¸ªèƒ½è€ï¼Œç­‰åˆ°è¾¾äº†å†å†™å§

æˆ‘åœ¨[`Rust` è”ç³»å®è·µ](https://practice-zh.course.rs/basic-types/statements-expressions.html)ä¸­å‘ç°ç¬¬ä¸€é¢˜çš„ä¸¤ç§æ–¹å¼å¯ä»¥ä½¿å…¶è¿è¡Œèµ·æ¥ï¼Œä½†æ˜¯æœ‰ä¸ªç–‘æƒ‘ç‚¹æ²¡æœ‰æƒ³é€š

```rust
// eg1
fn main() {
    let v = {
        let mut x = 1;
        x += 2
    };

    assert_eq!(v, ());
}

// eg2
fn main() {
    let v = {
        let mut x = 1;
        x += 2;
        x
    };

    assert_eq!(v, 3);
}

// eg3
fn main() {
    let v = {
        let mut x = 1;
        x + 2;
    };

    assert_eq!(v, 3);
}
```

- ä¸ºä»€ä¹ˆåœ¨ `eg1` ä¸­ `x += 2` è¿”å›çš„æ˜¯å•å…ƒç±»å‹ `()`ï¼Œè€Œåœ¨ `eg2` ä¸­è¿”å›çš„æ˜¯ `i32` ç±»å‹

  **æ‚Ÿäº†**ï¼Œè¿™é‡Œé¢æœ‰ä¸ªå‘ `x += 2` ç­‰ä»·äº `x = x + 2` æ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼å…¶å®æ˜¯ä¸€ä¸ªèµ‹å€¼çš„ä»£ç ï¼Œèµ‹å€¼çš„ä»£ç å¹¶ä¸æ˜¯ä¸€ä¸ªå˜é‡æ•°æ®ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯ä¸€ä¸ªå•å…ƒç±»å‹ `()`ï¼Œæ‰€ä»¥æˆ‘æ–°å¢çš„ `eg3` ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„

## å‡½æ•°

### å‡½æ•°è¦ç‚¹

- å‡½æ•°åå’Œå˜é‡åä½¿ç”¨è›‡å½¢å‘½åæ³• `(snake case)` ï¼Œä¾‹å¦‚ `fn add_two() -> {}`
- å‡½æ•°çš„ä½ç½®å¯ä»¥éšä¾¿æ”¾ï¼Œ`Rust` ä¸å…³å¿ƒæˆ‘ä»¬åœ¨å“ªé‡Œå®šä¹‰äº†å‡½æ•°ï¼Œåªè¦æœ‰å®šä¹‰å³å¯
- æ¯ä¸ªå‡½æ•°å‚æ•°éƒ½éœ€è¦æ ‡æ³¨ç±»å‹

æ³¨æ„ï¼š

- `Rust` ä¸­åªå…è®¸ä»å‡½æ•°ä½“ä¸­ä½¿ç”¨ `return` è¯­å¥è¿”å›,è€Œè¿™é‡Œæ˜¯ä¸€ä¸ªä»£ç å—,åªèƒ½ä½¿ç”¨è¡¨è¾¾å¼çš„å€¼ä½œä¸ºè¿”å›ã€‚

  ```rust
   let v = {
       let mut x = 1;
       return x + 2;
   };
  ```

- æ°¸ä¸è¿”å›çš„å‘æ•£å‡½æ•° `!`ï¼Œå½“ç”¨ `!` ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›( `diverge function` )ï¼Œç‰¹åˆ«çš„ï¼Œè¿™ç§è¯­æ³•å¾€å¾€ç”¨åšä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„å‡½æ•°

  ```rust
  fn dead_end() -> ! {
      panic!("ä½ å·²ç»åˆ°äº†ç©·é€”æœ«è·¯ï¼Œå´©æºƒå§ï¼");
  }
  ```

### åŒ¿åå‡½æ•°

#### å¦‚ä½•ç†è§£

1. å½“åŒ¿åå‡½æ•°ä½“å†…æœ€åä¸€ä¸ªè¡¨è¾¾å¼æ²¡æœ‰åˆ†å·æ—¶,è¯¥åŒ¿åå‡½æ•°ä¼šè¿”å›è¿™ä¸ªæœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚
2. å½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼æœ‰åˆ†å·æˆ–ä¸å­˜åœ¨æ—¶,è¯¥åŒ¿åå‡½æ•°ä¼šè¿”å› `()` å•å…ƒç±»å‹ã€‚
3. å› ä¸ºæ ¹æ® `Rust` çš„è§„åˆ™,é»˜è®¤è¿”å› `()`ã€‚

## æ‰€æœ‰æƒå’Œå€Ÿç”¨

### æ‰€æœ‰æƒ

#### æ‰€æœ‰æƒåŸåˆ™

1. `Rust` ä¸­æ¯ä¸€ä¸ªå€¼éƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œè¯¥å˜é‡è¢«ç§°ä¸ºå€¼çš„æ‰€æœ‰è€…
2. **ä¸€ä¸ªå€¼åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼åªèƒ½æ‹¥æœ‰ä¸€ä¸ªæ‰€æœ‰è€…**
3. å½“æ‰€æœ‰è€…(å˜é‡)ç¦»å¼€ä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒ(`drop`)

#### æ ˆ(`Stack`)ä¸å †(`Heap`)

> æ ˆå’Œå †çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯ä¸ºç¨‹åºåœ¨è¿è¡Œæ—¶æä¾›å¯ä¾›ä½¿ç”¨çš„å†…å­˜ç©ºé—´

##### æ ˆ(`Stack`)

- æ ˆæŒ‰ç…§é¡ºåºå­˜å‚¨å€¼å¹¶ä»¥ç›¸åé¡ºåºå–å‡ºå€¼ï¼Œè¿™ä¹Ÿè¢«ç§°ä½œ**åè¿›å…ˆå‡º**ã€**å…ˆè¿›åå‡º**
- å¢åŠ æ•°æ®å«åš**è¿›æ ˆ**ï¼Œç§»å‡ºæ•°æ®åˆ™å«åš**å‡ºæ ˆ**
- æ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½**å¿…é¡»**å ç”¨å·²çŸ¥ä¸”å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´

::: note
æƒ³è±¡ä¸€ä¸‹ä¸€å ç›˜å­ï¼šå½“å¢åŠ æ›´å¤šç›˜å­æ—¶ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨ç›˜å­å †çš„é¡¶éƒ¨ï¼Œå½“éœ€è¦ç›˜å­æ—¶ï¼Œå†ä»é¡¶éƒ¨æ‹¿èµ°ã€‚ä¸èƒ½ä»ä¸­é—´ä¹Ÿä¸èƒ½ä»åº•éƒ¨å¢åŠ æˆ–æ‹¿èµ°ç›˜å­ï¼
:::

##### å †(`Heap`)

> å¯¹äºå¤§å°æœªçŸ¥æˆ–è€…å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œå°†å®ƒå­˜å‚¨åœ¨å †ä¸Š

å½“å‘å †ä¸Šæ”¾å…¥æ•°æ®æ—¶ï¼Œéœ€è¦è¯·æ±‚ä¸€å®šå¤§å°çš„å†…å­˜ç©ºé—´ã€‚æ“ä½œç³»ç»Ÿåœ¨å †çš„æŸå¤„æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥ä½ç½®åœ°å€çš„æŒ‡é’ˆ, è¯¥è¿‡ç¨‹è¢«ç§°ä¸ºåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œæœ‰æ—¶ç®€ç§°ä¸º â€œåˆ†é…â€(`allocating`)ï¼Œç„¶åè¯¥æŒ‡é’ˆä¼šè¢«æ¨å…¥æ ˆä¸­ï¼Œå› ä¸ºæŒ‡é’ˆçš„å¤§å°æ˜¯å·²çŸ¥ä¸”å›ºå®šçš„ï¼Œåœ¨åç»­ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ å°†é€šè¿‡æ ˆä¸­çš„æŒ‡é’ˆï¼Œæ¥è·å–æ•°æ®åœ¨å †ä¸Šçš„å®é™…å†…å­˜ä½ç½®ï¼Œè¿›è€Œè®¿é—®è¯¥æ•°æ®

æˆ‘ä¸ªäººçš„ç†è§£å°±æ˜¯ä¹¦ç±çš„ç›®å½•ã€Œæ ˆã€å¯¹åº”é¡µç ï¼Œç„¶åå¯»æ‰¾å…·ä½“ç« èŠ‚ã€Œå †ã€çš„è¿‡ç¨‹

##### æ€§èƒ½åŒºåˆ«

åœ¨æ ˆä¸Šåˆ†é…å†…å­˜æ¯”åœ¨å †ä¸Šåˆ†é…å†…å­˜è¦å¿«ï¼Œå› ä¸ºå…¥æ ˆæ—¶æ“ä½œç³»ç»Ÿæ— éœ€è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼ˆæˆ–æ›´æ…¢çš„ç³»ç»Ÿè°ƒç”¨ï¼‰æ¥åˆ†é…æ–°çš„ç©ºé—´ï¼Œåªéœ€è¦å°†æ–°æ•°æ®æ”¾å…¥æ ˆé¡¶å³å¯ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨å †ä¸Šåˆ†é…å†…å­˜åˆ™éœ€è¦æ›´å¤šçš„å·¥ä½œï¼Œè¿™æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿå¿…é¡»é¦–å…ˆæ‰¾åˆ°ä¸€å—è¶³å¤Ÿå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œæ¥ç€åšä¸€äº›è®°å½•ä¸ºä¸‹ä¸€æ¬¡åˆ†é…åšå‡†å¤‡ï¼Œå¦‚æœå½“å‰è¿›ç¨‹åˆ†é…çš„å†…å­˜é¡µä¸è¶³æ—¶ï¼Œè¿˜éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ¥ç”³è¯·æ›´å¤šå†…å­˜ã€‚ å› æ­¤ï¼Œå¤„ç†å™¨åœ¨æ ˆä¸Šåˆ†é…æ•°æ®ä¼šæ¯”åœ¨å †ä¸Šåˆ†é…æ•°æ®æ›´åŠ é«˜æ•ˆã€‚

##### æ‰€æœ‰æƒä¸å †æ ˆ

å½“ä»£ç è°ƒç”¨çš„æŸä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼ é€’çš„å‚æ•°ä¼šè¢«ä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œæ¯•åè¿™äº›å‚æ•°ä¼šæŒ‰ç…§**åè¿›å…ˆå‡º**çš„åŸåˆ™ä¾æ¬¡ç§»é™¤

å› ä¸ºå †ä¸Šçš„æ•°æ®ç¼ºä¹ç»„ç»‡ï¼Œå› æ­¤è·Ÿè¸ªè¿™äº›æ•°æ®ä½•æ—¶åˆ†é…å’Œé‡Šæ”¾æ˜¯éå¸¸é‡è¦çš„ï¼Œå¦åˆ™å †ä¸Šçš„æ•°æ®å°†äº§ç”Ÿå†…å­˜æ³„æ¼ â€”â€” è¿™äº›æ•°æ®å°†æ°¸è¿œæ— æ³•è¢«å›æ”¶ã€‚è¿™å°±æ˜¯ `Rust` æ‰€æœ‰æƒç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„å¼ºå¤§ä¿éšœã€‚åœ¨ `Rust` ä¸­ï¼Œæ˜ç™½å †æ ˆçš„åŸç†ï¼Œå¯¹äºæˆ‘ä»¬ç†è§£æ‰€æœ‰æƒçš„å·¥ä½œåŸç†ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©

**å½“æ‰€æœ‰æƒè½¬ç§»æ—¶ï¼Œå¯å˜æ€§ä¹Ÿå¯ä»¥éšä¹‹æ”¹å˜**ï¼Œä¹Ÿå°±æ˜¯è¯´æ–°çš„å˜é‡æ‹¥æœ‰æ‰€æœ‰æƒçš„æ—¶å€™å®ƒæ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æœè¦è¿›è¡Œæ”¹å˜éœ€è¦åŠ ä¸Š `mut` å…³é”®å­—

> æˆ‘æƒ³åˆ°ä¸€ä¸ªæƒ…å†µï¼Œå¦‚æœæŒ‰è¿™ä¸ªé€»è¾‘æ¥çœ‹çš„è¯ï¼Œé‚£ä¹ˆåœ¨å†™ `rust` ä»£ç æ—¶ä¼ é€’å‚æ•°æ—¶ï¼Œæ˜¯å¦éœ€è¦è®©å®¹é‡æ¯”è¾ƒé«˜çš„å‚æ•°æ”¾åœ¨åé¢ï¼Œä½¿å…¶åœ¨åˆ é™¤çš„æ—¶å€™æ›´æ—©çš„åˆ é™¤

::: warning
å¦‚ä½•å£°æ˜ä¸€ä¸ª `String` ç±»å‹çš„å˜é‡

```rust
let s ="hello" // s æ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œç±»å‹æ˜¯ &str
let s = String::from("hello"); // s æ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œç±»å‹æ˜¯ String
```

> `::` æ˜¯ä¸€ç§è°ƒç”¨æ“ä½œç¬¦ï¼Œè¿™é‡Œè¡¨ç¤ºè°ƒç”¨ `String` æ¨¡å—ä¸­çš„ `from` æ–¹æ³•ï¼Œç”±äº `String` ç±»å‹å­˜å‚¨åœ¨å †ä¸Šï¼Œå› æ­¤å®ƒæ˜¯åŠ¨æ€çš„
> :::

### å˜é‡ç»‘å®šèƒŒåçš„æ•°æ®äº¤äº’

> æ³¨æ„ï¼šåŸºæœ¬ç±»å‹æ˜¯å­˜å‚¨åœ¨ã€Œæ ˆã€ä¸Šçš„ï¼Œè€Œå¤æ‚ç±»å‹æ˜¯å­˜å‚¨åœ¨ã€Œå †ã€ä¸Šçš„
> åŸºæœ¬çš„æ•°æ®ç±»å‹æœ‰ï¼š
>
> 1.  æ•°å€¼ç±»å‹: æœ‰ç¬¦å·æ•´æ•° (`i8`, `i16`, `i32`, `i64`, `isize`)ã€ æ— ç¬¦å·æ•´æ•° (`u8`, `u16`, `u32`, `u64`, `usize`) ã€æµ®ç‚¹æ•° (`f32`, `f64`)ã€ä»¥åŠæœ‰ç†æ•°ã€å¤æ•°
> 2.  å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²åˆ‡ç‰‡ `&str`
> 3.  å¸ƒå°”ç±»å‹ï¼š `true` å’Œ `false`
> 4.  å­—ç¬¦ç±»å‹: è¡¨ç¤ºå•ä¸ª `Unicode` å­—ç¬¦ï¼Œå­˜å‚¨ä¸º 4 ä¸ªå­—èŠ‚
> 5.  å•å…ƒç±»å‹: å³ `()` ï¼Œå…¶å”¯ä¸€çš„å€¼ä¹Ÿæ˜¯ `()`

> æ³¨æ„ï¼š
> å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ `Rust` ä¼šè‡ªåŠ¨è°ƒç”¨ `drop` æ¥æ¸…ç†å˜é‡çš„å †å†…å­˜ã€‚å¦‚æœä¸¤ä¸ªå˜é‡æŒ‡å‘åˆ°äº†åŒä¸€ä¸ªä½ç½®çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šé™·å…¥ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸º `Rust` ä¼šè°ƒç”¨ä¸¤æ¬¡ `drop`ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥ `Rust` ä¼šè‡ªåŠ¨è°ƒç”¨ `drop` çš„æ—¶å€™ä¼šå°†å˜é‡çš„æ‰€æœ‰æƒè½¬ç§»ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°ä¸¤æ¬¡ `drop` çš„é—®é¢˜ã€‚è¿™æ ·çš„æƒ…å†µå«åšï¼šäºŒæ¬¡é‡Šæ”¾ï¼ˆ`double free`ï¼‰

#### å®æˆ˜è§£è¯´

```rust
let s1 = String::from("hello");
let s2 = s1;
println!("{}",s1);
```

ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`s1` èµ‹å€¼ç»™äº† `s2` åï¼Œ`Rust` å°±è®¤ä¸º `s1` ä¸å†æœ‰æ•ˆï¼Œå› æ­¤åœ¨ `s1` ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ `Rust` ä¸ä¼š `drop` ä»»ä½•ä¸œè¥¿ã€‚å¦‚æœè¿™æ—¶å€™è¦å¯¹ `s1` è¿›è¡Œæ“ä½œçš„æ—¶å€™å°±ä¼šæç¤º `borrow of moved value: 's1'`ï¼Œè¿™æ˜¯å› ä¸º `s1` å·²ç»ä¸å†æœ‰æ•ˆäº†ï¼Œ`Rust` ç¦æ­¢ä½¿ç”¨æ— æ•ˆçš„å¼•ç”¨ã€‚

ä½†æ˜¯ï¼Œä¸‹é¢çš„ä»£ç æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼ŒåŸå› æ˜¯ `s2` æ˜¯ `s1` çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ `s2` çš„å€¼æ˜¯ `s1` çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ `s1` ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™ `Rust` ä¸ä¼š `drop` ä»»ä½•ä¸œè¥¿

æˆ‘ä¸ªäººç†è§£çš„æ˜¯åŸºç¡€ç±»å‹æ•°æ®æ˜¯å­˜å‚¨åœ¨æ ˆä¸Šçš„ï¼Œæ‰€ä»¥ `s1` åœ¨èµ‹å€¼ç»™ `s2` çš„æ—¶å€™å®é™…ä¸Šæ˜¯ä½¿ç”¨äº†ä¸€æ¬¡æ‹·è´çš„è¿‡ç¨‹ï¼Œç›´æ¥å°†æ•´ä¸ªæ•°æ®ç»™äº†ä¸€ä»½ç»™ `s2` åœ¨æ ˆä¸Šåˆ›å»ºäº†ã€‚

```rust
let x = 5;
let y = x;

println!("x = {}, y = {}", x, y);
```

**ä»»ä½•åŸºæœ¬ç±»å‹çš„ç»„åˆå¯ä»¥ `Copy` ï¼Œä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹æ˜¯å¯ä»¥ `Copy` çš„**

å¯ä»¥ `Copy` çš„ç±»å‹:

- æ‰€æœ‰æ•´æ•°ç±»å‹
- å¸ƒå°”ç±»å‹
- æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹
- å­—ç¬¦ç±»å‹
- å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½æ˜¯ `Copy` çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ(`i32`, `i32`) æ˜¯ Copy çš„ï¼Œä½† (`i32`, `String`) å°±ä¸æ˜¯
- ä¸å¯å˜å¼•ç”¨ &Tï¼Œ**ä½†æ˜¯æ³¨æ„: å¯å˜å¼•ç”¨ `&mut T` æ˜¯ä¸å¯ä»¥ `Copy` çš„**

> æ‰€ä»¥æˆ‘ç®€å•çš„ç†è§£ä¸º å‡¡æ˜¯ä»¥ä¸Šç±»å‹è¿›è¡Œèµ‹å€¼çš„è¡Œä¸ºå¯ä»¥è®¤ä¸ºæ˜¯åœ¨è¿›è¡Œ `Copy` æ“ä½œ

### å¼•ç”¨ä¸å€Ÿç”¨

#### å¼•ç”¨ä¸è§£å¼•ç”¨

å¸¸è§„å¼•ç”¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼ŒæŒ‡å‘äº†å¯¹è±¡å­˜å‚¨çš„å†…å­˜åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ `&` ç¬¦å·æ¥åˆ›å»ºä¸€ä¸ªå¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ä¿®æ”¹å¼•ç”¨çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹å¼•ç”¨çš„æŒ‡å‘ã€‚

å¿…é¡»ä½¿ç”¨ `*y` æ¥è§£å‡ºå¼•ç”¨æ‰€æŒ‡å‘çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯**è§£å¼•ç”¨**ï¼‰

```rust
    let x = 5;
    let y = &x;

    assert_eq!(5, x);
    assert_eq!(5, *y);
```

#### ä¸å¯å˜å¼•ç”¨

`&` ç¬¦å·å³æ˜¯å¼•ç”¨ï¼Œå®ƒä»¬å…è®¸ä½ ä½¿ç”¨å€¼ï¼Œä½†æ˜¯ä¸è·å–æ‰€æœ‰æƒï¼Œä¹Ÿå°±æ˜¯æ–°çš„å˜é‡ç¦»å¼€ä½œç”¨åŸŸçš„æ—¶å€™è¿™ä¸ªå¼•ç”¨å³å¤±æ•ˆï¼Œä½†åŸå§‹çš„æ•°æ®ä¸ä¼š `drop`

```rust
fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&s1);

    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize {
    s.len()
}
```

#### å¯å˜å¼•ç”¨

å¦‚æœè¦åœ¨ `calculate_length` å‡½æ•°ä¸­æ”¹å˜ `s` çš„å€¼æ“ä½œå¦‚ä¸‹

```rust
fn main() {
    let mut s1 = String::from("hello");

    let len = calculate_length(&mut s1);

    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &mut String) -> usize {
    s.push_str(",word");
    s.len()
}
```

> æ³¨æ„ï¼š
>
> 1. **å¯å˜å¼•ç”¨åŒæ—¶åªèƒ½å­˜åœ¨ä¸€ä¸ª**
> 2. **åŒä¸€ä½œç”¨åŸŸï¼Œç‰¹å®šæ•°æ®åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨**

æˆ‘ç†è§£çš„æ˜¯ï¼Œå½“ `a` è¢«å£°æ˜å¯å˜å˜é‡(`mut`)æ—¶ï¼Œ`b` è¿›è¡Œå¯å˜å¼•ç”¨è¿™ä¸ªæ—¶å€™æ˜¯**å…è®¸**çš„ï¼Œä½†æ˜¯**åŒæ—¶** `c` ä¹Ÿè¿›è¡Œäº†å¯å˜å¼•ç”¨ï¼Œè¿™æ—¶å€™æ˜¯**ä¸å…è®¸**çš„

`Rust` åœ¨ç¼–è¯‘åˆæœŸå°±ä¼šè¿›è¡Œä¸Šé¢çš„æ£€æŸ¥ï¼Œå³ `borrow checker`ï¼Œè¯¥æ£€æŸ¥çš„å¥½å¤„ï¼š

- ä¸¤ä¸ªæˆ–æ›´å¤šçš„æŒ‡é’ˆåŒæ—¶è®¿é—®åŒä¸€æ•°æ®
- è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆè¢«ç”¨æ¥å†™å…¥æ•°æ®
- æ²¡æœ‰åŒæ­¥æ•°æ®è®¿é—®çš„æœºåˆ¶
- å‡å°‘åæœŸåœ¨è¿è¡Œæ—¶å‡ºç°æ•°æ®äº¤å‰çš„é—®é¢˜

å¦‚æœä¸€å®šè¦åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å¯¹æŸä¸ªå˜é‡è¿›è¡Œå¤šæ¬¡å¯å˜å¼•ç”¨çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å¤§æ‹¬å·æ¥å¯¹ä¸Šä¸€ä¸ªå¯å˜å¼•ç”¨è¿›è¡Œä½œç”¨åŸŸçš„é™åˆ¶

#### å¯å˜å¼•ç”¨ä¸ä¸å¯å˜å¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨

```rust
    let a = String::from("hello");
    let b = &a;
    let c = &a;
    let d = &mut a; // è¿™é‡Œåœ¨ç¼–è¯‘å™¨ä¸­ç›´æ¥å°±ä¼šæŠ¥é”™ï¼Œæç¤º'æ— æ³•å€Ÿç”¨ä¸å¯å˜å±€éƒ¨å˜é‡ `a` ä½œä¸ºå¯å˜å˜é‡'
    println!("{}",d);
```

è¿™å°±ç›¸å½“äºä½ æŠŠè½¦å€Ÿç»™ä½ çš„æœ‹å‹å¼€ï¼Œç»“æœä½ çš„æœ‹å‹åˆå€Ÿç»™ä»–çš„æœ‹å‹ï¼Œè¿™æ—¶å€™ä½ æœ‹å‹çš„æœ‹å‹å€Ÿèµ°äº†ï¼Œä»–æƒ³æŠŠè½¦æ”¹ä¸€æ”¹ï¼Œè¿™æ—¶å€™ä½œä¸ºè½¦ä¸»çš„ä½ è‚¯å®šæ˜¯ä¸ä¼šæ„¿æ„çš„

å¦‚æœä½ æƒ³è®© `d` èƒ½å¤Ÿä½¿ç”¨ `a` çš„å€¼å¹¶ä½œå‡ºæ”¹å˜çš„è¯ï¼Œé‚£ä¹ˆè¿™æ—¶å€™ä½ éœ€è¦ä½¿ç”¨ `clone`

```rust
let a = String::from("hello");
let b = &a;
let c = &a;
let d = a.clone();
println!("{}",d);
```

`ref` ä¸ `&` ç±»ä¼¼ï¼Œå¯ä»¥ç”¨æ¥è·å–ä¸€ä¸ªå€¼çš„å¼•ç”¨ï¼Œä½†æ˜¯å®ƒä»¬çš„ç”¨æ³•æœ‰æ‰€ä¸åŒã€‚é€šå¸¸æƒ…å†µä¸‹æ˜¯ç›´æ¥å°†å˜é‡èµ‹å€¼çš„æ—¶å€™å‘ç°éœ€è¦è¿›è¡Œå¼•ç”¨æ—¶ä½¿ç”¨ `ref`

```Rust
    let c = 'ä¸­';

    let r1 = &c;
    // å¡«å†™ç©ºç™½å¤„ï¼Œä½†æ˜¯ä¸è¦ä¿®æ”¹å…¶å®ƒè¡Œçš„ä»£ç 
    let ref r2 = c;

    assert_eq!(*r1, *r2);
```

> `Rust` æ˜¯é€šè¿‡ `NLL(Non-Lexical Lifetimes)` æ¥è¿›è¡Œç¼–è¯‘å™¨çš„ä¼˜åŒ–

#### å‚ç›´å¼•ç”¨(`Dangling References`)

æ‚¬å‚å¼•ç”¨ä¹Ÿå«åšæ‚¬å‚æŒ‡é’ˆï¼Œæ„æ€ä¸ºæŒ‡é’ˆæŒ‡å‘æŸä¸ªå€¼åï¼Œè¿™ä¸ªå€¼è¢«é‡Šæ”¾æ‰äº†ï¼Œè€ŒæŒ‡é’ˆä»ç„¶å­˜åœ¨ï¼Œå…¶æŒ‡å‘çš„å†…å­˜å¯èƒ½ä¸å­˜åœ¨ä»»ä½•å€¼æˆ–å·²è¢«å…¶å®ƒå˜é‡é‡æ–°ä½¿ç”¨ã€‚åœ¨ `Rust` ä¸­ç¼–è¯‘å™¨å¯ä»¥ç¡®ä¿å¼•ç”¨**æ°¸è¿œä¹Ÿä¸ä¼šå˜æˆæ‚¬å‚çŠ¶æ€**ï¼šå½“ä½ è·å–æ•°æ®çš„å¼•ç”¨åï¼Œç¼–è¯‘å™¨å¯ä»¥ç¡®ä¿æ•°æ®ä¸ä¼šåœ¨å¼•ç”¨ç»“æŸå‰è¢«é‡Šæ”¾ï¼Œè¦æƒ³é‡Šæ”¾æ•°æ®ï¼Œå¿…é¡»å…ˆåœæ­¢å…¶å¼•ç”¨çš„ä½¿ç”¨ã€‚

```rust
fn main() {
    let reference_to_nothing = dangle();
}

fn dangle() -> &String {
    let s = String::from("hello");

    &s
}
```

ä¸Šé¢è¿™æ®µä»£ç åœ¨ `dangle` å‡½æ•°ä¸­è¿”å›äº†æŒ‡é’ˆåœ°å€ï¼Œä½†æ˜¯å› ä¸º `dangle` å‡½æ•°ç»“æŸäº†ï¼Œå¯¼è‡´ `s` è¿™ä¸ªå˜é‡è¦è¢«é”€æ¯ï¼Œæ‰€ä»¥ç¼–è¾‘å™¨ç›´æ¥ä¼šæç¤ºã€Œç¼ºå°‘ç”Ÿå‘½å‘¨æœŸè¯´æ˜ç¬¦ã€ï¼Œå³ä»£ç è¿›è¡Œäº†å‚ç›´å¼•ç”¨

### å€Ÿç”¨è§„åˆ™æ€»ç»“

- åŒä¸€æ—¶åˆ»ï¼Œä½ åªèƒ½æ‹¥æœ‰è¦ä¹ˆä¸€ä¸ªå¯å˜å¼•ç”¨, è¦ä¹ˆä»»æ„å¤šä¸ªä¸å¯å˜å¼•ç”¨
- å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„

## å¤åˆç±»å‹

> å¦‚æœåœ¨ `Rust` ä»£ç ä¸­å­˜åœ¨å£°æ˜åæœªä½¿ç”¨çš„ï¼Œé‚£ä¹ˆéœ€è¦è¿›è¡Œã€Œ**ç¼–è¯‘å™¨å±æ€§æ ‡è®°**ã€ï¼Œå³å¼•å…¥ `#![allow(unused_variables)]`

### åˆ‡ç‰‡

åˆ›å»ºåˆ‡ç‰‡çš„è¯­æ³•ï¼Œä½¿ç”¨æ–¹æ‹¬å·åŒ…æ‹¬çš„ä¸€ä¸ªåºåˆ—ï¼š**[å¼€å§‹ç´¢å¼•..ç»ˆæ­¢ç´¢å¼•]**

```Rust
let empty_silce_i32: &[i32] = &[];
let empty_silce_str: &[String] = &[];
```

å–å€¼ï¼š

```Rust
let s = String::from("hello");
// è·å–å­—ç¬¦ä¸²sçš„å‰ä¸¤ä½
let slice = &s[0..2];
let slice = &s[..2]; // ç­‰æ•ˆä¸Šä¸€è¡Œçš„å†™æ³•

// è·å–å­—ç¬¦ä¸²çš„ç¬¬å››ä½åˆ°æœ€åä¸€ä½
let slice = &s[4..len];
let slice = &s[4..]; // ç­‰æ•ˆä¸Šä¸€è¡Œçš„å†™æ³•

// è·å–å®Œæ•´çš„å­—ç¬¦ä¸²
let len = s.len();
let slice = &s[0..len];
let slice = &s[..]; // ç­‰æ•ˆä¸Šä¸¤è¡Œçš„å†™æ³•
```

> æ³¨æ„ï¼š
> `Rust` åœ¨æå–ä¸­æ–‡çš„æ—¶å€™è¦æ³¨æ„ä¸€ä¸ªä¸­æ–‡å ä¸‰ä¸ªå­—èŠ‚ï¼Œå¦‚ä½•æ“ä½œè¯·çœ‹[è¿™é‡Œ](###åˆ‡ç‰‡) //todo

```Rust
    let s = "ä¸­å›½äºº";
    println!("{}",s.len());
    // è¾“å‡º 9
```

**å­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç±»å‹æ ‡è¯†æ˜¯ `&str`**ï¼Œæ‰€ä»¥å‡½æ•°åœ¨è¿”å›åˆ‡ç‰‡æ—¶å¯ä»¥ç›´æ¥è¿”å› `&str`

#### å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åˆ‡ç‰‡

`let a = "Hello, world!";` `a` çš„å®é™…ç±»å‹æ˜¯ `&str`

**`Rust` ä¸­çš„å­—ç¬¦æ˜¯ `Unicode` ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® `4` ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ `UTF-8` ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(`1 - 4`)**

`Rust` åœ¨è¯­è¨€çº§åˆ«ï¼Œåªæœ‰ä¸€ç§å­—ç¬¦ä¸²ç±»å‹ï¼š `str`ï¼Œå®ƒé€šå¸¸æ˜¯ä»¥å¼•ç”¨ç±»å‹å‡ºç° `&str`ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡æåˆ°çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚æ‰€ä»¥åœ¨ `Rust` ä¸­æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ `String` ç±»å‹å’Œ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ `UTF-8` ç¼–ç 

##### `String` ä¸ `&str` çš„è½¬æ¢

`&str` è½¬ `String`

```Rust
let a = String::from("hello world");
// æˆ–
let a = "hello world".to_string();
```

`String` è½¬ `&str`

> å–å¼•ç”¨å³å¯

```Rust
// å£°æ˜ä¸€ä¸ª String ç±»å‹çš„æ•°æ®
let s = String::from("hello,world!");
// è·å– &str ç±»å‹æ•°æ®
println!(&s)
println!(&s[..])
println!(s.as_str())
```

#### å­—ç¬¦ä¸²ç´¢å¼•

> åœ¨ `Rust` çš„å­—ç¬¦ä¸²ä¸­é€šè¿‡ç´¢å¼•çš„æ–¹å¼è®¿é—®å­—ç¬¦ä¸²çš„æŸä¸ªå­—ç¬¦æˆ–è€…å­ä¸²æ˜¯**å¤±è´¥**çš„ï¼ŒåŸå› æ˜¯ `Rust` çš„å­—ç¬¦ä¸²å®é™…ä¸Šå­˜å‚¨çš„æ˜¯[ `u8` ]ï¼Œä¸€ä¸ªå­—èŠ‚æ•°ç»„ã€‚åœ¨é€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶è¦**æ ¼å¤–æ³¨æ„**

#### æ“ä½œå­—ç¬¦ä¸²

##### è¿½åŠ (`Push`)

å­—ç¬¦ä¸²**å°¾éƒ¨**å¯ä»¥ä½¿ç”¨ `push()` æ–¹æ³•è¿½åŠ å­—ç¬¦ `char`ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `push_str()` æ–¹æ³•è¿½åŠ å­—ç¬¦ä¸²å­—é¢é‡ï¼Œæƒ³è¦æ”¹å˜å½“å‰å˜é‡çš„å­—ç¬¦ä¸²æ—¶å˜é‡å¿…é¡»åŠ ä¸Š `mut` å…³é”®å­—ä¿®é¥°ã€‚

> æ³¨æ„ï¼šä¸Šè¿°çš„ä¸¤ç§æ–¹æ¡ˆéƒ½æ˜¯åœ¨**åŸæœ‰çš„å­—ç¬¦ä¸²ä¸Šè¿½åŠ ï¼Œä½†ä¸ä¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²**ï¼Œå½“ç„¶ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­ä¹Ÿæ˜¯ä¸äºˆé€šè¿‡çš„

##### æ’å…¥(`Insert`)

å¯ä»¥ä½¿ç”¨ `insert()` æ–¹æ³•æ’å…¥å•ä¸ªå­—ç¬¦ `char` æˆ–ä½¿ç”¨ `insert_str()` æ’å…¥å­—ç¬¦ä¸²å­—é¢é‡ï¼ŒåŒæ ·çš„ï¼ŒåŸå§‹å‡½æ•°å˜é‡éœ€è¦ä½¿ç”¨ `mut` å…³é”®å­—ä¿®é¥°ã€‚

> æ³¨æ„ï¼šæ’å…¥æ—¶ä½¿ç”¨ç´¢å¼•æ—¶ä¹Ÿéœ€è¦æ³¨æ„ä¸­æ–‡å ä½çš„æƒ…å†µ

##### æ›¿æ¢(`Replace`)

- `replace`
  - è¯¥æ–¹æ³•**å¯é€‚ç”¨äº `String` å’Œ `&str` ç±»å‹**ã€‚`replace()` æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯**è¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²**ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯**æ–°çš„å­—ç¬¦ä¸²**ã€‚è¯¥æ–¹æ³•ä¼šæ›¿æ¢æ‰€æœ‰åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ã€‚è¯¥æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ã€‚
- `replacen`
  - è¯¥æ–¹æ³•**å¯é€‚ç”¨äº `String` å’Œ `&str` ç±»å‹**ã€‚`replacen()` æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå‰ä¸¤ä¸ªå‚æ•°ä¸ `replace()` æ–¹æ³•ä¸€æ ·ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°åˆ™è¡¨ç¤ºæ›¿æ¢çš„ä¸ªæ•°ã€‚è¯¥æ–¹æ³•æ˜¯**è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚
- `replace_range`
  - è¯¥æ–¹æ³•**ä»…é€‚ç”¨äº `String` ç±»å‹**`ã€‚replace_range` æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦**æ›¿æ¢å­—ç¬¦ä¸²çš„èŒƒå›´ï¼ˆ`Range`ï¼‰**ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯**æ–°çš„å­—ç¬¦ä¸²**ã€‚è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œ**ä¸ä¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²**ã€‚è¯¥æ–¹æ³•éœ€è¦ä½¿ç”¨ `mut` å…³é”®å­—ä¿®é¥°ã€‚
- åˆ é™¤ (`Delete`)

  > ä¸å­—ç¬¦ä¸²åˆ é™¤ç›¸å…³çš„æ–¹æ³•æœ‰ `4` ä¸ªï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ `pop()`ï¼Œ`remove()`ï¼Œ`truncate()`ï¼Œ`clear()`ã€‚è¿™å››ä¸ªæ–¹æ³•ä»…é€‚ç”¨äº `String` ç±»å‹ã€‚

  - `pop` â€”â€” åˆ é™¤å¹¶è¿”å›å­—ç¬¦ä¸²çš„æœ€åä¸€ä¸ªå­—ç¬¦

    **è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ï¼Œå­˜åœ¨è¿”å›å€¼ï¼Œå…¶è¿”å›å€¼æ˜¯ä¸€ä¸ª `Option` ç±»å‹ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸ºç©ºï¼Œåˆ™è¿”å› `None`

  - `remove` â€”â€”åˆ é™¤å¹¶è¿”å›å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®çš„å­—ç¬¦

    **è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ï¼Œå­˜åœ¨è¿”å›å€¼ï¼Œå…¶è¿”å›å€¼æ˜¯åˆ é™¤ä½ç½®çš„å­—ç¬¦ä¸²ï¼Œåªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè¯¥å­—ç¬¦èµ·å§‹ç´¢å¼•ä½ç½®ã€‚`remove()` æ–¹æ³•æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œå¦‚æœå‚æ•°æ‰€ç»™çš„ä½ç½®ä¸æ˜¯åˆæ³•çš„å­—ç¬¦è¾¹ç•Œï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚

  - `truncate` â€”â€”åˆ é™¤å­—ç¬¦ä¸²ä¸­ä»æŒ‡å®šä½ç½®å¼€å§‹åˆ°ç»“å°¾çš„å…¨éƒ¨å­—ç¬¦

    **è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚æ— è¿”å›å€¼ã€‚è¯¥æ–¹æ³• `truncate()` æ–¹æ³•æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œå¦‚æœå‚æ•°æ‰€ç»™çš„ä½ç½®ä¸æ˜¯åˆæ³•çš„å­—ç¬¦è¾¹ç•Œï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚

  - `clear` â€”â€” æ¸…ç©ºå­—ç¬¦ä¸²

    **è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚è°ƒç”¨åï¼Œåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œç›¸å½“äº `truncate()` æ–¹æ³•å‚æ•°ä¸º `0` çš„æ—¶å€™ã€‚

##### è¿æ¥ (`Concatenate`)

1. ä½¿ç”¨ `+` æˆ–è€… `+=` è¿æ¥å­—ç¬¦ä¸²

   ä½¿ç”¨ `+` æˆ–è€… `+=` è¿æ¥å­—ç¬¦ä¸²ï¼Œè¦æ±‚å³è¾¹çš„å‚æ•°å¿…é¡»ä¸ºå­—ç¬¦ä¸²çš„åˆ‡ç‰‡å¼•ç”¨ï¼ˆ`Slice`ï¼‰ç±»å‹ã€‚å…¶å®å½“è°ƒç”¨ `+` çš„æ“ä½œç¬¦æ—¶ï¼Œç›¸å½“äºè°ƒç”¨äº† `std::string` æ ‡å‡†åº“ä¸­çš„ `add()` æ–¹æ³•ï¼Œè¿™é‡Œ `add()` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¼•ç”¨çš„ç±»å‹ã€‚å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨ `+` æ—¶ï¼Œ å¿…é¡»ä¼ é€’åˆ‡ç‰‡å¼•ç”¨ç±»å‹ã€‚ä¸èƒ½ç›´æ¥ä¼ é€’ `String` ç±»å‹ã€‚`+` æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å˜é‡å£°æ˜å¯ä»¥ä¸éœ€è¦ `mut` å…³é”®å­—ä¿®é¥°ã€‚

2. ä½¿ç”¨ `format!` è¿æ¥å­—ç¬¦ä¸²

   `format!` è¿™ç§æ–¹å¼é€‚ç”¨äº `String` å’Œ `&str` ã€‚`format!` çš„ç”¨æ³•ä¸ `print!` çš„ç”¨æ³•ç±»ä¼¼

   ```rust
   fn main() {
       let s1 = "hello";
       let s2 = String::from("rust");
       let s = format!("{} {}!", s1, s2);
       println!("{}", s);
   }
   ```

##### å­—ç¬¦ä¸²è½¬ä¹‰

é€šè¿‡è½¬ä¹‰çš„æ–¹å¼ `\` è¾“å‡º `ASCII` å’Œ `Unicode` å­—ç¬¦ã€‚

##### æ“ä½œ `UTF-8` å­—ç¬¦

###### å­—ç¬¦

æƒ³è¦ä»¥ `Unicode` å­—ç¬¦çš„æ–¹å¼éå†å­—ç¬¦ä¸²ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨ `chars` æ–¹æ³•

```rust
for c in "ä¸­å›½äºº".chars() {
    println!("{}", c);
}
```

###### å­—èŠ‚

å­—ç¬¦ä¸²çš„åº•å±‚å­—èŠ‚æ•°ç»„è¡¨ç°å½¢å¼

###### è·å–å­ä¸²

> ç”±äº `Rust` çš„å­˜å‚¨å½¢æ€å¹¶ä¸æ˜¯äººè¯†åˆ«çš„å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨å–å€¼çš„æ—¶å€™éœ€è¦ç‰¹åˆ«æ³¨æ„

æƒ³è¦å‡†ç¡®çš„ä» `UTF-8` å­—ç¬¦ä¸²ä¸­è·å–å­ä¸²æ˜¯è¾ƒä¸ºå¤æ‚çš„äº‹æƒ…ï¼Œä¾‹å¦‚æƒ³è¦ä» `hollaä¸­å›½äººà¤¨à¤®à¤¸à¥à¤¤à¥‡` è¿™ç§å˜é•¿çš„å­—ç¬¦ä¸²ä¸­å–å‡ºæŸä¸€ä¸ªå­ä¸²ï¼Œä½¿ç”¨æ ‡å‡†åº“ä½ æ˜¯åšä¸åˆ°çš„ã€‚ ä½ éœ€è¦åœ¨ `crates.io` ä¸Šæœç´¢ `utf8` æ¥å¯»æ‰¾æƒ³è¦çš„åŠŸèƒ½ã€‚

###### ä¸ºä»€ä¹ˆ `String` å¯å˜ä½† `&str` ä¸å¯å˜

å› ä¸º `&str` çš„æ•°æ®æ˜¯ä¸å¯å˜çš„ï¼Œå­˜å‚¨åœ¨æ ˆä¸­çš„ï¼Œèƒ½å­˜å‚¨åœ¨æ ˆä¸­çš„æ•°æ®éƒ½**å¿…é¡»**å ç”¨å·²çŸ¥ä¸”å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œè€Œ `String` çš„å­˜åœ¨å°±æ˜¯ä¸ºäº†åŠ¨æ€å­˜å‚¨çš„ï¼Œæ‰€ä»¥ `String` æ˜¯å­˜å‚¨åœ¨å †ä¸­çš„ã€‚

###### å¦‚ä½•æ‰‹åŠ¨é‡Šæ”¾å†…å­˜

`Rust` ä¸­æä¾›äº† `drop` å‡½æ•°æ¥è¿›è¡Œé‡Šæ”¾å†…å­˜ï¼Œé»˜è®¤ç¦»å¼€å˜é‡çš„ä½œç”¨åŸŸæ—¶ä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜ï¼Œå³ï¼Œåœ¨ `}` çš„ç»“å°¾ä¼šè‡ªåŠ¨è°ƒç”¨ `drop`ã€‚

### å…ƒç»„

å…ƒç»„æ˜¯ç”±å¤šç§ç±»å‹ç»„åˆåˆ°ä¸€èµ·å½¢æˆçš„ï¼Œå› æ­¤å®ƒæ˜¯å¤åˆç±»å‹ï¼Œå…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå…ƒç»„ä¸­å…ƒç´ çš„é¡ºåºä¹Ÿæ˜¯å›ºå®šçš„ã€‚

```rust
let tup: (i32,f64,u8) = (500,6.4,10)
```

> æ³¨ï¼š
>
> - **å…ƒç»„ä¸å…·å¤‡ä»»ä½•æ¸…æ™°çš„å«ä¹‰**

#### å¦‚ä½•å–å…ƒç¥–ä¸­çš„å€¼

```rust
let tup: (i32,f64,u8) = (500,6.4,10);
// ä½¿ç”¨ . æ¥è®¿é—®å…ƒç»„
println!("tup index 1 {}",tup.1);
// ä½¿ç”¨åŒ¹é…æ¨¡å¼å–å€¼
let (x, y, z) = tup;
println!("The value of y is: {}", y);
```

#### ä½¿ç”¨åœºæ™¯

- ä½¿ç”¨å…ƒç»„è¿”å›å¤šä¸ªå€¼

#### æ³¨æ„

- ç›®å‰ `Rust` æ‰“å°å…ƒç»„çš„æ—¶å€™æœ€å¤šåªèƒ½æ˜¯ `12` ä¸ªï¼Œè¿™æ˜¯å› ä¸º `Rust` æ ‡å‡†åº“ä¸­å¯¹äºå…ƒç»„å®ç° Â `Debug trait` æœ‰ä¸€ä¸ªé™åˆ¶ï¼šåªæœ‰é•¿åº¦å°äºæˆ–ç­‰äº `12` çš„å…ƒç»„æ‰è‡ªåŠ¨å®ç°äº† Â `Debug trait`ã€‚è¿™æ„å‘³ç€å¯ä»¥æ‰“å°é•¿åº¦æœ€å¤šä¸º `12` çš„å…ƒç»„ï¼Œä½†æ˜¯å¯¹äºæ›´é•¿çš„å…ƒç»„ï¼Œä½ å¿…é¡»æ‰‹åŠ¨å®ç° Â `Debug`

### ç»“æ„ä½“

- ç”±å¤šç§ç±»å‹ç»„åˆè€Œæˆ
- ç»“æ„ä½“å¯ä»¥ä¸ºå†…éƒ¨çš„æ¯ä¸ªå­—æ®µèµ·ä¸€ä¸ªå¯Œæœ‰å«ä¹‰çš„åç§°

#### è¯­æ³•

##### å®šä¹‰ç»“æ„ä½“

**ç»„æˆ**

- é€šè¿‡å…³é”®å­— `struct` å®šä¹‰
- ä¸€ä¸ªæ¸…æ™°æ˜ç¡®çš„ç»“æ„ä½“ã€Œåç§°ã€
- å‡ ä¸ªæœ‰åå­—çš„ç»“æ„ä½“ã€Œå­—æ®µã€

```rust
struct User{
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
```

**åˆå§‹åŒ–**

1. åˆå§‹åŒ–å®ä¾‹æ—¶ï¼Œ**æ¯ä¸ªå­—æ®µ**éƒ½**å¿…é¡»**è¦è¿›è¡Œåˆå§‹åŒ–
2. åˆå§‹åŒ–æ—¶çš„å­—æ®µé¡ºåº**ä¸éœ€è¦**å’Œç»“æ„ä½“å®šä¹‰æ—¶çš„é¡ºåºä¸€è‡´

**å–å€¼**

ç›´æ¥ä½¿ç”¨ `.` æ¥è¿›è¡Œå–å€¼ï¼Œæ¯”å¦‚ä¸Šé¢çš„ `User` ç»“æ„ä½“ä¸­è¦è·å– `username` å­—æ®µçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ `User.username` æ¥è·å–ï¼Œå½“ç„¶ `User` å¾—æ›¿æ¢ä¸ºä½ å£°æ˜çš„å˜é‡

**ä¿®æ”¹ç»“æ„ä½“çš„å€¼**

åœ¨å®šä¹‰ç»“æ„ä½“çš„æ—¶å€™æ ‡è®°ä¸Š `mut` ä¿®é¥°ç¬¦ï¼Œå°±å¯ä»¥ä¿®æ”¹ç»“æ„ä½“çš„å€¼äº†

**ç®€åŒ–å†™æ³•åˆå§‹åŒ–**

åœ¨ `Rust` ä¸­ï¼Œå¦‚æœå‡½æ•°å‚æ•°å’Œç»“æ„ä½“å­—æ®µåŒåæ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç¼©ç•¥çš„æ–¹å¼è¿›è¡Œåˆå§‹åŒ–ï¼Œå³ä¸‹é¢çš„ç®€åŒ–å†™æ³•

```rust
// å¸¸è§„å†™æ³•
fn build_user(email: String, username: String) -> User {
    User {
        email: email,
        username: username,
        active: true,
        sign_in_count: 1,
    }
}

// ç®€åŒ–å†™æ³•
fn build_user(email: String, username: String) -> User {
    User {
        email,
        username,
        active: true,
        sign_in_count: 1,
    }
}
```

**ç®€åŒ–æ›´æ–°**

> - `..struct` è¡¨ç¤ºå‡¡æ˜¯æ²¡æœ‰æ˜¾ç¤ºå£°æ˜çš„å­—æ®µï¼Œå…¨éƒ¨ä» `..struct` åé¢çš„å˜é‡ç»“æ„ä½“ä¸­è‡ªåŠ¨è·å–ï¼Œæ³¨æ„ï¼š`..struct` å¿…é¡»æ”¾åœ¨èµ‹å€¼çš„ç»“æ„ä½“çš„å°¾éƒ¨ä½¿ç”¨ï¼Œè®© `Rust` çŸ¥é“æ˜¯ä»å“ªé‡Œå¼€å§‹å–å€¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
> - ç»“æ„ä½“æ›´æ–°å€¼ä»ä¸Šä¸€ä¸ªç»“æ„ä½“ä¸­å–å€¼çš„æ—¶å€™æ³¨æ„ç±»å‹ï¼Œ[åŸºç¡€ç±»å‹](#å˜é‡ç»‘å®šèƒŒåçš„æ•°æ®äº¤äº’)èµ‹å€¼çš„æ—¶å€™å®é™…ä¸Šæ˜¯ `Copy` è€Œå…¶å®ƒç±»å‹åˆ™æ˜¯**æ‰€æœ‰æƒ**è¿›è¡Œäº†è½¬ç§»ï¼Œå³ä¸‹é¢çš„ `username` è¿™ä¸ªå­—æ®µæ— æ³•åœ¨ `user1` ä¸­ä½¿ç”¨äº†ã€‚**æŠŠç»“æ„ä½“ä¸­å…·æœ‰æ‰€æœ‰æƒçš„å­—æ®µè½¬ç§»å‡ºå»åï¼Œå°†æ— æ³•å†è®¿é—®è¯¥å­—æ®µï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®å…¶å®ƒçš„å­—æ®µ**

```rust
// å¸¸è§„æ›´æ–°
let user2 = User {
    active: user1.active,
    username: user1.username,
    email: String::from("another@example.com"),
    sign_in_count: user1.sign_in_count,
};

// ç®€åŒ–æ›´æ–°
let user2 = User {
    email: String::from("another@example.com"),
    ..user1
}
```

##### å…ƒç»„ç»“æ„ä½“(`Tuple Struct`)

ç»“æ„ä½“å¿…é¡»è¦æœ‰åç§°ï¼Œä½†æ˜¯ç»“æ„ä½“çš„å­—æ®µå¯ä»¥æ²¡æœ‰åç§°ï¼Œè¿™ç§ç»“æ„ä½“é•¿å¾—å¾ˆåƒå…ƒç»„ï¼Œå› æ­¤è¢«ç§°ä¸ºå…ƒç»„ç»“æ„ä½“

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

let black = Color(0, 0, 0);
let origin = Point(0, 0, 0);
```

##### ä½¿ç”¨ `#[derive(Debug)]` æ¥æ‰“å°ç»“æ„ä½“çš„ä¿¡æ¯

å¦‚æœä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼Œåœ¨ç¼–è¾‘å™¨å†…å°±ä¼šç›´æ¥æŠ¥é”™äº†ï¼Œæç¤º `` `User` ä¸å®ç° `Debug` (`{:?}` éœ€è¦) ``ï¼Œè¿™æ—¶å€™å°±éœ€è¦åœ¨ç»“æ„ä½“å‰é¢ä¸Šé¢åŠ ä¸Š `#[derive(Debug)]` ï¼Œè¿™æ · `Rust` å°±ä¼šè‡ªåŠ¨ä¸ºç»“æ„ä½“å®ç° `Debug` è¿™ä¸ª traitï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ `println!` æ¥æ‰“å°ç»“æ„ä½“äº†ã€‚

```rust
// #[derive(Debug)]
struct User{
    username: String,
    age: u8,
    email: String,
}

fn main(){
    let u = User{
        username: String::from("zhangsan"),
        age: 18,
        email: String::from("12@qq.com"),
    };
    println!("username: {:?}",u);
}
```

å¦‚æœè¦å®Œæ•´çš„è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå»ºè®®å°† `println!` æ›¿æ¢ä¸º `dbg!` è¾“å‡ºçš„å†…å®¹ä¸ºï¼šä»£ç æ‰€åœ¨çš„æ–‡ä»¶åã€è¡Œå·ã€è¡¨è¾¾å¼ä»¥åŠè¡¨è¾¾å¼çš„å€¼ã€‚

å¦‚æœå°†ä¸Šè¿°çš„ä»£ç æ›¿æ¢ä¸º `dbg!("username: {:?}",u);`ï¼Œåˆ™è¾“å‡ºçš„ç»“æœä¸ºï¼š

```log
[src/main.rs:51:5] "username: {:?}" = "username: {:?}"
[src/main.rs:51:5] u = User {
    username: "zhangsan",
    age: 18,
    email: "12@qq.com",
}
```

æ³¨æ„ï¼š

1. `rust` ä¸ä¼šé»˜è®¤å®ç° `Debug`ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ï¼šæ‰‹åŠ¨å®ç°ï¼›ä½¿ç”¨ `derive` æ¥è¿›è¡Œå®ç°
2. `dbg!` è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯è¾“å‡º `stderr`ï¼Œè€Œ `println!` è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º `stdout`

### æšä¸¾

å…³é”®è¯ï¼š`enum`

> æšä¸¾ç±»å‹æ˜¯ä¸€ä¸ªç±»å‹ï¼Œå®ƒä¼šåŒ…å«æ‰€æœ‰å¯èƒ½çš„æšä¸¾æˆå‘˜, è€Œæšä¸¾å€¼æ˜¯è¯¥ç±»å‹ä¸­çš„å…·ä½“æŸä¸ªæˆå‘˜çš„å®ä¾‹ã€‚

æ³¨æ„ï¼šç›®å‰æšä¸¾å€¼è¿˜ä¸èƒ½å¸¦æœ‰å€¼ï¼Œåªèƒ½ä½¿ç”¨ç»“æ„ä½“æ¥å®ç°

### æ•°ç»„

`Rust` ä¸­æ•°ç»„æœ‰ä¸¤ç§ï¼š
- å›ºå®šé•¿åº¦çš„æ•°ç»„ `arry`
- åŠ¨æ€å¢é•¿çš„æ•°ç»„ `Vector`

#### å›ºå®šé•¿åº¦çš„æ•°ç»„

``` rust
// åŸºç¡€
let a = [1,2,3,4,5]
// å£°æ˜æ•°ç»„ç±»å‹
let b: [i32;5] = [1,2,3,4,5]
// é‡å¤æ•°æ®çš„æ•°ç»„ï¼Œä»¥ä¸‹ä¸ºæ•°ç»„é•¿åº¦ä¸º5ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯3ã€‚å³[3,3,3,3,3]
let c = [3;5]
```

#### åŠ¨æ€å¢é•¿çš„æ•°ç»„

``` rust
let a = vec![1,2,3,4,5]
```

#### è®¿é—®æ•°ç»„

``` rust
let a = [1,2,3,4,5]
println!("a[0] = {}",a[0]) // è®¿é—®ç¬¬ä¸€ä¸ªå…ƒç´ 
println!("a[1] = {}",a[1]) // è®¿é—®ç¬¬äºŒä¸ªå…ƒç´ 
```

#### è¶Šç•Œè®¿é—®

``` rust
let a = [1,2,3,4,5];
println!("a[6] = {}",a[6]);
// è¿è¡Œç»“æœï¼šthread 'main' panicked at 'index out of bounds: the len is 5 but the index is 6', src/main.rs:6:18
```
