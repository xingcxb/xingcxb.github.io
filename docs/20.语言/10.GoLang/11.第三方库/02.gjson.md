---
title: gjson
date: 2022-06-07 17:23:30
permalink: /language/go/d3c5fd/
categories:
  - è¯­è¨€
  - GoLang
  - gjson
tags:
  - GoLang
  - ç¬¬ä¸‰æ–¹åº“
  - gjson
  - å¿«é€Ÿè§£æjson
---

## `gjson`åº“ç®€ä»‹

`GJSON`æ˜¯ä¸€ä¸ª`Go`åŒ…ï¼Œå®ƒæä¾›äº†ä¸€ç§ä»`json`æ–‡æ¡£ä¸­è·å–å€¼çš„å¿«é€Ÿè€Œç®€å•çš„æ–¹æ³•ã€‚å®ƒå…·æœ‰å•è¡Œæ£€ç´¢ï¼Œç‚¹è¡¨ç¤ºæ³•è·¯å¾„ï¼Œè¿­ä»£å’Œè§£æ`json`è¡Œç­‰åŠŸèƒ½ã€‚

<!-- more -->

<InArticleAdsense
    data-ad-client="ca-pub-1725717718088510"
    data-ad-slot="7426219401">
</InArticleAdsense>

## å¼€æºåº“åœ°å€

[tidwall/gjson: Get JSON values quickly - JSON parser for Go (github.com)](https://github.com/tidwall/gjson)

## è·å–å€¼

``` Go
package main

import "github.com/tidwall/gjson"

const json = `{"name":{"first":"Janet","last":"Prichard"},"age":47}`

func main() {
	value := gjson.Get(json, "name.last")
	println(value.String())
}
```

æ‰“å°ï¼š

``` log
Prichard
```

ä½¿ç”¨å¾ˆç®€å•ï¼Œåªéœ€è¦ä¼ å…¥`JSON`ä¸²å’Œè¦è¯»å–çš„é”®è·¯å¾„å³å¯ã€‚æ³¨æ„ä¸€ç‚¹ç»†èŠ‚ï¼Œå› ä¸º`gjson.Get()`å‡½æ•°å®é™…ä¸Šè¿”å›çš„æ˜¯`gjson.Result`ç±»å‹ï¼Œæˆ‘ä»¬è¦è°ƒç”¨å…¶ç›¸åº”çš„æ–¹æ³•è¿›è¡Œè½¬æ¢å¯¹åº”çš„ç±»å‹ã€‚å¦‚ä¸Šé¢çš„`String()`å’Œ`Int()`æ–¹æ³•ã€‚

å¦‚æœæ˜¯ç›´æ¥æ‰“å°è¾“å‡ºï¼Œå…¶å®å¯ä»¥çœç•¥`String()`ï¼Œ`fmt`åŒ…çš„å¤§éƒ¨åˆ†å‡½æ•°éƒ½å¯ä»¥å¯¹å®ç°`fmt.Stringer`æ¥å£çš„ç±»å‹è°ƒç”¨`String()`æ–¹æ³•ã€‚

## é”®è·¯å¾„

é”®è·¯å¾„å®é™…ä¸Šæ˜¯ä»¥.åˆ†éš”çš„ä¸€ç³»åˆ—é”®ã€‚`gjson`æ”¯æŒåœ¨é”®ä¸­åŒ…å«é€šé…ç¬¦`*`å’Œ`?`ï¼Œ`*`åŒ¹é…ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œ`?`åŒ¹é…å•ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚`xi*`å¯ä»¥åŒ¹é…`xit/xite/xike`ç­‰ä»¥`xi`å¼€å¤´çš„é”®ï¼Œ`xi?`åªèƒ½åŒ¹é…`xit/xip`ç­‰ä»¥`xi`å¼€å¤´ä¸”åé¢åªæœ‰ä¸€ä¸ªå­—ç¬¦çš„é”®ã€‚

æ•°ç»„ä½¿ç”¨é”®å `+` `.` `+` ç´¢å¼•ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰çš„æ–¹å¼è¯»å–å…ƒç´ ï¼Œå¦‚æœé”®`pets`å¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆ`pets.0`è¯»å–æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ`pets.1`è¯»å–ç¬¬äºŒä¸ªå…ƒç´ ã€‚

æ•°ç»„é•¿åº¦ä½¿ç”¨**é”®å `+` `.` `+` `#`**è·å–ï¼Œä¾‹å¦‚`pets.#`è¿”å›æ•°ç»„`pets`çš„é•¿åº¦ã€‚

å¦‚æœé”®åä¸­å‡ºç°`.`ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨`\`è¿›è¡Œè½¬ä¹‰ã€‚

``` go
package main

const json = `
{
  "name":{"first":"Tom", "last": "Anderson"},
  "age": 37,
  "children": ["Sara", "Alex", "Jack"],
  "fav.movie": "Dear Hunter",
  "friends": [
    {"first": "Dale", "last":"Murphy", "age": 44, "nets": ["ig", "fb", "tw"]},
    {"first": "Roger", "last": "Craig", "age": 68, "nets": ["fb", "tw"]},
    {"first": "Jane", "last": "Murphy", "age": 47, "nets": ["ig", "tw"]}
  ]
}
`

func main() {
  fmt.Println("last name:", gjson.Get(json, "name.last"))
  fmt.Println("age:", gjson.Get(json, "age"))
  fmt.Println("children:", gjson.Get(json, "children"))
  fmt.Println("children count:", gjson.Get(json, "children.#"))
  fmt.Println("second child:", gjson.Get(json, "children.1"))
  fmt.Println("third child*:", gjson.Get(json, "child*.2"))
  fmt.Println("first c?ild:", gjson.Get(json, "c?ildren.0"))
  fmt.Println("fav.moive", gjson.Get(json, `fav.\moive`))
  fmt.Println("first name of friends:", gjson.Get(json, "friends.#.first"))
  fmt.Println("last name of second friend:", gjson.Get(json, "friends.1.last"))
}
```

å‰`3`ä¸ªæ¯”è¾ƒç®€å•ï¼Œå°±ä¸èµ˜è¿°äº†ã€‚çœ‹åé¢å‡ ä¸ªï¼š

- `children.#`ï¼šè¿”å›æ•°ç»„`children`çš„é•¿åº¦ï¼›
- `children.1`ï¼šè¯»å–æ•°ç»„`children`çš„ç¬¬`2`ä¸ªå…ƒç´ ï¼ˆæ³¨æ„ç´¢å¼•ä»`0`å¼€å§‹ï¼‰ï¼›
- `child*.2`ï¼šé¦–å…ˆ`child*`åŒ¹é…`children`ï¼Œ`.2`è¯»å–ç¬¬`3`ä¸ªå…ƒç´ ï¼›
- `c?ildren.0`ï¼š`c?ildren`åŒ¹é…åˆ°`children`ï¼Œ`.0`è¯»å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›
- `fav.\moive`ï¼šå› ä¸ºé”®åä¸­å«æœ‰`.`ï¼Œæ•…éœ€è¦`\`è½¬ä¹‰ï¼›
- `friends.#.first`ï¼šå¦‚æœæ•°ç»„å`#`åè¿˜æœ‰å†…å®¹ï¼Œåˆ™ä»¥åé¢çš„è·¯å¾„è¯»å–æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚æ‰€ä»¥è¯¥æŸ¥è¯¢è¿”å›çš„æ•°ç»„æ‰€æœ‰`friends`çš„`first`å­—æ®µç»„æˆï¼›
- `friends.1.last`ï¼šè¯»å–`friends`ç¬¬`2`ä¸ªå…ƒç´ çš„`last`å­—æ®µã€‚
è¿è¡Œç»“æœï¼š

``` text
last name: Anderson
age: 37
children: ["Sara", "Alex", "Jack"]
children count: 3
second child: Alex
third child*: Jack
first c?ild: Sara
fave.moive 
first name of friends: ["Dale","Roger","Jane"]
last name of second friend: Craig
```

å¯¹äºæ•°ç»„ï¼Œ`gjson`è¿˜æ”¯æŒæŒ‰æ¡ä»¶æŸ¥è¯¢å…ƒç´ ï¼Œ`#`(æ¡ä»¶)è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œ`#`(æ¡ä»¶)`#`è¿”å›æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚æ‹¬å·å†…çš„æ¡ä»¶å¯ä»¥æœ‰`==`ã€`!=`ã€`<`ã€`<=`ã€`>`ã€`>=`ï¼Œè¿˜æœ‰ç®€å•çš„æ¨¡å¼åŒ¹é…`%`ï¼ˆç¬¦åˆæŸä¸ªæ¨¡å¼ï¼‰ï¼Œ`!%`ï¼ˆä¸ç¬¦åˆæŸä¸ªæ¨¡å¼ï¼‰ï¼š

``` go
fmt.Println(gjson.Get(json, `friends.#(last="Murphy").first`))
fmt.Println(gjson.Get(json, `friends.#(last="Murphy")#.first`))
fmt.Println(gjson.Get(json, "friends.#(age>45)#.last"))
fmt.Println(gjson.Get(json, `friends.#(first%"D*").last`))
fmt.Println(gjson.Get(json, `friends.#(first!%"D*").last`))
fmt.Println(gjson.Get(json, `friends.#(nets.#(=="fb"))#.first`))
```

è¿˜æ˜¯ä½¿ç”¨ä¸Šé¢çš„`JSON`ä¸²ã€‚

- `friends.#(last="Murphy").first`ï¼š`friends.#(last="Murphy")`è¿”å›æ•°ç»„`friends`ä¸­ç¬¬ä¸€ä¸ª`last`ä¸º`Murphy`çš„å…ƒç´ ï¼Œ`.first`è¡¨ç¤ºå–å‡ºè¯¥å…ƒç´ çš„`first`å­—æ®µè¿”å›ï¼›
- `friends.#(last="Murphy")#.first`ï¼š`friends.#(last="Murphy")#`è¿”å›æ•°ç»„`friends`ä¸­æ‰€æœ‰çš„`last`ä¸º`Murphy`çš„å…ƒç´ ï¼Œç„¶åè¯»å–å®ƒä»¬çš„`first`å­—æ®µæ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­è¿”å›ã€‚æ³¨æ„ä¸ä¸Šé¢ä¸€ä¸ªçš„åŒºåˆ«ï¼›
- `friends.#(age>45)#.last`ï¼š`friends.#(age>45)#`è¿”å›æ•°ç»„`friends`ä¸­æ‰€æœ‰å¹´é¾„å¤§äº`45`çš„å…ƒç´ ï¼Œç„¶åè¯»å–å®ƒä»¬çš„`last`å­—æ®µè¿”å›ï¼›
- `friends.#(first%"D*").last`ï¼š`friends.#(first%"D*")`è¿”å›æ•°ç»„`friends`ä¸­ç¬¬ä¸€ä¸ª`first`å­—æ®µæ»¡è¶³æ¨¡å¼`D*`çš„å…ƒç´ ï¼Œå–å‡ºå…¶`last`å­—æ®µè¿”å›ï¼›
- `friends.#(first!%"D*").last`ï¼š`friends.#(first!%â€œD*â€)`è¿”å›æ•°ç»„`friends`ä¸­ç¬¬ä¸€ä¸ª`first`å­—æ®µ**ä¸**æ»¡è¶³æ¨¡å¼**D**çš„å…ƒç´ ï¼Œè¯»å–å…¶`last`å­—æ®µè¿”å›ï¼›
- `friends.#(nets.#(=="fb"))#.first`ï¼šè¿™æ˜¯ä¸ªåµŒå¥—æ¡ä»¶ï¼Œ`friends.#(nets.#(=="fb"))#`è¿”å›æ•°ç»„`friends`çš„å…ƒç´ çš„`nets`å­—æ®µä¸­æœ‰`fb`çš„æ‰€æœ‰å…ƒç´ ï¼Œç„¶åå–å‡º`first`å­—æ®µè¿”å›ã€‚

è¿è¡Œç»“æœï¼š

``` text
Dale
["Dale","Jane"]
["Craig","Murphy"]
Murphy
Craig
["Dale","Roger"]
```

## ä¿®é¥°ç¬¦

ä¿®é¥°ç¬¦æ˜¯`gjson`æä¾›çš„éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå’Œé”®è·¯å¾„æ­é…ä½¿ç”¨ã€‚`gjson`æä¾›äº†ä¸€äº›å†…ç½®çš„ä¿®é¥°ç¬¦ï¼š

- `@reverse`ï¼šç¿»è½¬ä¸€ä¸ªæ•°ç»„ï¼›
- `@ugly`ï¼šç§»é™¤`JSON`ä¸­çš„æ‰€æœ‰ç©ºç™½ç¬¦ï¼›
- `@pretty`ï¼šä½¿`JSON`æ›´æ˜“ç”¨é˜…è¯»ï¼›
- `@this`ï¼šè¿”å›å½“å‰çš„å…ƒç´ ï¼Œå¯ä»¥ç”¨æ¥è¿”å›æ ¹å…ƒç´ ï¼›
- `@valid`ï¼šæ ¡éªŒ`JSON`çš„åˆæ³•æ€§ï¼›
- `@flatten`ï¼šæ•°ç»„å¹³å¦åŒ–ï¼Œå³å°†`["a", ["b", "c"]]`è½¬ä¸º`["a","b","c"]`ï¼›
- `@join`ï¼šå°†å¤šä¸ªå¯¹è±¡åˆå¹¶åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚
  
ä¿®é¥°ç¬¦çš„è¯­æ³•å’Œç®¡é“ç±»ä¼¼ï¼Œä»¥`|`åˆ†éš”é”®è·¯å¾„å’Œåˆ†éš”ç¬¦ã€‚

``` go
const json = `{
  "name":{"first":"Tom", "last": "Anderson"},
  "age": 37,
  "children": ["Sara", "Alex", "Jack"],
  "fav.movie": "Dear Hunter",
  "friends": [
    {"first": "Dale", "last":"Murphy", "age": 44, "nets": ["ig", "fb", "tw"]},
    {"first": "Roger", "last": "Craig", "age": 68, "nets": ["fb", "tw"]},
    {"first": "Jane", "last": "Murphy", "age": 47, "nets": ["ig", "tw"]}
  ]
}`

func main() {
  fmt.Println(gjson.Get(json, "children|@reverse"))
  fmt.Println(gjson.Get(json, "children|@reverse|0"))
  fmt.Println(gjson.Get(json, "friends|@ugly"))
  fmt.Println(gjson.Get(json, "friends|@pretty"))
  fmt.Println(gjson.Get(json, "@this"))

  nestedJSON := `{"nested": ["one", "two", ["three", "four"]]}`
  fmt.Println(gjson.Get(nestedJSON, "nested|@flatten"))

  userJSON := `{"info":[{"name":"dj", "age":18},{"phone":"123456789","email":"dj@example.com"}]}`
  fmt.Println(gjson.Get(userJSON, "info|@join"))
}
```

`children|@reverse`å…ˆè¯»å–æ•°ç»„`children`ï¼Œç„¶åä½¿ç”¨ä¿®é¥°ç¬¦`@reverse`ç¿»è½¬ä¹‹åè¿”å›ï¼Œè¾“å‡ºï¼š

``` text
["Jack","Alex","Sara"]
```

`children|@reverse|0`åœ¨ä¸Šé¢ç¿»è½¬çš„åŸºç¡€ä¸Šè¯»å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³åŸæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¾“å‡ºï¼š

``` text
Jack
```

`friends|@ugly`ç§»é™¤`friends`æ•°ç»„ä¸­çš„æ‰€æœ‰ç©ºç™½å­—ç¬¦ï¼Œè¿”å›ä¸€è¡Œé•¿é•¿çš„å­—ç¬¦ä¸²ï¼š

``` text
[{"first":"Dale","last":"Murphy","age":44,"nets":["ig","fb","tw"]},{"first":"Roger","last":"Craig","age":68,"nets":["fb","tw"]},{"first":"Jane","last":"Murphy","age":47,"nets":["ig","tw"]}]
```

`friends|@pretty`æ ¼å¼åŒ–`friends`æ•°ç»„ï¼Œä½¿ä¹‹æ›´æ˜“è¯»ï¼š

``` json
[
  {
    "first": "Dale",
    "last": "Murphy",
    "age": 44,
    "nets": ["ig", "fb", "tw"]
  }, 
  {
    "first": "Roger",
    "last": "Craig",
    "age": 68,
    "nets": ["fb", "tw"]
  }, 
  {
    "first": "Jane",
    "last": "Murphy",
    "age": 47,
    "nets": ["ig", "tw"]
  }
]
```

`@this`è¿”å›åŸå§‹çš„`JSON`ä¸²ã€‚

`@flatten`å°†æ•°ç»„`nested`çš„å†…å±‚æ•°ç»„å¹³å¦åˆ°å¤–å±‚åè¿”å›ï¼Œå³å°†æ‰€æœ‰å†…å±‚æ•°ç»„çš„å…ƒç´ ä¾æ¬¡æ·»åŠ åˆ°å¤–å±‚æ•°ç»„åé¢å¹¶ç§»é™¤å†…å±‚æ•°ç»„ï¼Œè¾“å‡ºï¼š

``` text
["one","two","three", "four"]
```

`@join`å°†ä¸€ä¸ªæ•°ç»„ä¸­çš„å„ä¸ªå¯¹è±¡åˆå¹¶åˆ°ä¸€ä¸ªä¸­ï¼Œä¾‹å­ä¸­å°†æ•°ç»„ä¸­å­˜æ”¾çš„éƒ¨åˆ†ä¸ªäººä¿¡æ¯åˆå¹¶æˆä¸€ä¸ªå¯¹è±¡è¿”å›ï¼š

``` text
{"name":"dj","age":18,"phone":"123456789","email":"dj@example.com"}
```

## ä¿®é¥°ç¬¦å‚æ•°

ä¿®é¥°ç¬¦è¿˜å¯ä»¥æœ‰å‚æ•°ï¼Œé€šè¿‡åœ¨ä¿®é¥°ç¬¦ååŠ :åè·Ÿå‚æ•°ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ ¼å¼åŒ–`JSON`ä¸²æ—¶ï¼Œæƒ³è¦å¯¹é”®è¿›è¡Œæ’åºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨`@pretty`ä¿®é¥°ç¬¦çš„`sortKeys`å‚æ•°ã€‚æˆ‘ä»¬è¿˜æ˜¯æ‹¿ä¸Šé¢çš„`JSON`æ•°æ®ä¸¾ä¾‹ï¼š

``` go
fmt.Println(gjson.Get(json, `friends|@pretty:{"sortKeys":true}`))
```

æœ€ç»ˆæŒ‰é”®åé¡ºåºè¾“å‡º`JSON`ä¸²ï¼š

``` json
[
  {
    "age": 44,
    "first": "Dale",
    "last": "Murphy",
    "nets": ["ig", "fb", "tw"]
  }, 
  {
    "age": 68,
    "first": "Roger",
    "last": "Craig",
    "nets": ["fb", "tw"]
  }, 
  {
    "age": 47,
    "first": "Jane",
    "last": "Murphy",
    "nets": ["ig", "tw"]
  }
]
```

å½“ç„¶è¿˜å¯ä»¥æŒ‡å®šæ¯è¡Œç¼©è¿›`indent`ï¼ˆé»˜è®¤ä¸¤ä¸ªç©ºæ ¼ï¼‰ï¼Œæ¯è¡Œå¼€å¤´å­—ç¬¦ä¸²`prefix`ï¼ˆé»˜è®¤ä¸ºç©ºä¸²ï¼‰å’Œä¸€è¡Œæœ€å¤šæ˜¾ç¤ºå­—ç¬¦æ•°`width`ï¼ˆé»˜è®¤`80`å­—ç¬¦ï¼‰ã€‚ä¸‹é¢åœ¨æ¯è¡Œå‰å¢åŠ ä¸¤ä¸ªç©ºæ ¼ï¼š

``` go
fmt.Println(gjson.Get(json, `friends|@pretty:{"sortKeys":true,"prefix":"  "}`))
```

## è‡ªå®šä¹‰ä¿®é¥°ç¬¦

å¦‚æ­¤å¼ºå¤§çš„åŠŸå½“ç„¶è¦æ”¯æŒè‡ªå®šä¹‰ï¼`gjson`ä½¿ç”¨`AddModifier()`æ·»åŠ ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œä¼ å…¥ä¸€ä¸ªåå­—å’Œç±»å‹ä¸º`func(json arg string) string`çš„å¤„ç†å‡½æ•°ã€‚å¤„ç†å‡½æ•°æ¥å—å¾…å¤„ç†çš„`JSON`å€¼å’Œä¿®é¥°ç¬¦å‚æ•°ï¼Œè¿”å›å¤„ç†åçš„ç»“æœã€‚ä¸‹é¢ç¼–å†™ä¸€ä¸ªè½¬æ¢å¤§å°å†™çš„ä¿®é¥°ç¬¦ï¼š

``` go
func main() {
  gjson.AddModifier("case", func(json, arg string) string {
    if arg == "upper" {
      return strings.ToUpper(json)
    }

    if arg == "lower" {
      return strings.ToLower(json)
    }

    return json
  })

  const json = `{"children": ["Sara", "Alex", "Jack"]}`
  fmt.Println(gjson.Get(json, "children|@case:upper"))
  fmt.Println(gjson.Get(json, "children|@case:lower"))
}
```

è¾“å‡ºï¼š

``` text
["SARA", "ALEX", "JACK"]
["sara", "alex", "jack"]
```

## `JSON`è¡Œ

`gjson`æä¾›`..`è¯­æ³•å¯ä»¥å°†å¤šè¡Œæ•°æ®çœ‹æˆä¸€ä¸ªæ•°ç»„ï¼Œæ¯è¡Œæ•°æ®æ˜¯ä¸€ä¸ªå…ƒç´ ï¼š

``` go
const json = `
{"name": "Gilbert", "age": 61}
{"name": "Alexa", "age": 34}
{"name": "May", "age": 57}
{"name": "Deloise", "age": 44}`

func main() {
  fmt.Println(gjson.Get(json, "..#"))
  fmt.Println(gjson.Get(json, "..1"))
  fmt.Println(gjson.Get(json, "..#.name"))
  fmt.Println(gjson.Get(json, `..#(name="May").age`))
}
```

- `..#`ï¼šè¿”å›æœ‰å¤šå°‘è¡Œ`JSON`æ•°æ®ï¼›
- `..1`ï¼šè¿”å›ç¬¬ä¸€è¡Œï¼Œå³`{"name": "Gilbert", "age": 61}`ï¼›
- `..#.name`ï¼š`#`åå†æ¥è·¯å¾„ï¼Œè¡¨ç¤ºå¯¹æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ è¯»å–åé¢çš„è·¯å¾„ï¼Œå°†è¯»å–åˆ°çš„å€¼ç»„æˆä¸€ä¸ªæ–°æ•°ç»„è¿”å›ï¼›`..#.name`è¡¨ç¤ºè¯»å–æ¯ä¸€è¡Œä¸­çš„`name`å­—æ®µï¼Œæœ€ç»ˆè¿”å›`["Gilbert","Alexa","May","Deloise"]`ï¼›
- `..#(name="May").age`ï¼šæ‹¬å·ä¸­çš„å†…å®¹`(name="May")`è¡¨ç¤ºæ¡ä»¶ï¼Œæ‰€ä»¥è¯¥æ¡å«ä¹‰ä¸ºå–`name`ä¸º`"May"`çš„è¡Œä¸­çš„`age`å­—æ®µã€‚

`gjson`è¿˜æä¾›äº†éå†`JSON`è¡Œçš„æ–¹æ³•ï¼š`gjson.ForEachLine()`ï¼Œå‚æ•°ä¸º`JSON`ä¸²å’Œç±»å‹ä¸º`func(line gjson.Result) bool`çš„å›è°ƒå‡½æ•°ã€‚å›è°ƒè¿”å›`false`æ—¶éå†åœæ­¢ã€‚ä¸‹é¢ä»£ç è¯»å–è¾“å‡ºæ¯ä¸€è¡Œçš„`name`å­—æ®µï¼š

``` go
gjson.ForEachLine(json, func(line gjson.Result) bool {
  fmt.Println("name:", gjson.Get(line.String(), "name"))
  return true
})
```

## éå†

ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†éå†`JSON`è¡Œçš„æ–¹å¼ï¼Œå®é™…ä¸Š`gjson`è¿˜æä¾›äº†é€šç”¨çš„éå†æ•°ç»„å’Œå¯¹è±¡çš„æ–¹å¼ã€‚`gjson.Get()`æ–¹æ³•è¿”å›ä¸€ä¸ª`gjson.Result`ç±»å‹çš„å¯¹è±¡ï¼Œ`json.Result`æä¾›äº†`ForEach()`æ–¹æ³•ç”¨äºéå†ã€‚è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªç±»å‹ä¸º`func (key, value gjson.Result) bool`çš„å›è°ƒå‡½æ•°ã€‚éå†å¯¹è±¡æ—¶`key`å’Œ`value`åˆ†åˆ«ä¸ºå¯¹è±¡çš„é”®å’Œå€¼ï¼›éå†æ•°ç»„æ—¶ï¼Œ`value`ä¸ºæ•°ç»„å…ƒç´ ï¼Œ`key`ä¸ºç©ºï¼ˆä¸æ˜¯ç´¢å¼•ï¼‰ã€‚å›è°ƒè¿”å›`false`æ—¶ï¼Œéå†åœæ­¢ã€‚

``` go
const json = `
{
  "name":"dj",
  "age":18,
  "pets": ["cat", "dog"],
  "contact": {
    "phone": "123456789",
    "email": "dj@example.com"
  }
}`

func main() {
  pets := gjson.Get(json, "pets")
  pets.ForEach(func(_, pet gjson.Result) bool {
    fmt.Println(pet)
    return true
  })

  contact := gjson.Get(json, "contact")
  contact.ForEach(func(key, value gjson.Result) bool {
    // keyè¡¨ç¤ºè¿è¡Œä¸‹æ ‡(0ä¸ºèµ·ç‚¹)ï¼Œvalueè¡¨ç¤ºå€¼
    fmt.Println(key, value)
    return true
  })
}
```

## æ ¡éªŒ`JSON`

è°ƒç”¨`gjson.Get()`æ—¶ï¼Œ`gjson`å‡è®¾æˆ‘ä»¬ä¼ å…¥çš„`JSON`ä¸²æ˜¯åˆæ³•çš„ã€‚å¦‚æœ`JSON`éæ³•ä¹Ÿä¸ä¼š`panic`ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸ç¡®å®šçš„ç»“æœï¼š

``` go
func main() {
  const json = `{"name":dj,age:18}`
  fmt.Println(gjson.Get(json, "name"))
}
```

ä¸Šé¢`JSON`ä¸²æ˜¯éæ³•çš„ï¼Œ`dj`å’Œ`age`éƒ½æ²¡æœ‰åŠ ä¸ŠåŒå¼•å·ï¼ˆå®é™…ä¸Šä¹ æƒ¯äº†`Go`è¯­è¨€`map`çš„å†™æ³•ï¼Œå¾ˆå®¹æ˜“æŠŠ`JSON`å†™æˆè¿™æ ·ğŸ˜­ï¼‰ã€‚ä¸Šé¢ä»£ç è¾“å‡º`18`ï¼Œæ˜¾ç„¶æ˜¯é”™è¯¯çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`gjson.Valid()`æ£€æµ‹`JSON`ä¸²æ˜¯å¦åˆæ³•ï¼š

``` go
if !gjson.Valid(json) {
  fmt.Println("error")
} else {
  fmt.Println("ok")
}
```

## ä¸€æ¬¡è·å–å¤šä¸ªå€¼

è°ƒç”¨`gjson.Get()`ä¸€æ¬¡åªèƒ½è¯»å–ä¸€ä¸ªå€¼ï¼Œå¤šæ¬¡è°ƒç”¨åˆæ¯”è¾ƒéº»çƒ¦ï¼Œ`gjson`æä¾›äº†`GetMany()`å¯ä»¥ä¸€æ¬¡è¯»å–å¤šä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„`[]gjson.Result`ã€‚

``` go
const json = `
{
  "name":"dj",
  "age":18,
  "pets": ["cat", "dog"],
  "contact": {
    "phone": "123456789",
    "email": "dj@example.com"
  }
}`

func main() {
  results := gjson.GetMany(json, "name", "age", "pets.#", "contact.phone")
  for _, result := range results {
    fmt.Println(result)
  }
}
```

ä¸Šé¢ä»£ç è¿”å›å­—æ®µ`name`ã€`age`ã€æ•°ç»„`pets`çš„é•¿åº¦å’Œ`contact.phone`å­—æ®µã€‚


## å®æˆ˜æ¡ˆä¾‹

### æ ¹èŠ‚ç‚¹æ£€ç´¢

``` go

const cityInfo = `
{
  "code": 0,
  "meta": "success",
  "data": {
    "äº‘å—":{
      "å¾·å®å‚£æ—æ™¯é¢‡æ—è‡ªæ²»å·":"1",
      "æ˜†æ˜":"2",
    },
    "åŒ—äº¬": {
      "åŒ—äº¬": "3"
    },
    "å‰æ—": {
      "è¾½æº": "4",
      "é•¿æ˜¥": "5",
    }
  }
}
`
var cityNameBlur = strings.Builder{}
cityNameBlur.WriteString("*.")
cityNameBlur.WriteString("è¾½æº")
cityNameBlur.WriteString("*")

cityCode := gjson.Get(cityInfo, cityNameBlur.String()).String()

fmt.Println(cityCode)
```