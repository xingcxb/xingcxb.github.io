<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust学习 | 不器小窝</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/xingcxb/blog_img@blog1/blog/basic/favicon.ico">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4cd746698b2a13cb0c902d7ba1b5b57f";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-Q9XQS90GYB"></script>
    <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Q9XQS90GYB');
</script>
    <script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1725717718088510" crossorigin="anonymous"></script>
    <meta name="description" content="无善无恶心之体，有善有恶意之动，知善知恶是良知，为善去恶是格物。">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="不器小窝,不器blog,不器博客,flutter开发,随笔,读书笔记,Go,Golang开发,VuePress搭建,记录生活和技术路程">
    <meta name="google-site-verification" content="JfM7Cg2a2jlGXV2PfkH7sIRWZmcTa1aDCOHMaQH2UuE">
    <meta name="baidu-site-verification" content="code-OBocxvg8ja">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.49c7c270.css" as="style"><link rel="preload" href="/assets/js/app.d4066f40.js" as="script"><link rel="preload" href="/assets/js/4.0068dbe1.js" as="script"><link rel="preload" href="/assets/js/1.e2a47839.js" as="script"><link rel="preload" href="/assets/js/3.89d55b81.js" as="script"><link rel="preload" href="/assets/js/158.ef32049c.js" as="script"><link rel="preload" href="/assets/js/21.94b14704.js" as="script"><link rel="preload" href="/assets/js/25.5e11b002.js" as="script"><link rel="preload" href="/assets/js/44.b298a7d5.js" as="script"><link rel="prefetch" href="/assets/js/10.64e8df65.js"><link rel="prefetch" href="/assets/js/100.ea0b0097.js"><link rel="prefetch" href="/assets/js/101.16979926.js"><link rel="prefetch" href="/assets/js/102.aafe20c2.js"><link rel="prefetch" href="/assets/js/103.d873bd29.js"><link rel="prefetch" href="/assets/js/104.ee5d6337.js"><link rel="prefetch" href="/assets/js/105.293e36d4.js"><link rel="prefetch" href="/assets/js/106.44a20ba4.js"><link rel="prefetch" href="/assets/js/107.92791b24.js"><link rel="prefetch" href="/assets/js/108.ef9af155.js"><link rel="prefetch" href="/assets/js/109.4620b7e1.js"><link rel="prefetch" href="/assets/js/11.81b0cd2e.js"><link rel="prefetch" href="/assets/js/110.033c6e7a.js"><link rel="prefetch" href="/assets/js/111.2aefff7e.js"><link rel="prefetch" href="/assets/js/112.dec9e2c4.js"><link rel="prefetch" href="/assets/js/113.1df4f266.js"><link rel="prefetch" href="/assets/js/114.10a97d97.js"><link rel="prefetch" href="/assets/js/115.d0edf2bc.js"><link rel="prefetch" href="/assets/js/116.17f99ff4.js"><link rel="prefetch" href="/assets/js/117.bc741115.js"><link rel="prefetch" href="/assets/js/118.91b00272.js"><link rel="prefetch" href="/assets/js/119.bb7275c1.js"><link rel="prefetch" href="/assets/js/12.f23be87f.js"><link rel="prefetch" href="/assets/js/120.057b203e.js"><link rel="prefetch" href="/assets/js/121.5282f17f.js"><link rel="prefetch" href="/assets/js/122.cd3b818c.js"><link rel="prefetch" href="/assets/js/123.351bebe1.js"><link rel="prefetch" href="/assets/js/124.9eeeff8d.js"><link rel="prefetch" href="/assets/js/125.e28670b1.js"><link rel="prefetch" href="/assets/js/126.fff0dcba.js"><link rel="prefetch" href="/assets/js/127.1f0e255c.js"><link rel="prefetch" href="/assets/js/128.7b7fb247.js"><link rel="prefetch" href="/assets/js/129.aea0e3b9.js"><link rel="prefetch" href="/assets/js/13.edee6947.js"><link rel="prefetch" href="/assets/js/130.2b24f9c6.js"><link rel="prefetch" href="/assets/js/131.7d3c5a55.js"><link rel="prefetch" href="/assets/js/132.c7348ad0.js"><link rel="prefetch" href="/assets/js/133.c4f1d532.js"><link rel="prefetch" href="/assets/js/134.9076b574.js"><link rel="prefetch" href="/assets/js/135.1c62651b.js"><link rel="prefetch" href="/assets/js/136.543782f9.js"><link rel="prefetch" href="/assets/js/137.d1e203be.js"><link rel="prefetch" href="/assets/js/138.626e238d.js"><link rel="prefetch" href="/assets/js/139.b0b97c20.js"><link rel="prefetch" href="/assets/js/14.c7e6c1c6.js"><link rel="prefetch" href="/assets/js/140.1c0fdb16.js"><link rel="prefetch" href="/assets/js/141.9c4db35e.js"><link rel="prefetch" href="/assets/js/142.760a11c9.js"><link rel="prefetch" href="/assets/js/143.fe9964d0.js"><link rel="prefetch" href="/assets/js/144.c2c2812b.js"><link rel="prefetch" href="/assets/js/145.1fb15567.js"><link rel="prefetch" href="/assets/js/146.811a7d6b.js"><link rel="prefetch" href="/assets/js/147.0cf0f8be.js"><link rel="prefetch" href="/assets/js/148.89649a5f.js"><link rel="prefetch" href="/assets/js/149.9c2c45aa.js"><link rel="prefetch" href="/assets/js/15.0f836ddf.js"><link rel="prefetch" href="/assets/js/150.a76f728a.js"><link rel="prefetch" href="/assets/js/151.7df678d1.js"><link rel="prefetch" href="/assets/js/152.a47f85f9.js"><link rel="prefetch" href="/assets/js/153.3c430750.js"><link rel="prefetch" href="/assets/js/154.f887aad9.js"><link rel="prefetch" href="/assets/js/155.336b4b15.js"><link rel="prefetch" href="/assets/js/156.e970f8f4.js"><link rel="prefetch" href="/assets/js/157.334c1f83.js"><link rel="prefetch" href="/assets/js/159.121f4e7d.js"><link rel="prefetch" href="/assets/js/16.da75c726.js"><link rel="prefetch" href="/assets/js/160.44a0af37.js"><link rel="prefetch" href="/assets/js/161.043aa76c.js"><link rel="prefetch" href="/assets/js/162.c2e7c87b.js"><link rel="prefetch" href="/assets/js/163.389424c1.js"><link rel="prefetch" href="/assets/js/164.e6e385b2.js"><link rel="prefetch" href="/assets/js/165.31593a3d.js"><link rel="prefetch" href="/assets/js/166.34e5fb59.js"><link rel="prefetch" href="/assets/js/167.86a715aa.js"><link rel="prefetch" href="/assets/js/168.0739a4ec.js"><link rel="prefetch" href="/assets/js/169.8c719ad0.js"><link rel="prefetch" href="/assets/js/17.d179b0e4.js"><link rel="prefetch" href="/assets/js/170.445eee7a.js"><link rel="prefetch" href="/assets/js/171.abcd6416.js"><link rel="prefetch" href="/assets/js/172.42956699.js"><link rel="prefetch" href="/assets/js/173.d7c9c473.js"><link rel="prefetch" href="/assets/js/174.c232b141.js"><link rel="prefetch" href="/assets/js/175.56c547c1.js"><link rel="prefetch" href="/assets/js/176.349797cf.js"><link rel="prefetch" href="/assets/js/177.57897156.js"><link rel="prefetch" href="/assets/js/178.bf4ec9cc.js"><link rel="prefetch" href="/assets/js/179.6081498f.js"><link rel="prefetch" href="/assets/js/18.9e7bb04d.js"><link rel="prefetch" href="/assets/js/180.e06be1a1.js"><link rel="prefetch" href="/assets/js/181.23bb6815.js"><link rel="prefetch" href="/assets/js/182.5e2ded10.js"><link rel="prefetch" href="/assets/js/183.8784d703.js"><link rel="prefetch" href="/assets/js/184.dcd51ef3.js"><link rel="prefetch" href="/assets/js/185.5ede31bc.js"><link rel="prefetch" href="/assets/js/186.46037ad6.js"><link rel="prefetch" href="/assets/js/187.b52a91bd.js"><link rel="prefetch" href="/assets/js/188.828e0b64.js"><link rel="prefetch" href="/assets/js/189.3f0a605a.js"><link rel="prefetch" href="/assets/js/19.c06cdcd5.js"><link rel="prefetch" href="/assets/js/190.2f133832.js"><link rel="prefetch" href="/assets/js/191.0ba12a2b.js"><link rel="prefetch" href="/assets/js/192.513bcddd.js"><link rel="prefetch" href="/assets/js/193.d0bf7783.js"><link rel="prefetch" href="/assets/js/194.ecf00688.js"><link rel="prefetch" href="/assets/js/195.f7021f93.js"><link rel="prefetch" href="/assets/js/196.1ccb29fa.js"><link rel="prefetch" href="/assets/js/197.5ca25608.js"><link rel="prefetch" href="/assets/js/198.10d3a2b1.js"><link rel="prefetch" href="/assets/js/199.19cc387d.js"><link rel="prefetch" href="/assets/js/2.8c1413de.js"><link rel="prefetch" href="/assets/js/20.467674a7.js"><link rel="prefetch" href="/assets/js/200.e91376b9.js"><link rel="prefetch" href="/assets/js/201.29bda6e4.js"><link rel="prefetch" href="/assets/js/202.f04f3105.js"><link rel="prefetch" href="/assets/js/203.6340f4e6.js"><link rel="prefetch" href="/assets/js/204.297ec709.js"><link rel="prefetch" href="/assets/js/205.5af3926c.js"><link rel="prefetch" href="/assets/js/206.dd1f3963.js"><link rel="prefetch" href="/assets/js/207.4f186dd6.js"><link rel="prefetch" href="/assets/js/208.e138104f.js"><link rel="prefetch" href="/assets/js/209.13a4990b.js"><link rel="prefetch" href="/assets/js/210.72268822.js"><link rel="prefetch" href="/assets/js/211.2d5f6203.js"><link rel="prefetch" href="/assets/js/212.5e6fce91.js"><link rel="prefetch" href="/assets/js/213.20058560.js"><link rel="prefetch" href="/assets/js/214.5c4318b6.js"><link rel="prefetch" href="/assets/js/215.6758d9d2.js"><link rel="prefetch" href="/assets/js/216.4be99124.js"><link rel="prefetch" href="/assets/js/217.56c7dbba.js"><link rel="prefetch" href="/assets/js/218.240e6652.js"><link rel="prefetch" href="/assets/js/219.c4b81976.js"><link rel="prefetch" href="/assets/js/22.bb359cf3.js"><link rel="prefetch" href="/assets/js/220.8a233107.js"><link rel="prefetch" href="/assets/js/221.ba3dfa0d.js"><link rel="prefetch" href="/assets/js/222.98d775b9.js"><link rel="prefetch" href="/assets/js/223.4ff9bba9.js"><link rel="prefetch" href="/assets/js/224.a666891b.js"><link rel="prefetch" href="/assets/js/225.5b2d6ffb.js"><link rel="prefetch" href="/assets/js/226.48f58c47.js"><link rel="prefetch" href="/assets/js/227.9f4fd91c.js"><link rel="prefetch" href="/assets/js/228.eec8e0e3.js"><link rel="prefetch" href="/assets/js/229.e855601b.js"><link rel="prefetch" href="/assets/js/23.c002fd5f.js"><link rel="prefetch" href="/assets/js/230.c2d38b6d.js"><link rel="prefetch" href="/assets/js/231.3b0e2f2e.js"><link rel="prefetch" href="/assets/js/232.24a6699b.js"><link rel="prefetch" href="/assets/js/233.e0a88afb.js"><link rel="prefetch" href="/assets/js/234.84b07f45.js"><link rel="prefetch" href="/assets/js/235.e6b4784f.js"><link rel="prefetch" href="/assets/js/236.ccf9ac76.js"><link rel="prefetch" href="/assets/js/237.011f42e3.js"><link rel="prefetch" href="/assets/js/238.3982d18a.js"><link rel="prefetch" href="/assets/js/239.764bf52c.js"><link rel="prefetch" href="/assets/js/24.e75ef31f.js"><link rel="prefetch" href="/assets/js/240.3e072393.js"><link rel="prefetch" href="/assets/js/241.8237146a.js"><link rel="prefetch" href="/assets/js/242.effcff84.js"><link rel="prefetch" href="/assets/js/243.37a532e8.js"><link rel="prefetch" href="/assets/js/244.8a082b18.js"><link rel="prefetch" href="/assets/js/245.fdf62560.js"><link rel="prefetch" href="/assets/js/246.c83d3cca.js"><link rel="prefetch" href="/assets/js/247.ba8b6e47.js"><link rel="prefetch" href="/assets/js/248.e80f7379.js"><link rel="prefetch" href="/assets/js/249.8569b04c.js"><link rel="prefetch" href="/assets/js/250.75285f7b.js"><link rel="prefetch" href="/assets/js/251.4bb0afb4.js"><link rel="prefetch" href="/assets/js/252.f2470004.js"><link rel="prefetch" href="/assets/js/253.8c949d0e.js"><link rel="prefetch" href="/assets/js/254.6c7b4d62.js"><link rel="prefetch" href="/assets/js/255.2bd7864b.js"><link rel="prefetch" href="/assets/js/256.df61f632.js"><link rel="prefetch" href="/assets/js/257.5789d1b8.js"><link rel="prefetch" href="/assets/js/258.96553b93.js"><link rel="prefetch" href="/assets/js/259.c6405126.js"><link rel="prefetch" href="/assets/js/26.ea66823b.js"><link rel="prefetch" href="/assets/js/260.ddcedbf1.js"><link rel="prefetch" href="/assets/js/27.1bd4aa0c.js"><link rel="prefetch" href="/assets/js/28.c310cc93.js"><link rel="prefetch" href="/assets/js/29.8a119c54.js"><link rel="prefetch" href="/assets/js/30.1388045a.js"><link rel="prefetch" href="/assets/js/31.b54738e7.js"><link rel="prefetch" href="/assets/js/32.e9524461.js"><link rel="prefetch" href="/assets/js/33.89f43e88.js"><link rel="prefetch" href="/assets/js/34.29e9ad88.js"><link rel="prefetch" href="/assets/js/35.0f071c53.js"><link rel="prefetch" href="/assets/js/36.c60cbc15.js"><link rel="prefetch" href="/assets/js/37.b1f2b797.js"><link rel="prefetch" href="/assets/js/38.5396c15a.js"><link rel="prefetch" href="/assets/js/39.1bddf80d.js"><link rel="prefetch" href="/assets/js/40.1503c07a.js"><link rel="prefetch" href="/assets/js/41.df1eb749.js"><link rel="prefetch" href="/assets/js/42.764237b6.js"><link rel="prefetch" href="/assets/js/43.10ffe66d.js"><link rel="prefetch" href="/assets/js/45.773ba7c9.js"><link rel="prefetch" href="/assets/js/46.70de2081.js"><link rel="prefetch" href="/assets/js/47.4af06cf2.js"><link rel="prefetch" href="/assets/js/48.092bcd19.js"><link rel="prefetch" href="/assets/js/49.dd2ad8db.js"><link rel="prefetch" href="/assets/js/5.279447a5.js"><link rel="prefetch" href="/assets/js/50.e9eec9f3.js"><link rel="prefetch" href="/assets/js/51.eb4522f2.js"><link rel="prefetch" href="/assets/js/52.2f33bbbb.js"><link rel="prefetch" href="/assets/js/53.24365d05.js"><link rel="prefetch" href="/assets/js/54.62e19f17.js"><link rel="prefetch" href="/assets/js/55.fd657183.js"><link rel="prefetch" href="/assets/js/56.0d0f0315.js"><link rel="prefetch" href="/assets/js/57.bd870837.js"><link rel="prefetch" href="/assets/js/58.6bbb8943.js"><link rel="prefetch" href="/assets/js/59.29a28987.js"><link rel="prefetch" href="/assets/js/6.4bee4f17.js"><link rel="prefetch" href="/assets/js/60.800edd42.js"><link rel="prefetch" href="/assets/js/61.5d3ec4de.js"><link rel="prefetch" href="/assets/js/62.b0c8b31c.js"><link rel="prefetch" href="/assets/js/63.01752225.js"><link rel="prefetch" href="/assets/js/64.9f9e9257.js"><link rel="prefetch" href="/assets/js/65.3b8ba3bc.js"><link rel="prefetch" href="/assets/js/66.3db0da14.js"><link rel="prefetch" href="/assets/js/67.7030149a.js"><link rel="prefetch" href="/assets/js/68.e05448b1.js"><link rel="prefetch" href="/assets/js/69.96521549.js"><link rel="prefetch" href="/assets/js/7.de3d7a7c.js"><link rel="prefetch" href="/assets/js/70.3e4d5454.js"><link rel="prefetch" href="/assets/js/71.29b1ed1b.js"><link rel="prefetch" href="/assets/js/72.5974e50a.js"><link rel="prefetch" href="/assets/js/73.59165be5.js"><link rel="prefetch" href="/assets/js/74.c731f3ad.js"><link rel="prefetch" href="/assets/js/75.99463ee9.js"><link rel="prefetch" href="/assets/js/76.a155d4a5.js"><link rel="prefetch" href="/assets/js/77.01565db3.js"><link rel="prefetch" href="/assets/js/78.d2dc0455.js"><link rel="prefetch" href="/assets/js/79.bfed64cb.js"><link rel="prefetch" href="/assets/js/80.7d284eeb.js"><link rel="prefetch" href="/assets/js/81.d9e9c3f8.js"><link rel="prefetch" href="/assets/js/82.cb4027b3.js"><link rel="prefetch" href="/assets/js/83.b63973b0.js"><link rel="prefetch" href="/assets/js/84.679417b8.js"><link rel="prefetch" href="/assets/js/85.499f10a5.js"><link rel="prefetch" href="/assets/js/86.a93015ad.js"><link rel="prefetch" href="/assets/js/87.ea8c5f60.js"><link rel="prefetch" href="/assets/js/88.0f130816.js"><link rel="prefetch" href="/assets/js/89.f2401ae3.js"><link rel="prefetch" href="/assets/js/90.a7e12a79.js"><link rel="prefetch" href="/assets/js/91.22bf9a8a.js"><link rel="prefetch" href="/assets/js/92.d538f6c0.js"><link rel="prefetch" href="/assets/js/93.81fbf33f.js"><link rel="prefetch" href="/assets/js/94.fb20d289.js"><link rel="prefetch" href="/assets/js/95.e8876d26.js"><link rel="prefetch" href="/assets/js/96.e2b09c42.js"><link rel="prefetch" href="/assets/js/97.304ab4f0.js"><link rel="prefetch" href="/assets/js/98.32bd1db7.js"><link rel="prefetch" href="/assets/js/99.99483df7.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.435e13d4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.49c7c270.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/xingcxb/blog_img@blog1/blog/basic/logo.png" alt="不器小窝" class="logo"> <span class="site-name can-hide">不器小窝</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/speak/" class="nav-link">随笔</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><a href="/language/" class="link-title router-link-active">语言</a> <span class="title" style="display:none;">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">GoLang</a></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/vuepress/" class="nav-link">VuePress</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tools/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link">开发工具</a></li><li class="dropdown-item"><!----> <a href="/sys/" class="nav-link">系统工具</a></li></ul></div></div><div class="nav-item"><a href="/read/" class="nav-link">读吧</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><a href="/projects/" class="link-title">项目</a> <span class="title" style="display:none;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/xingcxb/todb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ToDb
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/xingcxb/goKit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  goKit
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/friend/8e1a3d/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="/more/ghost/" class="nav-link">👻故事</a></li><li class="dropdown-item"><!----> <a href="/more/free/" class="nav-link">免费信息</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">时间线</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com/xingcxb" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/xingcxb/blog_img@blog1/blog/basic/Avatar.png"> <div class="blogger-info"><h3>不器</h3> <span>知行合一</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/speak/" class="nav-link">随笔</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><a href="/language/" class="link-title router-link-active">语言</a> <span class="title" style="display:none;">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">GoLang</a></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/vuepress/" class="nav-link">VuePress</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tools/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/" class="nav-link">开发工具</a></li><li class="dropdown-item"><!----> <a href="/sys/" class="nav-link">系统工具</a></li></ul></div></div><div class="nav-item"><a href="/read/" class="nav-link">读吧</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><a href="/projects/" class="link-title">项目</a> <span class="title" style="display:none;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/xingcxb/todb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ToDb
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/xingcxb/goKit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  goKit
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/more/friend/8e1a3d/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="/more/ghost/" class="nav-link">👻故事</a></li><li class="dropdown-item"><!----> <a href="/more/free/" class="nav-link">免费信息</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">时间线</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com/xingcxb" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GoLang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Dart</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Markdown</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>other</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Rust</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/language/rust/22f3a6/" class="sidebar-link">Rust安装</a></li><li><a href="/language/rust/3600d7/" aria-current="page" class="active sidebar-link">Rust学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#浮点陷阱" class="sidebar-link">浮点陷阱</a></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#range-序列" class="sidebar-link">Range (序列)</a></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#as-类型转换" class="sidebar-link">As 类型转换</a></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#如何引用第三方库" class="sidebar-link">如何引用第三方库</a></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#字符、布尔、单元类型" class="sidebar-link">字符、布尔、单元类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#字符" class="sidebar-link">字符</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#布尔" class="sidebar-link">布尔</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#单元类型" class="sidebar-link">单元类型</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#语句和表达式" class="sidebar-link">语句和表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#语句和表达式的区别" class="sidebar-link">语句和表达式的区别</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#函数" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#函数要点" class="sidebar-link">函数要点</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#匿名函数" class="sidebar-link">匿名函数</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#如何理解" class="sidebar-link">如何理解</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#所有权和借用" class="sidebar-link">所有权和借用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#所有权" class="sidebar-link">所有权</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#所有权原则" class="sidebar-link">所有权原则</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#栈-stack-与堆-heap" class="sidebar-link">栈(Stack)与堆(Heap)</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#变量绑定背后的数据交互" class="sidebar-link">变量绑定背后的数据交互</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#实战解说" class="sidebar-link">实战解说</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#引用与借用" class="sidebar-link">引用与借用</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#引用与解引用" class="sidebar-link">引用与解引用</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#不可变引用" class="sidebar-link">不可变引用</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#可变引用" class="sidebar-link">可变引用</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#可变引用与不可变引用不能同时存在" class="sidebar-link">可变引用与不可变引用不能同时存在</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#垂直引用-dangling-references" class="sidebar-link">垂直引用(Dangling References)</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#借用规则总结" class="sidebar-link">借用规则总结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#复合类型" class="sidebar-link">复合类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#切片" class="sidebar-link">切片</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#字符串字面量是切片" class="sidebar-link">字符串字面量是切片</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#字符串索引" class="sidebar-link">字符串索引</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#操作字符串" class="sidebar-link">操作字符串</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#元组" class="sidebar-link">元组</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#如何取元祖中的值" class="sidebar-link">如何取元祖中的值</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#使用场景" class="sidebar-link">使用场景</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#注意" class="sidebar-link">注意</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#结构体" class="sidebar-link">结构体</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#枚举" class="sidebar-link">枚举</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#固定长度的数组" class="sidebar-link">固定长度的数组</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#动态增长的数组" class="sidebar-link">动态增长的数组</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#访问数组" class="sidebar-link">访问数组</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#越界访问" class="sidebar-link">越界访问</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#循环" class="sidebar-link">循环</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#分支控制" class="sidebar-link">分支控制</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#循环-2" class="sidebar-link">循环</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#for-循环" class="sidebar-link">for 循环</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#模式匹配" class="sidebar-link">模式匹配</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#match-和-if-let" class="sidebar-link">match 和 if let</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#match" class="sidebar-link">match</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#if-let" class="sidebar-link">if let</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#matches-宏" class="sidebar-link">matches! 宏</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#变量遮蔽" class="sidebar-link">变量遮蔽</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#解构-option" class="sidebar-link">解构 Option</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#模式适用场景" class="sidebar-link">模式适用场景</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#模式" class="sidebar-link">模式</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#方法-method" class="sidebar-link">方法 Method</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#self、-self-和-mut-self" class="sidebar-link">self、&amp;self 和 &amp;mut self</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#self-和-self-有什么区别" class="sidebar-link">self 和 Self 有什么区别</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#self" class="sidebar-link">self</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#self-2" class="sidebar-link">Self</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#范型和特征" class="sidebar-link">范型和特征</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#泛型-generics" class="sidebar-link">泛型 Generics</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#范型详解" class="sidebar-link">范型详解</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#结构体中使用范型" class="sidebar-link">结构体中使用范型</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#枚举中使用范型" class="sidebar-link">枚举中使用范型</a></li><li class="sidebar-sub-header level4"><a href="/language/rust/3600d7/#方法中使用范型" class="sidebar-link">方法中使用范型</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#特征-trait" class="sidebar-link">特征 Trait</a></li><li class="sidebar-sub-header level2"><a href="/language/rust/3600d7/#特征对象" class="sidebar-link">特征对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#特征对象的动态分发" class="sidebar-link">特征对象的动态分发</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#self-和-self" class="sidebar-link">Self 和 self</a></li><li class="sidebar-sub-header level3"><a href="/language/rust/3600d7/#特征对象的限制" class="sidebar-link">特征对象的限制</a></li></ul></li></ul></li><li><a href="/language/rust/ed45d2/" class="sidebar-link">Rust经验</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Tauri</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/language/#语言" data-v-06225672>语言</a></li><li data-v-06225672><a href="/language/#Rust" data-v-06225672>Rust</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://xingcxb.github.io/" target="_blank" title="作者" class="beLink" data-v-06225672>不器</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-02-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Rust学习<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>本文是记录在 <code>Rust</code> 学习笔记，学完结束。</p> <p><a href="https://course.rs" target="_blank" rel="noopener noreferrer">Rust 语言圣经(Rust Course)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><code>240305</code> 进度到了 <code>2.3.1</code>，脑子被绕懵了，课后作业有一说一不错 😂</li> <li><code>240718</code> 进度到了 <code>2.4.3</code>，习题做完</li> <li><code>240718</code> 进度到了 <code>2.4.4</code></li> <li><code>240719</code> 进度到了 <code>2.4.5</code>，习题做完</li> <li><code>240719</code> 进度到了 <code>2.5</code>，习题做完</li> <li><code>240720</code> 进度到了 <code>2.6.1</code>，习题做完</li> <li><code>240724</code> 进度到了 <code>2.6.2</code>，习题做完</li> <li><code>240724</code> 进度到了 <code>2.6.3</code>，习题做完</li> <li><code>240724</code> 进度到了 <code>2.6.4</code>，习题做完</li> <li><code>240725</code> 进度到了 <code>2.7</code>，习题做完</li> <li><code>240726</code> 进度到了 <code>2.8.1</code>，习题做完</li> <li><code>240803</code> 进度到了 <code>2.8.2</code>，习题做完</li></ul> <InArticleAdsense data-ad-client="ca-pub-1725717718088510" data-ad-slot="4281148213"></InArticleAdsense> <h2 id="浮点陷阱"><a href="#浮点陷阱" class="header-anchor">#</a> 浮点陷阱</h2> <ol><li>浮点数往往是你想要数字的近似表达 浮点数类型是基于二进制实现的，但是我们想要计算的数字往往是基于十进制，例如 0.1 在二进制上并不存在精确的表达形式，但是在十进制上就存在。这种不匹配性导致一定的歧义性，更多的，虽然浮点数能代表真实的数值，但是由于底层格式问题，它往往受限于定长的浮点数精度，如果你想要表达完全精准的真实数字，只有使用无限精度的浮点数才行</li> <li>浮点数在某些特性上是反直觉的 例如大家都会觉得浮点数可以进行比较，对吧？是的，它们确实可以使用 &gt;，&gt;= 等进行比较，但是在某些场景下，这种直觉上的比较特性反而会害了你</li></ol> <p>注意：</p> <ul><li>避免在浮点数上测试相等性</li> <li>当结果在数学上可能存在未定义时，需要格外的小心</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> abc<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">f32</span><span class="token punctuation">,</span> <span class="token keyword">f32</span><span class="token punctuation">,</span> <span class="token keyword">f32</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> xyz<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;abc (f32)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;   0.1 + 0.2: {:x}&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>abc<span class="token number">.0</span> <span class="token operator">+</span> abc<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_bits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;         0.3: {:x}&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>abc<span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_bits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;xyz (f64)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;   0.1 + 0.2: {:x}&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>xyz<span class="token number">.0</span> <span class="token operator">+</span> xyz<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_bits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;         0.3: {:x}&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>xyz<span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_bits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">assert!</span><span class="token punctuation">(</span>abc<span class="token number">.0</span> <span class="token operator">+</span> abc<span class="token number">.1</span> <span class="token operator">==</span> abc<span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert!</span><span class="token punctuation">(</span>xyz<span class="token number">.0</span> <span class="token operator">+</span> xyz<span class="token number">.1</span> <span class="token operator">==</span> xyz<span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>输出</p> <div class="language-log line-numbers-mode"><pre class="language-log"><code>abc <span class="token operator">(</span>f32<span class="token operator">)</span>
   <span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token operator">:</span> <span class="token number">3e99999a</span>
         <span class="token number">0.3</span><span class="token operator">:</span> <span class="token number">3e99999a</span>

xyz <span class="token operator">(</span>f64<span class="token operator">)</span>
   <span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token operator">:</span> <span class="token number">3fd3333333333334</span>
         <span class="token number">0.3</span><span class="token operator">:</span> <span class="token number">3fd3333333333333</span>

thread <span class="token string">'main'</span> panicked at <span class="token string">'assertion failed: xyz.0 + xyz.1 == xyz.2'</span><span class="token punctuation">,</span>
➥ch2<span class="token operator">-</span>add<span class="token operator">-</span>floats<span class="token punctuation">.</span>rs<span class="token punctuation">.</span>rs<span class="token operator">:</span><span class="token number">14</span><span class="token operator">:</span><span class="token number">5</span>
<span class="token property">note:</span> run with `RUST_BACKTRACE<span class="token operator">=</span><span class="token number">1</span>` environment variable to display
➥a backtrace
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>这是因为高精度进行加减的时候在小数点非常后的地方发生了微小的变化，导致了 <code>f64</code> 计算的结果和原始声明的结果出现了变化，断言失败</p></blockquote> <h2 id="range-序列"><a href="#range-序列" class="header-anchor">#</a> <code>Range</code> (序列)</h2> <ul><li><p>左闭右开</p> <p><code>1...5</code></p></li> <li><p>左闭右闭</p> <p><code>1...=5</code></p></li></ul> <blockquote><p>序列仅仅允许数字或者**字符（<code>char</code>）**类型，原因是他们可以连续</p></blockquote> <h2 id="as-类型转换"><a href="#as-类型转换" class="header-anchor">#</a> <code>As</code> 类型转换</h2> <p><code>Rust</code> 中可以使用 <code>As</code> 来完成一个类型到另一个类型的转换，其最常用于将原始类型转换为其他原始类型，但是它也可以完成诸如将指针转换为地址、地址转换为指针以及将指针转换为其他指针等功能。</p> <h2 id="如何引用第三方库"><a href="#如何引用第三方库" class="header-anchor">#</a> 如何引用第三方库</h2> <p><a href="https://crates.io/" target="_blank" rel="noopener noreferrer">Rust 库中心 —— crates.io<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>使用 <code>cargo</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># xxx 为库名</span>
<span class="token function">cargo</span> <span class="token function">add</span> xxx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>操作 <code>Cargo.toml</code></p> <p>在 <code>Cargo.toml</code> 中的 <code>[dependencies]</code> 下增加库名并指定版本</p> <div class="language-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token key property">tauri</span> <span class="token punctuation">=</span> <span class="token string">&quot;1.6.0&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h2 id="字符、布尔、单元类型"><a href="#字符、布尔、单元类型" class="header-anchor">#</a> 字符、布尔、单元类型</h2> <h3 id="字符"><a href="#字符" class="header-anchor">#</a> 字符</h3> <p><code>Rust</code> 中的字符类型代表一个 <code>Unicode</code>，<code>Unicode</code> 占用 <code>4</code> 个字节，所以在 <code>Rust</code> 中字符占用 <code>4</code> 个字节</p> <h3 id="布尔"><a href="#布尔" class="header-anchor">#</a> 布尔</h3> <p><code>Rust</code> 中布尔值占用内存大小为 <code>1</code> 个字节</p> <h3 id="单元类型"><a href="#单元类型" class="header-anchor">#</a> 单元类型</h3> <p><code>Rust</code> 中单元类型 <code>()</code> 可以用来占位，如果不注入值的话并不占据字节，即空的单元类型为 <code>0</code> 个字节</p> <p>单元类型 <code>()</code> 是一个零长度的元组。它没啥作用，但是可以用来表达一个函数没有返回值</p> <ul><li>函数没有返回值，那么返回一个 <code>()</code></li> <li>通过 <code>;</code> 结尾的语句返回一个 <code>()</code></li></ul> <h2 id="语句和表达式"><a href="#语句和表达式" class="header-anchor">#</a> 语句和表达式</h2> <blockquote><p><strong>只有表达式能返回值</strong></p></blockquote> <h3 id="语句和表达式的区别"><a href="#语句和表达式的区别" class="header-anchor">#</a> 语句和表达式的区别</h3> <ul><li>初级理解
<ul><li>表达式不能包含分号，必须要看结尾是否有 <code>;</code></li> <li>是否在进行赋值(形态上看看就好)，如果没有 <code>;</code> 以上面的一条为主</li> <li>表达式总要返回值，如果没有返回值会隐式的返回一个单元类型 <code>()</code></li> <li><code>macro</code> 是例外</li></ul></li></ul> <blockquote><p>中级理解还没达到那个能耐，等到达了再写吧</p></blockquote> <p>我在<a href="https://practice-zh.course.rs/basic-types/statements-expressions.html" target="_blank" rel="noopener noreferrer"><code>Rust</code> 联系实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中发现第一题的两种方式可以使其运行起来，但是有个疑惑点没有想通</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// eg1</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        x <span class="token operator">+=</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// eg2</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        x <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        x
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// eg3</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ul><li><p>为什么在 <code>eg1</code> 中 <code>x += 2</code> 返回的是单元类型 <code>()</code>，而在 <code>eg2</code> 中返回的是 <code>i32</code> 类型</p> <p><strong>悟了</strong>，这里面有个坑 <code>x += 2</code> 等价于 <code>x = x + 2</code> 所以这个表达式其实是一个赋值的代码，赋值的代码并不是一个变量数据，所以返回的是一个单元类型 <code>()</code>，所以我新增的 <code>eg3</code> 也是可以正常运行的</p></li></ul> <h2 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h2> <h3 id="函数要点"><a href="#函数要点" class="header-anchor">#</a> 函数要点</h3> <ul><li>函数名和变量名使用蛇形命名法 <code>(snake case)</code> ，例如 <code>fn add_two() -&gt; {}</code></li> <li>函数的位置可以随便放，<code>Rust</code> 不关心我们在哪里定义了函数，只要有定义即可</li> <li>每个函数参数都需要标注类型</li></ul> <p>注意：</p> <ul><li><p><code>Rust</code> 中只允许从函数体中使用 <code>return</code> 语句返回,而这里是一个代码块,只能使用表达式的值作为返回。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code> <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>永不返回的发散函数 <code>!</code>，当用 <code>!</code> 作函数返回类型的时候，表示该函数永不返回( <code>diverge function</code> )，特别的，这种语法往往用做会导致程序崩溃的函数</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">dead_end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">!</span> <span class="token punctuation">{</span>
    <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;你已经到了穷途末路，崩溃吧！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <h3 id="匿名函数"><a href="#匿名函数" class="header-anchor">#</a> 匿名函数</h3> <h4 id="如何理解"><a href="#如何理解" class="header-anchor">#</a> 如何理解</h4> <ol><li>当匿名函数体内最后一个表达式没有分号时,该匿名函数会返回这个最后一个表达式的值。</li> <li>当最后一个表达式有分号或不存在时,该匿名函数会返回 <code>()</code> 单元类型。</li> <li>因为根据 <code>Rust</code> 的规则,默认返回 <code>()</code>。</li></ol> <h2 id="所有权和借用"><a href="#所有权和借用" class="header-anchor">#</a> 所有权和借用</h2> <h3 id="所有权"><a href="#所有权" class="header-anchor">#</a> 所有权</h3> <h4 id="所有权原则"><a href="#所有权原则" class="header-anchor">#</a> 所有权原则</h4> <ol><li><code>Rust</code> 中每一个值都被一个变量所拥有，该变量被称为值的所有者</li> <li><strong>一个值同时只能被一个变量所拥有，或者说一个值只能拥有一个所有者</strong></li> <li>当所有者(变量)离开作用域范围时，这个值将被丢弃(<code>drop</code>)</li></ol> <h4 id="栈-stack-与堆-heap"><a href="#栈-stack-与堆-heap" class="header-anchor">#</a> 栈(<code>Stack</code>)与堆(<code>Heap</code>)</h4> <blockquote><p>栈和堆的核心目标就是为程序在运行时提供可供使用的内存空间</p></blockquote> <h5 id="栈-stack"><a href="#栈-stack" class="header-anchor">#</a> 栈(<code>Stack</code>)</h5> <ul><li>栈按照顺序存储值并以相反顺序取出值，这也被称作<strong>后进先出</strong>、<strong>先进后出</strong></li> <li>增加数据叫做<strong>进栈</strong>，移出数据则叫做<strong>出栈</strong></li> <li>栈中的所有数据都<strong>必须</strong>占用已知且固定大小的内存空间</li></ul> <div class="custom-block note"><p class="custom-block-title">笔记</p> <p>想象一下一叠盘子：当增加更多盘子时，把它们放在盘子堆的顶部，当需要盘子时，再从顶部拿走。不能从中间也不能从底部增加或拿走盘子！</p></div> <h5 id="堆-heap"><a href="#堆-heap" class="header-anchor">#</a> 堆(<code>Heap</code>)</h5> <blockquote><p>对于大小未知或者可能变化的数据，将它存储在堆上</p></blockquote> <p>当向堆上放入数据时，需要请求一定大小的内存空间。操作系统在堆的某处找到一块足够大的空位，把它标记为已使用，并返回一个表示该位置地址的指针, 该过程被称为在堆上分配内存，有时简称为 “分配”(<code>allocating</code>)，然后该指针会被推入栈中，因为指针的大小是已知且固定的，在后续使用过程中，你将通过栈中的指针，来获取数据在堆上的实际内存位置，进而访问该数据</p> <p>我个人的理解就是书籍的目录「栈」对应页码，然后寻找具体章节「堆」的过程</p> <h5 id="性能区别"><a href="#性能区别" class="header-anchor">#</a> 性能区别</h5> <p>在栈上分配内存比在堆上分配内存要快，因为入栈时操作系统无需进行函数调用（或更慢的系统调用）来分配新的空间，只需要将新数据放入栈顶即可。相比之下，在堆上分配内存则需要更多的工作，这是因为操作系统必须首先找到一块足够存放数据的内存空间，接着做一些记录为下一次分配做准备，如果当前进程分配的内存页不足时，还需要进行系统调用来申请更多内存。 因此，处理器在栈上分配数据会比在堆上分配数据更加高效。</p> <h5 id="所有权与堆栈"><a href="#所有权与堆栈" class="header-anchor">#</a> 所有权与堆栈</h5> <p>当代码调用的某一个函数的时候，传递的参数会被依次压入栈中，当函数执行完毕后这些参数会按照<strong>后进先出</strong>的原则依次移除</p> <p>因为堆上的数据缺乏组织，因此跟踪这些数据何时分配和释放是非常重要的，否则堆上的数据将产生内存泄漏 —— 这些数据将永远无法被回收。这就是 <code>Rust</code> 所有权系统为我们提供的强大保障。在 <code>Rust</code> 中，明白堆栈的原理，对于我们理解所有权的工作原理会有很大的帮助</p> <p><strong>当所有权转移时，可变性也可以随之改变</strong>，也就是说新的变量拥有所有权的时候它是不可变的，如果要进行改变需要加上 <code>mut</code> 关键字</p> <blockquote><p>我想到一个情况，如果按这个逻辑来看的话，那么在写 <code>rust</code> 代码时传递参数时，是否需要让容量比较高的参数放在后面，使其在删除的时候更早的删除</p></blockquote> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>如何声明一个 <code>String</code> 类型的变量</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s <span class="token operator">=</span><span class="token string">&quot;hello&quot;</span> <span class="token comment">// s 是一个指向字符串的指针，类型是 &amp;str</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// s 是一个指向字符串的指针，类型是 String</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p><code>::</code> 是一种调用操作符，这里表示调用 <code>String</code> 模块中的 <code>from</code> 方法，由于 <code>String</code> 类型存储在堆上，因此它是动态的
:::</p></blockquote> <h3 id="变量绑定背后的数据交互"><a href="#变量绑定背后的数据交互" class="header-anchor">#</a> 变量绑定背后的数据交互</h3> <blockquote><p>注意：基本类型是存储在「栈」上的，而复杂类型是存储在「堆」上的
基本的数据类型有：</p> <ol><li>数值类型: 有符号整数 (<code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>isize</code>)、 无符号整数 (<code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>usize</code>) 、浮点数 (<code>f32</code>, <code>f64</code>)、以及有理数、复数</li> <li>字符串：字符串字面量和字符串切片 <code>&amp;str</code></li> <li>布尔类型： <code>true</code> 和 <code>false</code></li> <li>字符类型: 表示单个 <code>Unicode</code> 字符，存储为 4 个字节</li> <li>单元类型: 即 <code>()</code> ，其唯一的值也是 <code>()</code></li></ol></blockquote> <blockquote><p>注意：
当变量离开作用域的时候 <code>Rust</code> 会自动调用 <code>drop</code> 来清理变量的堆内存。如果两个变量指向到了同一个位置的话，那么这个时候就会陷入一个问题，因为 <code>Rust</code> 会调用两次 <code>drop</code>，这样就会导致程序崩溃，所以 <code>Rust</code> 会自动调用 <code>drop</code> 的时候会将变量的所有权转移给另一个变量，这样就不会出现两次 <code>drop</code> 的问题。这样的情况叫做：二次释放（<code>double free</code>）</p></blockquote> <h4 id="实战解说"><a href="#实战解说" class="header-anchor">#</a> 实战解说</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面的代码中，<code>s1</code> 赋值给了 <code>s2</code> 后，<code>Rust</code> 就认为 <code>s1</code> 不再有效，因此在 <code>s1</code> 离开作用域的时候 <code>Rust</code> 不会 <code>drop</code> 任何东西。如果这时候要对 <code>s1</code> 进行操作的时候就会提示 <code>borrow of moved value: 's1'</code>，这是因为 <code>s1</code> 已经不再有效了，<code>Rust</code> 禁止使用无效的引用。</p> <p>但是，下面的代码是可以正常运行的，原因是 <code>s2</code> 是 <code>s1</code> 的一个引用，所以 <code>s2</code> 的值是 <code>s1</code> 的一个引用，所以 <code>s1</code> 离开作用域的时候 <code>Rust</code> 不会 <code>drop</code> 任何东西</p> <p>我个人理解的是基础类型数据是存储在栈上的，所以 <code>s1</code> 在赋值给 <code>s2</code> 的时候实际上是使用了一次拷贝的过程，直接将整个数据给了一份给 <code>s2</code> 在栈上创建了。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">;</span>

<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;x = {}, y = {}&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>任何基本类型的组合可以 <code>Copy</code> ，不需要分配内存或某种形式资源的类型是可以 <code>Copy</code> 的</strong></p> <p>可以 <code>Copy</code> 的类型:</p> <ul><li>所有整数类型</li> <li>布尔类型</li> <li>所有浮点数类型</li> <li>字符类型</li> <li>元组，当且仅当其包含的类型也都是 <code>Copy</code> 的时候。比如，(<code>i32</code>, <code>i32</code>) 是 Copy 的，但 (<code>i32</code>, <code>String</code>) 就不是</li> <li>不可变引用 &amp;T，<strong>但是注意: 可变引用 <code>&amp;mut T</code> 是不可以 <code>Copy</code> 的</strong></li></ul> <blockquote><p>所以我简单的理解为 凡是以上类型进行赋值的行为可以认为是在进行 <code>Copy</code> 操作</p></blockquote> <h3 id="引用与借用"><a href="#引用与借用" class="header-anchor">#</a> 引用与借用</h3> <h4 id="引用与解引用"><a href="#引用与解引用" class="header-anchor">#</a> 引用与解引用</h4> <p>常规引用是一个指针类型，指向了对象存储的内存地址，也就是使用 <code>&amp;</code> 符号来创建一个引用，这个引用是不可变的，也就是说不能修改引用的值，但是可以修改引用的指向。</p> <p>必须使用 <code>*y</code> 来解出引用所指向的值（也就是<strong>解引用</strong>）</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code>    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="不可变引用"><a href="#不可变引用" class="header-anchor">#</a> 不可变引用</h4> <p><code>&amp;</code> 符号即是引用，它们允许你使用值，但是不获取所有权，也就是新的变量离开作用域的时候这个引用即失效，但原始的数据不会 <code>drop</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> len <span class="token operator">=</span> <span class="token function">calculate_length</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The length of '{}' is {}.&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">calculate_length</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">usize</span> <span class="token punctuation">{</span>
    s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="可变引用"><a href="#可变引用" class="header-anchor">#</a> 可变引用</h4> <p>如果要在 <code>calculate_length</code> 函数中改变 <code>s</code> 的值操作如下</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> len <span class="token operator">=</span> <span class="token function">calculate_length</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The length of '{}' is {}.&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">calculate_length</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">usize</span> <span class="token punctuation">{</span>
    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;,word&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>注意：</p> <ol><li><strong>可变引用同时只能存在一个</strong></li> <li><strong>同一作用域，特定数据只能有一个可变引用</strong></li></ol></blockquote> <p>我理解的是，当 <code>a</code> 被声明可变变量(<code>mut</code>)时，<code>b</code> 进行可变引用这个时候是<strong>允许</strong>的，但是<strong>同时</strong> <code>c</code> 也进行了可变引用，这时候是<strong>不允许</strong>的</p> <p><code>Rust</code> 在编译初期就会进行上面的检查，即 <code>borrow checker</code>，该检查的好处：</p> <ul><li>两个或更多的指针同时访问同一数据</li> <li>至少有一个指针被用来写入数据</li> <li>没有同步数据访问的机制</li> <li>减少后期在运行时出现数据交叉的问题</li></ul> <p>如果一定要在一个函数中对某个变量进行多次可变引用的话，可以使用大括号来对上一个可变引用进行作用域的限制</p> <h4 id="可变引用与不可变引用不能同时存在"><a href="#可变引用与不可变引用不能同时存在" class="header-anchor">#</a> 可变引用与不可变引用不能同时存在</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code>    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
    <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
    <span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> a<span class="token punctuation">;</span> <span class="token comment">// 这里在编译器中直接就会报错，提示'无法借用不可变局部变量 `a` 作为可变变量'</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这就相当于你把车借给你的朋友开，结果你的朋友又借给他的朋友，这时候你朋友的朋友借走了，他想把车改一改，这时候作为车主的你肯定是不会愿意的</p> <p>如果你想让 <code>d</code> 能够使用 <code>a</code> 的值并作出改变的话，那么这时候你需要使用 <code>clone</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
<span class="token keyword">let</span> d <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>ref</code> 与 <code>&amp;</code> 类似，可以用来获取一个值的引用，但是它们的用法有所不同。通常情况下是直接将变量赋值的时候发现需要进行引用时使用 <code>ref</code></p> <div class="language-Rust line-numbers-mode"><pre class="language-rust"><code>    <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token char">'中'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span>c<span class="token punctuation">;</span>
    <span class="token comment">// 填写空白处，但是不要修改其它行的代码</span>
    <span class="token keyword">let</span> <span class="token keyword">ref</span> r2 <span class="token operator">=</span> c<span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>r1<span class="token punctuation">,</span> <span class="token operator">*</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p><code>Rust</code> 是通过 <code>NLL(Non-Lexical Lifetimes)</code> 来进行编译器的优化</p></blockquote> <h4 id="垂直引用-dangling-references"><a href="#垂直引用-dangling-references" class="header-anchor">#</a> 垂直引用(<code>Dangling References</code>)</h4> <p>悬垂引用也叫做悬垂指针，意思为指针指向某个值后，这个值被释放掉了，而指针仍然存在，其指向的内存可能不存在任何值或已被其它变量重新使用。在 <code>Rust</code> 中编译器可以确保引用<strong>永远也不会变成悬垂状态</strong>：当你获取数据的引用后，编译器可以确保数据不会在引用结束前被释放，要想释放数据，必须先停止其引用的使用。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> reference_to_nothing <span class="token operator">=</span> <span class="token function">dangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">dangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">&amp;</span>s
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上面这段代码在 <code>dangle</code> 函数中返回了指针地址，但是因为 <code>dangle</code> 函数结束了，导致 <code>s</code> 这个变量要被销毁，所以编辑器直接会提示「缺少生命周期说明符」，即代码进行了垂直引用</p> <h3 id="借用规则总结"><a href="#借用规则总结" class="header-anchor">#</a> 借用规则总结</h3> <ul><li>同一时刻，你只能拥有要么一个可变引用, 要么任意多个不可变引用</li> <li>引用必须总是有效的</li></ul> <h2 id="复合类型"><a href="#复合类型" class="header-anchor">#</a> 复合类型</h2> <blockquote><p>如果在 <code>Rust</code> 代码中存在声明后未使用的，那么需要进行「<strong>编译器属性标记</strong>」，即引入 <code>#![allow(unused_variables)]</code></p></blockquote> <h3 id="切片"><a href="#切片" class="header-anchor">#</a> 切片</h3> <p>创建切片的语法，使用方括号包括的一个序列：<strong>[开始索引..终止索引]</strong></p> <div class="language-Rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> empty_silce_i32<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">i32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> empty_silce_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>取值：</p> <div class="language-Rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取字符串s的前两位</span>
<span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 等效上一行的写法</span>

<span class="token comment">// 获取字符串的第四位到最后一位</span>
<span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">..</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 等效上一行的写法</span>

<span class="token comment">// 获取完整的字符串</span>
<span class="token keyword">let</span> len <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 等效上两行的写法</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p>注意：
<code>Rust</code> 在提取中文的时候要注意一个中文占三个字节，如何操作请看<a href="###%E5%88%87%E7%89%87">这里</a> //todo</p></blockquote> <div class="language-Rust line-numbers-mode"><pre class="language-rust"><code>    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">&quot;中国人&quot;</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 输出 9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>字符串切片的类型标识是 <code>&amp;str</code></strong>，所以函数在返回切片时可以直接返回 <code>&amp;str</code></p> <h4 id="字符串字面量是切片"><a href="#字符串字面量是切片" class="header-anchor">#</a> 字符串字面量是切片</h4> <p><code>let a = &quot;Hello, world!&quot;;</code> <code>a</code> 的实际类型是 <code>&amp;str</code></p> <p><strong><code>Rust</code> 中的字符是 <code>Unicode</code> 类型，因此每个字符占据 <code>4</code> 个字节内存空间，但是在字符串中不一样，字符串是 <code>UTF-8</code> 编码，也就是字符串中的字符所占的字节数是变化的(<code>1 - 4</code>)</strong></p> <p><code>Rust</code> 在语言级别，只有一种字符串类型： <code>str</code>，它通常是以引用类型出现 <code>&amp;str</code>，也就是上文提到的字符串切片。所以在 <code>Rust</code> 中提到字符串时，往往指的就是 <code>String</code> 类型和 <code>&amp;str</code> 字符串切片类型，这两个类型都是 <code>UTF-8</code> 编码</p> <h5 id="string-与-str-的转换"><a href="#string-与-str-的转换" class="header-anchor">#</a> <code>String</code> 与 <code>&amp;str</code> 的转换</h5> <p><code>&amp;str</code> 转 <code>String</code></p> <div class="language-Rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 或</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>String</code> 转 <code>&amp;str</code></p> <blockquote><p>取引用即可</p></blockquote> <div class="language-Rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 声明一个 String 类型的数据</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello,world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取 &amp;str 类型数据</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="字符串索引"><a href="#字符串索引" class="header-anchor">#</a> 字符串索引</h4> <blockquote><p>在 <code>Rust</code> 的字符串中通过索引的方式访问字符串的某个字符或者子串是<strong>失败</strong>的，原因是 <code>Rust</code> 的字符串实际上存储的是[ <code>u8</code> ]，一个字节数组。在通过索引区间来访问字符串时要<strong>格外注意</strong></p></blockquote> <h4 id="操作字符串"><a href="#操作字符串" class="header-anchor">#</a> 操作字符串</h4> <h5 id="追加-push"><a href="#追加-push" class="header-anchor">#</a> 追加(<code>Push</code>)</h5> <p>字符串<strong>尾部</strong>可以使用 <code>push()</code> 方法追加字符 <code>char</code>，也可以使用 <code>push_str()</code> 方法追加字符串字面量，想要改变当前变量的字符串时变量必须加上 <code>mut</code> 关键字修饰。</p> <blockquote><p>注意：上述的两种方案都是在<strong>原有的字符串上追加，但不会返回新的字符串</strong>，当然，在编辑器中也是不予通过的</p></blockquote> <h5 id="插入-insert"><a href="#插入-insert" class="header-anchor">#</a> 插入(<code>Insert</code>)</h5> <p>可以使用 <code>insert()</code> 方法插入单个字符 <code>char</code> 或使用 <code>insert_str()</code> 插入字符串字面量，同样的，原始函数变量需要使用 <code>mut</code> 关键字修饰。</p> <blockquote><p>注意：插入时使用索引时也需要注意中文占位的情况</p></blockquote> <h5 id="替换-replace"><a href="#替换-replace" class="header-anchor">#</a> 替换(<code>Replace</code>)</h5> <ul><li><p><code>replace</code></p> <ul><li>该方法<strong>可适用于 <code>String</code> 和 <code>&amp;str</code> 类型</strong>。<code>replace()</code> 方法接收两个参数，第一个参数是<strong>要被替换的字符串</strong>，第二个参数是<strong>新的字符串</strong>。该方法会替换所有匹配到的字符串。该方法是返回一个新的字符串，而不是操作原来的字符串。</li></ul></li> <li><p><code>replacen</code></p> <ul><li>该方法<strong>可适用于 <code>String</code> 和 <code>&amp;str</code> 类型</strong>。<code>replacen()</code> 方法接收三个参数，前两个参数与 <code>replace()</code> 方法一样，第三个参数则表示替换的个数。该方法是<strong>返回一个新的字符串，而不是操作原来的字符串</strong>。</li></ul></li> <li><p><code>replace_range</code></p> <ul><li>该方法<strong>仅适用于 <code>String</code> 类型</strong><code>。replace_range</code> 接收两个参数，第一个参数是要<strong>替换字符串的范围（<code>Range</code>）</strong>，第二个参数是<strong>新的字符串</strong>。该方法是直接操作原来的字符串，<strong>不会返回新的字符串</strong>。该方法需要使用 <code>mut</code> 关键字修饰。</li></ul></li> <li><p>删除 (<code>Delete</code>)</p> <blockquote><p>与字符串删除相关的方法有 <code>4</code> 个，它们分别是 <code>pop()</code>，<code>remove()</code>，<code>truncate()</code>，<code>clear()</code>。这四个方法仅适用于 <code>String</code> 类型。</p></blockquote> <ul><li><p><code>pop</code> —— 删除并返回字符串的最后一个字符</p> <p><strong>该方法是直接操作原来的字符串</strong>，存在返回值，其返回值是一个 <code>Option</code> 类型，如果字符串为空，则返回 <code>None</code></p></li> <li><p><code>remove</code> ——删除并返回字符串中指定位置的字符</p> <p><strong>该方法是直接操作原来的字符串</strong>，存在返回值，其返回值是删除位置的字符串，只接收一个参数，表示该字符起始索引位置。<code>remove()</code> 方法是按照字节来处理字符串的，如果参数所给的位置不是合法的字符边界，则会发生错误。</p></li> <li><p><code>truncate</code> ——删除字符串中从指定位置开始到结尾的全部字符</p> <p><strong>该方法是直接操作原来的字符串</strong>。无返回值。该方法 <code>truncate()</code> 方法是按照字节来处理字符串的，如果参数所给的位置不是合法的字符边界，则会发生错误。</p></li> <li><p><code>clear</code> —— 清空字符串</p> <p><strong>该方法是直接操作原来的字符串</strong>。调用后，删除字符串中的所有字符，相当于 <code>truncate()</code> 方法参数为 <code>0</code> 的时候。</p></li></ul></li></ul> <h5 id="连接-concatenate"><a href="#连接-concatenate" class="header-anchor">#</a> 连接 (<code>Concatenate</code>)</h5> <ol><li><p>使用 <code>+</code> 或者 <code>+=</code> 连接字符串</p> <p>使用 <code>+</code> 或者 <code>+=</code> 连接字符串，要求右边的参数必须为字符串的切片引用（<code>Slice</code>）类型。其实当调用 <code>+</code> 的操作符时，相当于调用了 <code>std::string</code> 标准库中的 <code>add()</code> 方法，这里 <code>add()</code> 方法的第二个参数是一个引用的类型。因此我们在使用 <code>+</code> 时， 必须传递切片引用类型。不能直接传递 <code>String</code> 类型。<code>+</code> 是返回一个新的字符串，所以变量声明可以不需要 <code>mut</code> 关键字修饰。</p></li> <li><p>使用 <code>format!</code> 连接字符串</p> <p><code>format!</code> 这种方式适用于 <code>String</code> 和 <code>&amp;str</code> 。<code>format!</code> 的用法与 <code>print!</code> 的用法类似</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;rust&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">&quot;{} {}!&quot;</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ol> <h5 id="字符串转义"><a href="#字符串转义" class="header-anchor">#</a> 字符串转义</h5> <p>通过转义的方式 <code>\</code> 输出 <code>ASCII</code> 和 <code>Unicode</code> 字符。</p> <h5 id="操作-utf-8-字符"><a href="#操作-utf-8-字符" class="header-anchor">#</a> 操作 <code>UTF-8</code> 字符</h5> <h6 id="字符-2"><a href="#字符-2" class="header-anchor">#</a> 字符</h6> <p>想要以 <code>Unicode</code> 字符的方式遍历字符串，最好的办法是使用 <code>chars</code> 方法</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">&quot;中国人&quot;</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h6 id="字节"><a href="#字节" class="header-anchor">#</a> 字节</h6> <p>字符串的底层字节数组表现形式</p> <h6 id="获取子串"><a href="#获取子串" class="header-anchor">#</a> 获取子串</h6> <blockquote><p>由于 <code>Rust</code> 的存储形态并不是人识别的字符，所以在取值的时候需要特别注意</p></blockquote> <p>想要准确的从 <code>UTF-8</code> 字符串中获取子串是较为复杂的事情，例如想要从 <code>holla中国人नमस्ते</code> 这种变长的字符串中取出某一个子串，使用标准库你是做不到的。 你需要在 <code>crates.io</code> 上搜索 <code>utf8</code> 来寻找想要的功能。</p> <h6 id="为什么-string-可变但-str-不可变"><a href="#为什么-string-可变但-str-不可变" class="header-anchor">#</a> 为什么 <code>String</code> 可变但 <code>&amp;str</code> 不可变</h6> <p>因为 <code>&amp;str</code> 的数据是不可变的，存储在栈中的，能存储在栈中的数据都<strong>必须</strong>占用已知且固定大小的内存空间，而 <code>String</code> 的存在就是为了动态存储的，所以 <code>String</code> 是存储在堆中的。</p> <h6 id="如何手动释放内存"><a href="#如何手动释放内存" class="header-anchor">#</a> 如何手动释放内存</h6> <p><code>Rust</code> 中提供了 <code>drop</code> 函数来进行释放内存，默认离开变量的作用域时会自动释放内存，即，在 <code>}</code> 的结尾会自动调用 <code>drop</code>。</p> <h3 id="元组"><a href="#元组" class="header-anchor">#</a> 元组</h3> <p>元组是由多种类型组合到一起形成的，因此它是复合类型，元组的长度是固定的，元组中元素的顺序也是固定的。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> tup<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span><span class="token keyword">f64</span><span class="token punctuation">,</span><span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">6.4</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注：</p> <ul><li><strong>元组不具备任何清晰的含义</strong></li></ul></blockquote> <h4 id="如何取元祖中的值"><a href="#如何取元祖中的值" class="header-anchor">#</a> 如何取元祖中的值</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> tup<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span><span class="token keyword">f64</span><span class="token punctuation">,</span><span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">6.4</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 使用 . 来访问元组</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;tup index 1 {}&quot;</span><span class="token punctuation">,</span>tup<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 使用匹配模式取值</span>
<span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> tup<span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The value of y is: {}&quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h4> <ul><li>使用元组返回多个值</li></ul> <h4 id="注意"><a href="#注意" class="header-anchor">#</a> 注意</h4> <ul><li>目前 <code>Rust</code> 打印元组的时候最多只能是 <code>12</code> 个，这是因为 <code>Rust</code> 标准库中对于元组实现  <code>Debug trait</code> 有一个限制：只有长度小于或等于 <code>12</code> 的元组才自动实现了  <code>Debug trait</code>。这意味着可以打印长度最多为 <code>12</code> 的元组，但是对于更长的元组，你必须手动实现  <code>Debug</code></li></ul> <h3 id="结构体"><a href="#结构体" class="header-anchor">#</a> 结构体</h3> <ul><li>由多种类型组合而成</li> <li>结构体可以为内部的每个字段起一个富有含义的名称</li></ul> <h4 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h4> <h5 id="定义结构体"><a href="#定义结构体" class="header-anchor">#</a> 定义结构体</h5> <p><strong>组成</strong></p> <ul><li>通过关键字 <code>struct</code> 定义</li> <li>一个清晰明确的结构体「名称」</li> <li>几个有名字的结构体「字段」</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">User</span><span class="token punctuation">{</span>
    active<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    sign_in_count<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>初始化</strong></p> <ol><li>初始化实例时，<strong>每个字段</strong>都<strong>必须</strong>要进行初始化</li> <li>初始化时的字段顺序<strong>不需要</strong>和结构体定义时的顺序一致</li></ol> <p><strong>取值</strong></p> <p>直接使用 <code>.</code> 来进行取值，比如上面的 <code>User</code> 结构体中要获取 <code>username</code> 字段的值，可以使用 <code>User.username</code> 来获取，当然 <code>User</code> 得替换为你声明的变量</p> <p><strong>修改结构体的值</strong></p> <p>在定义结构体的时候标记上 <code>mut</code> 修饰符，就可以修改结构体的值了</p> <p><strong>简化写法初始化</strong></p> <p>在 <code>Rust</code> 中，如果函数参数和结构体字段同名时，可以直接使用缩略的方式进行初始化，即下面的简化写法</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 常规写法</span>
<span class="token keyword">fn</span> <span class="token function-definition function">build_user</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">:</span> email<span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> username<span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 简化写法</span>
<span class="token keyword">fn</span> <span class="token function-definition function">build_user</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">,</span>
        username<span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>简化更新</strong></p> <blockquote><ul><li><code>..struct</code> 表示凡是没有显示声明的字段，全部从 <code>..struct</code> 后面的变量结构体中自动获取，注意：<code>..struct</code> 必须放在赋值的结构体的尾部使用，让 <code>Rust</code> 知道是从哪里开始取值，否则会报错。</li> <li>结构体更新值从上一个结构体中取值的时候注意类型，<a href="#%E5%8F%98%E9%87%8F%E7%BB%91%E5%AE%9A%E8%83%8C%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92">基础类型</a>赋值的时候实际上是 <code>Copy</code> 而其它类型则是<strong>所有权</strong>进行了转移，即下面的 <code>username</code> 这个字段无法在 <code>user1</code> 中使用了。<strong>把结构体中具有所有权的字段转移出去后，将无法再访问该字段，但是可以正常访问其它的字段</strong></li></ul></blockquote> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 常规更新</span>
<span class="token keyword">let</span> user2 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    active<span class="token punctuation">:</span> user1<span class="token punctuation">.</span>active<span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> user1<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;another@example.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    sign_in_count<span class="token punctuation">:</span> user1<span class="token punctuation">.</span>sign_in_count<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 简化更新</span>
<span class="token keyword">let</span> user2 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;another@example.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">..</span>user1
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="元组结构体-tuple-struct"><a href="#元组结构体-tuple-struct" class="header-anchor">#</a> 元组结构体(<code>Tuple Struct</code>)</h5> <p>结构体必须要有名称，但是结构体的字段可以没有名称，这种结构体长得很像元组，因此被称为元组结构体</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Color</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> black <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> origin <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="使用-derive-debug-来打印结构体的信息"><a href="#使用-derive-debug-来打印结构体的信息" class="header-anchor">#</a> 使用 <code>#[derive(Debug)]</code> 来打印结构体的信息</h5> <p>如果使用以下代码，在编辑器内就会直接报错了，提示 <code>`User` 不实现 `Debug` (`{:?}` 需要)</code>，这时候就需要在结构体前面上面加上 <code>#[derive(Debug)]</code> ，这样 <code>Rust</code> 就会自动为结构体实现 <code>Debug</code> 这个 trait，这样就可以直接使用 <code>println!</code> 来打印结构体了。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// #[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span><span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> u <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;12@qq.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;username: {:?}&quot;</span><span class="token punctuation">,</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>如果要完整的输出错误信息，建议将 <code>println!</code> 替换为 <code>dbg!</code> 输出的内容为：代码所在的文件名、行号、表达式以及表达式的值。</p> <p>如果将上述的代码替换为 <code>dbg!(&quot;username: {:?}&quot;,u);</code>，则输出的结果为：</p> <div class="language-log line-numbers-mode"><pre class="language-log"><code><span class="token punctuation">[</span>src<span class="token operator">/</span>main<span class="token punctuation">.</span>rs<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token string">&quot;username: {:?}&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;username: {:?}&quot;</span>
<span class="token punctuation">[</span>src<span class="token operator">/</span>main<span class="token punctuation">.</span>rs<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span> u <span class="token operator">=</span> User <span class="token operator">{</span>
    <span class="token property">username:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span>
    <span class="token property">age:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token property">email:</span> <span class="token string">&quot;12@qq.com&quot;</span><span class="token punctuation">,</span>
<span class="token operator">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>注意：</p> <ol><li><code>rust</code> 不会默认实现 <code>Debug</code>，我们可以采用：手动实现；使用 <code>derive</code> 来进行实现</li> <li><code>dbg!</code> 输出到标准错误输出 <code>stderr</code>，而 <code>println!</code> 输出到标准输出 <code>stdout</code></li></ol> <h3 id="枚举"><a href="#枚举" class="header-anchor">#</a> 枚举</h3> <p>关键词：<code>enum</code></p> <blockquote><p>枚举类型是一个类型，它会包含所有可能的枚举成员, 而枚举值是该类型中的具体某个成员的实例。</p></blockquote> <p>注意：目前枚举值还不能带有值，只能使用结构体来实现</p> <h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <p><code>Rust</code> 中数组有两种：</p> <ul><li>固定长度的数组 <code>arry</code></li> <li>动态增长的数组 <code>Vector</code></li></ul> <h4 id="固定长度的数组"><a href="#固定长度的数组" class="header-anchor">#</a> 固定长度的数组</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 基础</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token comment">// 声明数组类型</span>
<span class="token keyword">let</span> b<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">i32</span><span class="token punctuation">;</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token comment">// 重复数据的数组，以下为数组长度为5，每个元素都是3。即[3,3,3,3,3]</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token comment">// 注意数组中的元素为非基础类型并且长度还比较长的固定数组时，应该考虑类似 `std::array::from_fn` 来进行处理</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="动态增长的数组"><a href="#动态增长的数组" class="header-anchor">#</a> 动态增长的数组</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="访问数组"><a href="#访问数组" class="header-anchor">#</a> 访问数组</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;a[0] = {}&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 访问第一个元素</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;a[1] = {}&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 访问第二个元素</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="越界访问"><a href="#越界访问" class="header-anchor">#</a> 越界访问</h4> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;a[6] = {}&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 运行结果：thread 'main' panicked at 'index out of bounds: the len is 5 but the index is 6', src/main.rs:6:18</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="循环"><a href="#循环" class="header-anchor">#</a> 循环</h2> <h3 id="分支控制"><a href="#分支控制" class="header-anchor">#</a> 分支控制</h3> <p>基本上是 <code>if</code> 这个没什么好说的，各个语言都有，使用和语法大差不差</p> <h3 id="循环-2"><a href="#循环-2" class="header-anchor">#</a> 循环</h3> <h4 id="for-循环"><a href="#for-循环" class="header-anchor">#</a> <code>for</code> 循环</h4> <p>语法</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 基础结构</span>
<span class="token keyword">for</span> 元素 <span class="token keyword">in</span> 集合<span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><table><thead><tr><th>使用方法</th> <th>等价使用方式</th> <th>所有权</th></tr></thead> <tbody><tr><td><code>for item in collection</code></td> <td><code>for item in IntoIterator::into_iter(collection)</code></td> <td>转移所有权</td></tr> <tr><td><code>for item in &amp;collection</code></td> <td><code>for item in collection.iter()</code></td> <td>不可变借用</td></tr> <tr><td><code>for item in &amp;mut collection</code></td> <td><code>for item in collection.iter_mut()</code></td> <td>可变借用</td></tr></tbody></table> <h2 id="模式匹配"><a href="#模式匹配" class="header-anchor">#</a> 模式匹配</h2> <h3 id="match-和-if-let"><a href="#match-和-if-let" class="header-anchor">#</a> <code>match</code> 和 <code>if let</code></h3> <blockquote><p>模式匹配最常用的就是 <code>match</code> 和 <code>if let</code></p></blockquote> <h4 id="match"><a href="#match" class="header-anchor">#</a> <code>match</code></h4> <blockquote><p><code>match</code> 和其他语言中的 <code>switch</code> 非常像，<code>_</code> 类似 <code>switch</code> 中的 <code>default</code>。</p></blockquote> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 语法</span>
<span class="token keyword">match</span> target <span class="token punctuation">{</span>
    模式<span class="token number">1</span> <span class="token operator">=&gt;</span> 表达式<span class="token number">1</span><span class="token punctuation">,</span>
    模式<span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        语句<span class="token number">1</span><span class="token punctuation">;</span>
        语句<span class="token number">2</span><span class="token punctuation">;</span>
        表达式<span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    _ <span class="token operator">=&gt;</span> 表达式<span class="token number">3</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="match-表达式赋值"><a href="#match-表达式赋值" class="header-anchor">#</a> <code>match</code> 表达式赋值</h5> <blockquote><p><code>match</code> 本身也是一个表达式，因此可以用它来进行赋值</p></blockquote> <div class="language- extra-class"><pre><code>```rust
    enum IpAddr{
        Ipv4,
        Ipv6,
    }
    fn main() {
        let ip1 = IpAddr::Ipv4;
        let ip_str = match ip1 {
            IpAddr::Ipv4 =&gt; &quot;127.0.0.1&quot;,
            _ =&gt; &quot;::1&quot;,
        }
    }
    // 输出结果为 ::1
```
</code></pre></div><h5 id="match-绑定模式"><a href="#match-绑定模式" class="header-anchor">#</a> <code>match</code> 绑定模式</h5> <p>没看懂</p> <h5 id="穷尽匹配"><a href="#穷尽匹配" class="header-anchor">#</a> 穷尽匹配</h5> <blockquote><p>简单来说就是枚举的所有成员都必须被匹配到，否则编译器会报错</p></blockquote> <h5 id="通配符"><a href="#通配符" class="header-anchor">#</a> <code>_</code> 通配符</h5> <p>顾名思义，不是特别想把每个值都写一次的情况下采用通配符也可以解决这个问题</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> some_u8_value <span class="token operator">=</span> <span class="token number">0u8</span><span class="token punctuation">;</span>
<span class="token keyword">match</span> some_u8_value <span class="token punctuation">{</span>
    <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">3</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">5</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;five&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">7</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;seven&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    _ <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 这个写法是不报错的，这也就是上面所说的 `_` 等同于其他语言中的 `default`，其他语言中的 `default` 可以省略，但是在 `rust` 中可不能省略，不然编译不予通过</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="if-let"><a href="#if-let" class="header-anchor">#</a> <code>if let</code></h4> <p><code>match</code> 的语法是可以包括 <code>if let</code> 的，但是在只处理一个模式的情况下采用 <code>match</code> 就比较麻烦了，因此 <code>if let</code> 就出现了，语法如下：</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">if</span> <span class="token keyword">let</span> 模式 <span class="token operator">=</span> 表达式 <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> v <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>当你只要匹配一个条件，且忽略其他条件时就用 <code>if let</code> ，否则都用 <code>match</code></p></blockquote> <h4 id="matches-宏"><a href="#matches-宏" class="header-anchor">#</a> <code>matches!</code> 宏</h4> <p>它可以将一个表达式跟模式进行匹配，然后返回匹配的结果 <code>true or false</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token char">'f'</span><span class="token punctuation">;</span>
<span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token macro property">matches!</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token char">'A'</span><span class="token punctuation">..=</span><span class="token char">'Z'</span> <span class="token operator">|</span> <span class="token char">'a'</span><span class="token punctuation">..=</span><span class="token char">'z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token macro property">matches!</span><span class="token punctuation">(</span>bar<span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="变量遮蔽"><a href="#变量遮蔽" class="header-anchor">#</a> 变量遮蔽</h4> <p><code>match</code> 中的变量遮蔽其实不是那么的容易看出，因此要小心！其实这里最好不要使用同名，避免难以理解</p> <h3 id="解构-option"><a href="#解构-option" class="header-anchor">#</a> 解构 <code>Option</code></h3> <blockquote><p>一个变量要么有值：<code>Some(T)</code>, 要么为空：<code>None</code></p></blockquote> <h3 id="模式适用场景"><a href="#模式适用场景" class="header-anchor">#</a> 模式适用场景</h3> <h4 id="模式"><a href="#模式" class="header-anchor">#</a> 模式</h4> <p>模式是 <code>Rust</code> 中的特殊语法，它用来匹配类型中的结构和数据，它往往和 <code>match</code> 表达式联用，以实现强大的模式匹配能力。模式一般由以下内容组合而成：</p> <ul><li>字面值</li> <li>解构的数组、枚举、结构体或者元组</li> <li>变量</li> <li>通配符</li> <li>占位符</li></ul> <blockquote><p>注意, 只使用 <code>_</code> 和使用以下划线开头的名称有些微妙的不同：比如 <strong><code>_x</code> 仍会将值绑定到变量，而 <code>_</code> 则完全不会绑定</strong>。</p></blockquote> <h2 id="方法-method"><a href="#方法-method" class="header-anchor">#</a> 方法 <code>Method</code></h2> <blockquote><p>在 <code>Rust</code> 中方法往往和结构体、枚举、特征(<code>Trait</code>)一起使用</p></blockquote> <h3 id="self、-self-和-mut-self"><a href="#self、-self-和-mut-self" class="header-anchor">#</a> <code>self</code>、<code>&amp;self</code> 和 <code>&amp;mut self</code></h3> <p><code>&amp;self</code>：其实是 <code>self: &amp;Self</code> 的简写 <strong>（注意大小写）</strong>，简单的理解就是当前在为哪个结构体实现方法，那么 <code>self</code> 就是指哪个结构体</p> <p>注意：</p> <ul><li><code>self</code> 依旧有所有权的概念</li> <li><code>self</code> 表示当前结构体转移到方法中，因此 <code>self</code> 不能再被使用</li> <li><code>&amp;self</code> 表示该方法对原结构体不可变的借用</li> <li><code>&amp;mut self</code> 表示该方法对原结构体可变的借用</li></ul> <p><code>self</code> 的使用和函数的参数一样，都严格遵循 <code>Rust</code> 的所有权规则</p> <blockquote><p><code>Rust</code> 中有一个约定俗成的规则，使用 <code>new</code> 来作为构造器的名称，出于设计上的考虑，<code>Rust</code> 特地没有用 <code>new</code> 作为关键字。</p></blockquote> <h3 id="self-和-self-有什么区别"><a href="#self-和-self-有什么区别" class="header-anchor">#</a> <code>self</code> 和 <code>Self</code> 有什么区别</h3> <h4 id="self"><a href="#self" class="header-anchor">#</a> <code>self</code></h4> <ul><li><code>self</code> 是一个关键字，用于表示方法的接收者</li> <li>它通常在方法的第一个参数位置，表示当前实例</li> <li><code>self</code> 可以是 <code>&amp;self</code>、<code>&amp;mut self</code>、<code>self</code>，它们分别表示当前实例的不可变借用、可变借用和所有权</li></ul> <h4 id="self-2"><a href="#self-2" class="header-anchor">#</a> <code>Self</code></h4> <ul><li><code>Self</code> 是一个类型别名，用于表示当前实例的类型</li> <li>它通常在方法的返回值位置，表示当前实例的类型</li> <li><code>Self</code> 可以作返回值类型，表示返回与当前类型相同的实例</li></ul> <h2 id="范型和特征"><a href="#范型和特征" class="header-anchor">#</a> 范型和特征</h2> <h3 id="泛型-generics"><a href="#泛型-generics" class="header-anchor">#</a> 泛型 <code>Generics</code></h3> <h4 id="范型详解"><a href="#范型详解" class="header-anchor">#</a> 范型详解</h4> <ul><li><p>在 <code>Rust</code> 中，范型参数的名称可以任意起，出于惯性通常使用 <code>T</code> 来作为首选，注意：除非需要表达含义，否则尽量只用一个字母来表达</p></li> <li><p>因 <code>T</code> 代表任意类型，所以元素比较或者运算时，均需要其专属的函数来处理</p></li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 语法</span>
<span class="token keyword">fn</span> <span class="token function-definition function">largest</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">T</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="结构体中使用范型"><a href="#结构体中使用范型" class="header-anchor">#</a> 结构体中使用范型</h4> <p>注意：</p> <ul><li><p>提前声明，和范型函数定义类似，我们必须在使用范型参数之前要进行声明，然后才能在结构体的字段类型中使用 <code>T</code> 来代替具体的类型</p></li> <li><p>结构体中的两个属性的类型都为 <code>T</code>，那么它们必须是相同的类型，否则会抛出类型不匹配的错误</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span><span class="token class-name">U</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这是错误的</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span><span class="token number">1.1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 这是正确的</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>如果想让结构体中的属性既能类型相同，又能类型不同就需要使用不同的范型参数</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span><span class="token class-name">U</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span><span class="token number">1.1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <h4 id="枚举中使用范型"><a href="#枚举中使用范型" class="header-anchor">#</a> 枚举中使用范型</h4> <p><code>Option&lt;T&gt;</code> 是一个拥有范型 <code>T</code> 的美剧类型，它的第一个成员是 <code>Some&lt;T&gt;</code>，存放了一个类型为 <code>T</code> 的值</p> <p>在 <code>Rust</code> 中还有一个 <code>Result</code> 这个枚举，与 <code>Option</code> 作用于值的存在与否不同，<code>Result</code> 作用于值的结果，它可以是成功或者失败，成功时返回一个值，失败时返回一个错误信息</p> <h4 id="方法中使用范型"><a href="#方法中使用范型" class="header-anchor">#</a> 方法中使用范型</h4> <p><code>Rust</code> 通过在编译时进行泛型代码的 单态化(<code>monomorphization</code>)来保证效率。单态化是一个通过填充编译时使用的具体类型，将通用代码转换为特定代码的过程。</p> <p>编译器所做的工作正好与我们创建泛型函数的步骤相反，编译器寻找所有泛型代码被调用的位置并针对具体类型生成代码。</p> <h2 id="特征-trait"><a href="#特征-trait" class="header-anchor">#</a> 特征 <code>Trait</code></h2> <p><strong>一组可以被共享的行为，只要实现了特征，你就能使用这组行为</strong> ，理解的话当其他语言中的接口即可</p> <h2 id="特征对象"><a href="#特征对象" class="header-anchor">#</a> 特征对象</h2> <h3 id="特征对象的动态分发"><a href="#特征对象的动态分发" class="header-anchor">#</a> 特征对象的动态分发</h3> <ul><li><p>特征独享大小不固定</p></li> <li><p>几乎总是使用特征对象的引用方式</p></li></ul> <h3 id="self-和-self"><a href="#self-和-self" class="header-anchor">#</a> <code>Self</code> 和 <code>self</code></h3> <p><code>self</code> 指当前的实例对象，<code>Self</code> 指当前实例的类型</p> <h3 id="特征对象的限制"><a href="#特征对象的限制" class="header-anchor">#</a> 特征对象的限制</h3> <ul><li><p>方法的返回类型不能是 <code>Self</code></p></li> <li><p>方法没有任何范型参数</p></li></ul></div></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=Rust" title="标签">#Rust</a><a href="/tags/?tag=Rust%E7%BB%8F%E9%AA%8C" title="标签">#Rust经验</a><a href="/tags/?tag=Rust%E5%AD%A6%E4%B9%A0" title="标签">#Rust学习</a><a href="/tags/?tag=%E4%B8%8D%E5%99%A8" title="标签">#不器</a><a href="/tags/?tag=%E4%B8%8D%E5%99%A8%E5%B0%8F%E7%AA%9D" title="标签">#不器小窝</a></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024/8/7 14:31:55</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/language/rust/22f3a6/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Rust安装</div></a> <a href="/language/rust/ed45d2/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Rust经验</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/language/rust/22f3a6/" class="prev">Rust安装</a></span> <span class="next"><a href="/language/rust/ed45d2/">Rust经验</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/speak/e0b1f0/"><div>
            垃圾还是恶意
            <!----></div></a> <span class="date">09-10</span></dt></dl><dl><dd>02</dd> <dt><a href="/speak/91a05b/"><div>
            善良不是理所当然
            <!----></div></a> <span class="date">08-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/language/go/17e599/"><div>
            viper
            <!----></div></a> <span class="date">08-06</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:xingcxb@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/xingcxb" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=503418750" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2025
    <span>不器 | 小窝<br> <a href="/sitemap.xml">sitemap</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a><br/><a href="https://www.foreverblog.cn/go.html" target="_blank"> <img src="https://img.foreverblog.cn/wormhole_3_tp.gif" alt="" style="width:auto;height:32px;" title="穿梭虫洞-随机访问十年之约友链博客"></a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div></div><div></div><div></div><!----><div></div></div></div>
    <script src="/assets/js/app.d4066f40.js" defer></script><script src="/assets/js/4.0068dbe1.js" defer></script><script src="/assets/js/1.e2a47839.js" defer></script><script src="/assets/js/3.89d55b81.js" defer></script><script src="/assets/js/158.ef32049c.js" defer></script><script src="/assets/js/21.94b14704.js" defer></script><script src="/assets/js/25.5e11b002.js" defer></script><script src="/assets/js/44.b298a7d5.js" defer></script>
  </body>
</html>
